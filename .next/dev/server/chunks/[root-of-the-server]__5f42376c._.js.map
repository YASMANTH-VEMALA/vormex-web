{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/lib/utils/constants.ts"],"sourcesContent":["function normalizeApiUrl(input: string): string {\n  const trimmed = input.trim().replace(/\\/+$/, '');\n  return trimmed.endsWith('/api') ? trimmed : `${trimmed}/api`;\n}\n\nfunction resolveApiUrl(): string {\n  const publicApiUrl = process.env.NEXT_PUBLIC_API_URL;\n  if (publicApiUrl) {\n    return normalizeApiUrl(publicApiUrl);\n  }\n\n  const publicBackendUrl = process.env.NEXT_PUBLIC_BACKEND_URL;\n  if (publicBackendUrl) {\n    return normalizeApiUrl(publicBackendUrl);\n  }\n\n  if (process.env.NODE_ENV === 'production') {\n    throw new Error('Missing NEXT_PUBLIC_API_URL (or NEXT_PUBLIC_BACKEND_URL) in production');\n  }\n\n  // Local default for development only.\n  return 'http://localhost:5000/api';\n}\n\nexport const API_URL = resolveApiUrl();\nexport const BACKEND_ORIGIN = API_URL.replace(/\\/api$/, '');\nexport const GOOGLE_CLIENT_ID = process.env.NEXT_PUBLIC_GOOGLE_CLIENT_ID || '';\n\n"],"names":[],"mappings":";;;;;;;;AAAA,SAAS,gBAAgB,KAAa;IACpC,MAAM,UAAU,MAAM,IAAI,GAAG,OAAO,CAAC,QAAQ;IAC7C,OAAO,QAAQ,QAAQ,CAAC,UAAU,UAAU,GAAG,QAAQ,IAAI,CAAC;AAC9D;AAEA,SAAS;IACP,MAAM;IACN,wCAAkB;QAChB,OAAO,gBAAgB;IACzB;;;IAEA,MAAM;AAWR;AAEO,MAAM,UAAU;AAChB,MAAM,iBAAiB,QAAQ,OAAO,CAAC,UAAU;AACjD,MAAM,mBAAmB,gHAA4C"}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/app/api/auth/google/callback/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { BACKEND_ORIGIN } from '@/lib/utils/constants';\n\nconst GOOGLE_CLIENT_ID = process.env.NEXT_PUBLIC_GOOGLE_CLIENT_ID || '';\nconst GOOGLE_CLIENT_SECRET = process.env.GOOGLE_CLIENT_SECRET || '';\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const { code, codeVerifier, redirectUri } = body;\n\n    if (!code || !codeVerifier) {\n      return NextResponse.json(\n        { error: 'Code and code verifier are required' },\n        { status: 400 }\n      );\n    }\n\n    if (!GOOGLE_CLIENT_ID) {\n      console.error('GOOGLE_CLIENT_ID is not set');\n      return NextResponse.json(\n        { error: 'Google Client ID not configured. Please set NEXT_PUBLIC_GOOGLE_CLIENT_ID in your environment variables.' },\n        { status: 500 }\n      );\n    }\n\n    // Build the request body\n    const defaultFrontendOrigin =\n      process.env.NEXT_PUBLIC_BASE_URL ||\n      request.nextUrl.origin ||\n      BACKEND_ORIGIN;\n\n    const tokenParams = new URLSearchParams({\n      code: code,\n      client_id: GOOGLE_CLIENT_ID,\n      redirect_uri: redirectUri || `${defaultFrontendOrigin}/auth/google/callback`,\n      grant_type: 'authorization_code',\n      code_verifier: codeVerifier,\n    });\n\n    // Add client_secret only if it's configured (required for web applications)\n    // For public clients with PKCE, some configurations might work without it\n    // but Google typically requires it for authorization code flow\n    if (GOOGLE_CLIENT_SECRET) {\n      tokenParams.append('client_secret', GOOGLE_CLIENT_SECRET);\n    }\n\n    // Exchange authorization code for tokens using PKCE\n    const tokenResponse = await fetch('https://oauth2.googleapis.com/token', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n      body: tokenParams,\n    });\n\n    if (!tokenResponse.ok) {\n      const errorData = await tokenResponse.json().catch(() => ({}));\n      const errorMessage = errorData.error_description || errorData.error || 'Failed to exchange authorization code';\n      \n      console.error('Google token exchange error:', {\n        status: tokenResponse.status,\n        error: errorData,\n        hasClientSecret: !!GOOGLE_CLIENT_SECRET,\n      });\n\n      // Provide helpful error message\n      if (errorData.error === 'invalid_client' && !GOOGLE_CLIENT_SECRET) {\n        return NextResponse.json(\n          { \n            error: 'Google Client Secret is required. Please set GOOGLE_CLIENT_SECRET in your environment variables. You can find it in Google Cloud Console under APIs & Services > Credentials.',\n            details: 'The authorization code flow requires a client_secret for security.'\n          },\n          { status: 500 }\n        );\n      }\n\n      return NextResponse.json(\n        { error: errorMessage },\n        { status: tokenResponse.status }\n      );\n    }\n\n    const tokens = await tokenResponse.json();\n\n    if (!tokens.id_token) {\n      return NextResponse.json(\n        { error: 'ID token not found in token response' },\n        { status: 500 }\n      );\n    }\n\n    // Return the id_token to the frontend\n    return NextResponse.json({\n      idToken: tokens.id_token,\n      accessToken: tokens.access_token,\n    });\n  } catch (error: any) {\n    console.error('Google OAuth token exchange error:', error);\n    return NextResponse.json(\n      { error: error.message || 'Internal server error' },\n      { status: 500 }\n    );\n  }\n}\n\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,mBAAmB,gHAA4C;AACrE,MAAM,uBAAuB,QAAQ,GAAG,CAAC,oBAAoB,IAAI;AAE1D,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,IAAI,EAAE,YAAY,EAAE,WAAW,EAAE,GAAG;QAE5C,IAAI,CAAC,QAAQ,CAAC,cAAc;YAC1B,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAsC,GAC/C;gBAAE,QAAQ;YAAI;QAElB;QAEA;;QAQA,yBAAyB;QACzB,MAAM,wBACJ,QAAQ,GAAG,CAAC,oBAAoB,IAChC,QAAQ,OAAO,CAAC,MAAM,IACtB,oJAAc;QAEhB,MAAM,cAAc,IAAI,gBAAgB;YACtC,MAAM;YACN,WAAW;YACX,cAAc,eAAe,GAAG,sBAAsB,qBAAqB,CAAC;YAC5E,YAAY;YACZ,eAAe;QACjB;QAEA,4EAA4E;QAC5E,0EAA0E;QAC1E,+DAA+D;QAC/D,IAAI,sBAAsB;YACxB,YAAY,MAAM,CAAC,iBAAiB;QACtC;QAEA,oDAAoD;QACpD,MAAM,gBAAgB,MAAM,MAAM,uCAAuC;YACvE,QAAQ;YACR,SAAS;gBACP,gBAAgB;YAClB;YACA,MAAM;QACR;QAEA,IAAI,CAAC,cAAc,EAAE,EAAE;YACrB,MAAM,YAAY,MAAM,cAAc,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YAC5D,MAAM,eAAe,UAAU,iBAAiB,IAAI,UAAU,KAAK,IAAI;YAEvE,QAAQ,KAAK,CAAC,gCAAgC;gBAC5C,QAAQ,cAAc,MAAM;gBAC5B,OAAO;gBACP,iBAAiB,CAAC,CAAC;YACrB;YAEA,gCAAgC;YAChC,IAAI,UAAU,KAAK,KAAK,oBAAoB,CAAC,sBAAsB;gBACjE,OAAO,gJAAY,CAAC,IAAI,CACtB;oBACE,OAAO;oBACP,SAAS;gBACX,GACA;oBAAE,QAAQ;gBAAI;YAElB;YAEA,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAa,GACtB;gBAAE,QAAQ,cAAc,MAAM;YAAC;QAEnC;QAEA,MAAM,SAAS,MAAM,cAAc,IAAI;QAEvC,IAAI,CAAC,OAAO,QAAQ,EAAE;YACpB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAuC,GAChD;gBAAE,QAAQ;YAAI;QAElB;QAEA,sCAAsC;QACtC,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS,OAAO,QAAQ;YACxB,aAAa,OAAO,YAAY;QAClC;IACF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,sCAAsC;QACpD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,MAAM,OAAO,IAAI;QAAwB,GAClD;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}