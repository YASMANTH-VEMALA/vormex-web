{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/auth/ProtectedRoute.tsx"],"sourcesContent":["'use client';\n\nimport React from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useAuth } from '@/lib/auth/useAuth';\n\ninterface ProtectedRouteProps {\n  children: React.ReactNode;\n}\n\nexport function ProtectedRoute({ children }: ProtectedRouteProps) {\n  const { isAuthenticated, loading } = useAuth();\n  const router = useRouter();\n\n  React.useEffect(() => {\n    if (!loading && !isAuthenticated) {\n      router.push('/login');\n    }\n  }, [isAuthenticated, loading, router]);\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen bg-gray-50 dark:bg-neutral-950\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600 dark:text-neutral-400\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!isAuthenticated) {\n    return null;\n  }\n\n  return <>{children}</>;\n}\n\n"],"names":["c","_c","React","useRouter","useAuth","ProtectedRouteProps","children","ReactNode","ProtectedRoute","t0","$","$i","Symbol","for","isAuthenticated","loading","router","t1","t2","ProtectedRoute[useEffect()]","push","useEffect","t3"],"mappings":";;;;;AAAa,SAAAA,CAAA,IAAAC,EAAA;AAEb,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,SAAS,QAAQ,iBAAiB;AAC3C,SAASC,OAAO,QAAQ,oBAAoB;;;AAJ5C,YAAY;;;;;AAUL,wBAAAK,EAAA;;IAAA,MAAAC,CAAA,OAAAT,gLAAA,EAAA;IAAA,IAAAS,CAAA,CAAA,EAAA,KAAA,oEAAA;QAAA,IAAA,IAAAC,EAAA,GAAA,GAAAA,EAAA,GAAA,GAAAA,EAAA,IAAA,EAAA;YAAAD,CAAA,CAAAC,EAAA,CAAA,GAAAC,MAAA,CAAAC,GAAA,CAAA;QAAA;QAAAH,CAAA,CAAA,EAAA,GAAA;IAAA;IAAwB,MAAA,EAAAJ,QAAAA,EAAA,GAAAG,EAAiC;IAC9D,MAAA,EAAAK,eAAA,EAAAC,OAAAA,EAAA;IACA,MAAAC,MAAA;IAA2B,IAAAC,EAAA;IAAA,IAAAC,EAAA;IAAA,IAAAR,CAAA,CAAA,EAAA,KAAAI,eAAA,IAAAJ,CAAA,CAAA,EAAA,KAAAK,OAAA,IAAAL,CAAA,CAAA,EAAA,KAAAM,MAAA,EAAA;QAEXC,EAAA,GAAA,CAAA;YAAA,+BAAAE,CAAA;gBACd,IAAI,CAACJ,OAA2B,IAA5B,CAAaD,eAAe,EAAA;oBAC9BE,MAAM,CAAAI,IAAK,CAAC,QAAQ,CAAC;gBAAA;YACtB;SAAA,CAAA,CAAA,8BACF;QAAEF,EAAA,GAAA;YAACJ,eAAe;YAAEC,OAAO;YAAEC,MAAM;SAAC;QAAAN,CAAA,CAAA,EAAA,GAAAI,eAAA;QAAAJ,CAAA,CAAA,EAAA,GAAAK,OAAA;QAAAL,CAAA,CAAA,EAAA,GAAAM,MAAA;QAAAN,CAAA,CAAA,EAAA,GAAAO,EAAA;QAAAP,CAAA,CAAA,EAAA,GAAAQ,EAAA;IAAA,OAAA;QAAAD,EAAA,GAAAP,CAAA,CAAA,EAAA;QAAAQ,EAAA,GAAAR,CAAA,CAAA,EAAA;IAAA;IAJrCR,wKAAK,CAAAmB,SAAU,CAACJ,EAIf,EAAEC,EAAkC,CAAC;IAEtC,IAAIH,OAAO,EAAA;QAAA,IAAAO,EAAA;QAAA,IAAAZ,CAAA,CAAA,EAAA,KAAAE,MAAA,CAAAC,GAAA,CAAA,8BAAA;YAEPS,EAAA,iBAAA,6LAAA,GAKM;gBALS,SAA8E,EAA9E,8EAA8E;wCAC3F,6LAAA,GAGM;oBAHS,SAAa,EAAb,aAAa;;sCAC1B,6LAAA,GAA8F;4BAA/E,SAAwE,EAAxE,wEAAwE;;;;;;sCACvF,6LAAA,CAAsE;4BAAzD,SAA0C,EAA1C,0CAA0C;sCAAC,UAAU,EAAlE,CAAsE,CACxE,EAHA,GAGM,CACR,EALA,GAKM;;;;;;;;;;;;;;;;;YAAAZ,CAAA,CAAA,EAAA,GAAAY,EAAA;QAAA,OAAA;YAAAA,EAAA,GAAAZ,CAAA,CAAA,EAAA;QAAA;QAAA,OALNY,EAKM;IAAA;IAIV,IAAI,CAACR,eAAe,EAAA;QAAA,OACX,IAAI;IAAA;IACZ,IAAAQ,EAAA;IAAA,IAAAZ,CAAA,CAAA,EAAA,KAAAJ,QAAA,EAAA;QAEMgB,EAAA,iBAAA,EAAGhB;sBAAAA,QAAO,CAAC,GAAI;;QAAAI,CAAA,CAAA,EAAA,GAAAJ,QAAA;QAAAI,CAAA,CAAA,EAAA,GAAAY,EAAA;IAAA,OAAA;QAAAA,EAAA,GAAAZ,CAAA,CAAA,EAAA;IAAA;IAAA,OAAfY,EAAe;AAAA;;;QAxBelB,2IAAO,CAAC,CAAC;QAC/BD,kJAAS,CAAC,CAAC;;;KAFrBK","ignoreList":[]}},
    {"offset": {"line": 128, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/lib/api/chat.ts"],"sourcesContent":["import apiClient from './client';\n\n// ============================================\n// Types\n// ============================================\n\nexport interface ChatUser {\n  id: string;\n  username: string;\n  name: string;\n  profileImage: string | null;\n  isOnline: boolean;\n  lastActiveAt: string | null;\n}\n\nexport interface Message {\n  id: string;\n  conversationId: string;\n  senderId: string;\n  receiverId: string;\n  content: string;\n  contentType: string;\n  mediaUrl?: string;\n  mediaType?: string;\n  fileName?: string;\n  fileSize?: number;\n  status: 'SENT' | 'DELIVERED' | 'READ';\n  deliveredAt?: string;\n  readAt?: string;\n  isDeleted: boolean;\n  isEdited?: boolean; // Client-side flag to track if message was edited\n  replyToId?: string;\n  replyTo?: {\n    id: string;\n    content: string;\n    contentType: string;\n    senderId: string;\n  };\n  sender: ChatUser;\n  reactions: MessageReaction[];\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface MessageReaction {\n  id: string;\n  userId: string;\n  emoji: string;\n  user: {\n    id: string;\n    username: string;\n    name: string;\n  };\n}\n\nexport interface Conversation {\n  id: string;\n  participant1Id: string;\n  participant2Id: string;\n  participant1: ChatUser;\n  participant2: ChatUser;\n  otherParticipant: ChatUser;\n  lastMessage?: {\n    id: string;\n    content: string;\n    contentType: string;\n    senderId: string;\n    status: 'SENT' | 'DELIVERED' | 'READ';\n    createdAt: string;\n  };\n  lastMessageAt?: string;\n  unreadCount: number;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface ConversationsResponse {\n  conversations: Conversation[];\n  hasMore: boolean;\n  nextCursor?: string;\n}\n\nexport interface MessagesResponse {\n  messages: Message[];\n  hasMore: boolean;\n  nextCursor?: string;\n}\n\n// ============================================\n// Chat API Functions\n// ============================================\n\n/**\n * Get all conversations for the current user\n */\nexport async function getConversations(\n  limit?: number,\n  cursor?: string\n): Promise<ConversationsResponse> {\n  const params = new URLSearchParams();\n  if (limit) params.append('limit', String(limit));\n  if (cursor) params.append('cursor', cursor);\n  \n  return apiClient.get(`/chat/conversations?${params.toString()}`);\n}\n\n/**\n * Get or create a conversation with another user\n */\nexport async function getOrCreateConversation(participantId: string): Promise<Conversation> {\n  return apiClient.post('/chat/conversations', { participantId });\n}\n\n/**\n * Get a specific conversation\n */\nexport async function getConversation(conversationId: string): Promise<Conversation> {\n  return apiClient.get(`/chat/conversations/${conversationId}`);\n}\n\n/**\n * Get messages for a conversation\n */\nexport async function getMessages(\n  conversationId: string,\n  limit?: number,\n  cursor?: string\n): Promise<MessagesResponse> {\n  const params = new URLSearchParams();\n  if (limit) params.append('limit', String(limit));\n  if (cursor) params.append('cursor', cursor);\n  \n  return apiClient.get(`/chat/conversations/${conversationId}/messages?${params.toString()}`);\n}\n\n/**\n * Send a message (REST fallback - prefer WebSocket)\n */\nexport async function sendMessage(\n  conversationId: string,\n  data: {\n    content: string;\n    contentType?: string;\n    mediaUrl?: string;\n    mediaType?: string;\n    fileName?: string;\n    fileSize?: number;\n    replyToId?: string;\n  }\n): Promise<Message> {\n  return apiClient.post(`/chat/conversations/${conversationId}/messages`, data);\n}\n\n/**\n * Mark messages as read\n */\nexport async function markAsRead(conversationId: string): Promise<{ updatedCount: number; readAt: string }> {\n  return apiClient.post(`/chat/conversations/${conversationId}/read`);\n}\n\n/**\n * Delete a message\n */\nexport async function deleteMessage(\n  messageId: string,\n  forEveryone?: boolean\n): Promise<{ success: boolean }> {\n  return apiClient.delete(`/chat/messages/${messageId}`, { \n    data: { forEveryone } \n  });\n}\n\n/**\n * Edit a message\n */\nexport async function editMessage(messageId: string, content: string): Promise<Message> {\n  return apiClient.patch(`/chat/messages/${messageId}`, { content });\n}\n\n/**\n * Add reaction to a message\n */\nexport async function addReaction(\n  messageId: string,\n  emoji: string\n): Promise<{ action: 'added' | 'removed' | 'updated'; emoji: string }> {\n  return apiClient.post(`/chat/messages/${messageId}/reactions`, { emoji });\n}\n\n/**\n * Get unread message count\n */\nexport async function getUnreadCount(): Promise<{ unreadCount: number }> {\n  return apiClient.get('/chat/unread-count');\n}\n\n/**\n * Search messages\n */\nexport async function searchMessages(\n  query: string,\n  limit?: number\n): Promise<{ messages: Message[] }> {\n  const params = new URLSearchParams();\n  params.append('q', query);\n  if (limit) params.append('limit', String(limit));\n  \n  return apiClient.get(`/chat/search?${params.toString()}`);\n}\n\n/**\n * Upload chat media (image, video, document, audio)\n */\nexport async function uploadChatMedia(\n  file: File,\n  mediaType: 'image' | 'video' | 'document' | 'audio',\n  onProgress?: (progress: number) => void\n): Promise<{\n  mediaUrl: string;\n  fileName: string;\n  fileSize: number;\n  mediaType: string;\n}> {\n  const formData = new FormData();\n  formData.append('file', file);\n  formData.append('mediaType', mediaType);\n  \n  // Use axios with proper config for file uploads\n  return apiClient.post('/chat/upload', formData, {\n    timeout: 120000, // 2 minutes timeout for large files\n    maxContentLength: Infinity,\n    maxBodyLength: Infinity,\n    onUploadProgress: (progressEvent) => {\n      if (onProgress && progressEvent.total) {\n        const progress = Math.round((progressEvent.loaded / progressEvent.total) * 100);\n        onProgress(progress);\n      }\n    },\n  });\n}\n\n// ============================================\n// Message Limit (Connection-based)\n// ============================================\n\nexport interface MessageLimitStatus {\n  canSend: boolean;\n  isConnected: boolean;\n  messagesSent: number;\n  messagesRemaining: number;\n  limit: number;\n}\n\n/**\n * Get message limit status for a user\n * Non-connected users can only send 2 messages\n * Connected users have unlimited messaging\n */\nexport async function getMessageLimitStatus(userId: string): Promise<MessageLimitStatus> {\n  return apiClient.get(`/chat/message-limit/${userId}`);\n}\n\n// ============================================\n// Message Requests (from non-connected users)\n// ============================================\n\nexport interface MessageRequest extends Conversation {\n  isMessageRequest: boolean;\n  messageRequestAcceptedAt: string | null;\n}\n\nexport interface MessageRequestsResponse {\n  messageRequests: MessageRequest[];\n  hasMore: boolean;\n  nextCursor?: string;\n}\n\n/**\n * Get message requests (conversations from non-connected users)\n */\nexport async function getMessageRequests(\n  limit?: number,\n  cursor?: string\n): Promise<MessageRequestsResponse> {\n  const params = new URLSearchParams();\n  if (limit) params.append('limit', String(limit));\n  if (cursor) params.append('cursor', cursor);\n  \n  return apiClient.get(`/chat/requests?${params.toString()}`);\n}\n\n/**\n * Get message requests count\n */\nexport async function getMessageRequestsCount(): Promise<{ count: number }> {\n  return apiClient.get('/chat/requests/count');\n}\n\n/**\n * Accept a message request\n */\nexport async function acceptMessageRequest(\n  conversationId: string\n): Promise<{ message: string; conversation: Conversation }> {\n  return apiClient.post(`/chat/requests/${conversationId}/accept`);\n}\n\n/**\n * Decline a message request\n */\nexport async function declineMessageRequest(\n  conversationId: string\n): Promise<{ message: string }> {\n  return apiClient.delete(`/chat/requests/${conversationId}`);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 260, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/chat/ChatList.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useState, useCallback } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { getConversations, Conversation } from '@/lib/api/chat';\nimport { initializeSocket, getSocket } from '@/lib/socket';\nimport { formatDistanceToNow } from 'date-fns';\nimport { cn } from '@/lib/utils';\n\ninterface ChatListProps {\n  selectedConversationId?: string;\n  onSelectConversation?: (conversation: Conversation) => void;\n  currentUserId?: string;\n}\n\nexport default function ChatList({ \n  selectedConversationId, \n  onSelectConversation,\n  currentUserId \n}: ChatListProps) {\n  const router = useRouter();\n  const [conversations, setConversations] = useState<Conversation[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [hasMore, setHasMore] = useState(false);\n  const [nextCursor, setNextCursor] = useState<string | undefined>();\n\n  const fetchConversations = useCallback(async (cursor?: string) => {\n    try {\n      // Only show loading if we don't have any conversations yet\n      if (conversations.length === 0) {\n        setLoading(true);\n      }\n      const result = await getConversations(30, cursor);\n      \n      if (cursor) {\n        setConversations(prev => [...prev, ...result.conversations]);\n      } else {\n        setConversations(result.conversations);\n      }\n      \n      setHasMore(result.hasMore);\n      setNextCursor(result.nextCursor);\n    } catch (err: any) {\n      setError(err.message || 'Failed to load conversations');\n    } finally {\n      setLoading(false);\n    }\n  }, [conversations.length]);\n\n  useEffect(() => {\n    fetchConversations();\n  }, [fetchConversations]);\n\n  // Listen for new messages to update conversation list\n  useEffect(() => {\n    const socket = getSocket();\n    \n    if (!socket) return;\n\n    // Track recently processed message IDs to prevent duplicates\n    const processedMessageIds = new Set<string>();\n\n    const handleNewMessage = (data: { conversationId: string; message: any }) => {\n      // Deduplicate: skip if already processed\n      if (processedMessageIds.has(data.message.id)) {\n        return;\n      }\n      processedMessageIds.add(data.message.id);\n      // Keep set bounded\n      if (processedMessageIds.size > 50) {\n        const first = processedMessageIds.values().next().value;\n        if (first !== undefined) processedMessageIds.delete(first);\n      }\n\n      setConversations(prev => {\n        const existingIndex = prev.findIndex(c => c.id === data.conversationId);\n        \n        if (existingIndex >= 0) {\n          // Check if this is truly a new message (not already displayed)\n          const existingConv = prev[existingIndex];\n          if (existingConv.lastMessage?.id === data.message.id) {\n            return prev; // Same message, skip update\n          }\n\n          // Update existing conversation and move to top\n          const updated = [...prev];\n          const conv = { ...updated[existingIndex] };\n          conv.lastMessage = {\n            id: data.message.id,\n            content: data.message.content,\n            contentType: data.message.contentType,\n            senderId: data.message.senderId,\n            status: data.message.status,\n            createdAt: data.message.createdAt,\n          };\n          conv.lastMessageAt = data.message.createdAt;\n          \n          // Increment unread if not the sender\n          if (data.message.senderId !== currentUserId && data.conversationId !== selectedConversationId) {\n            conv.unreadCount = (conv.unreadCount || 0) + 1;\n          }\n          \n          updated.splice(existingIndex, 1);\n          return [conv, ...updated];\n        }\n        \n        // Refresh to get new conversation\n        fetchConversations();\n        return prev;\n      });\n    };\n\n    // Handle chat:notification which has a slightly different structure\n    const handleChatNotification = (data: { type: string; conversationId: string; message: any }) => {\n      if (data.type === 'new_message') {\n        handleNewMessage({ conversationId: data.conversationId, message: data.message });\n      }\n    };\n\n    const handleMessagesRead = (data: { conversationId: string }) => {\n      setConversations(prev => \n        prev.map(c => \n          c.id === data.conversationId \n            ? { ...c, unreadCount: 0 } \n            : c\n        )\n      );\n    };\n\n    socket.on('chat:new_message', handleNewMessage);\n    socket.on('chat:notification', handleChatNotification);\n    socket.on('chat:messages_read', handleMessagesRead);\n\n    return () => {\n      socket.off('chat:new_message', handleNewMessage);\n      socket.off('chat:notification', handleChatNotification);\n      socket.off('chat:messages_read', handleMessagesRead);\n    };\n  }, [currentUserId, selectedConversationId, fetchConversations]);\n\n  const handleSelectConversation = (conversation: Conversation) => {\n    if (onSelectConversation) {\n      onSelectConversation(conversation);\n    } else {\n      router.push(`/messages/${conversation.id}`);\n    }\n  };\n\n  const loadMore = () => {\n    if (hasMore && nextCursor) {\n      fetchConversations(nextCursor);\n    }\n  };\n\n  if (loading && conversations.length === 0) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"p-4 text-center text-red-500\">\n        {error}\n        <button \n          onClick={() => fetchConversations()}\n          className=\"block mx-auto mt-2 text-blue-500 hover:underline\"\n        >\n          Retry\n        </button>\n      </div>\n    );\n  }\n\n  if (conversations.length === 0) {\n    return (\n      <div className=\"p-8 text-center text-gray-500 dark:text-gray-400\">\n        <div className=\"text-4xl mb-4\">üí¨</div>\n        <p>No conversations yet</p>\n        <p className=\"text-sm mt-2\">Start a chat with someone!</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex flex-col h-full\">\n      <div className=\"flex-1 overflow-y-auto\">\n        {conversations.map((conversation) => (\n          <ConversationItem\n            key={conversation.id}\n            conversation={conversation}\n            isSelected={selectedConversationId === conversation.id}\n            currentUserId={currentUserId}\n            onClick={() => handleSelectConversation(conversation)}\n          />\n        ))}\n        \n        {hasMore && (\n          <button\n            onClick={loadMore}\n            disabled={loading}\n            className=\"w-full py-3 text-sm text-blue-600 hover:bg-gray-50 dark:hover:bg-gray-800\"\n          >\n            {loading ? 'Loading...' : 'Load more'}\n          </button>\n        )}\n      </div>\n    </div>\n  );\n}\n\n// ============================================\n// Conversation Item Component\n// ============================================\ninterface ConversationItemProps {\n  conversation: Conversation;\n  isSelected: boolean;\n  currentUserId?: string;\n  onClick: () => void;\n}\n\nfunction ConversationItem({ \n  conversation, \n  isSelected, \n  currentUserId,\n  onClick \n}: ConversationItemProps) {\n  const other = conversation.otherParticipant;\n  const lastMessage = conversation.lastMessage;\n  const isUnread = conversation.unreadCount > 0;\n  const isSentByMe = lastMessage?.senderId === currentUserId;\n\n  return (\n    <div\n      onClick={onClick}\n      className={cn(\n        'flex items-center gap-3 p-3 cursor-pointer transition-colors border-b border-gray-100 dark:border-gray-800',\n        isSelected \n          ? 'bg-blue-50 dark:bg-blue-900/20' \n          : 'hover:bg-gray-50 dark:hover:bg-gray-800/50',\n        isUnread && !isSelected && 'bg-gray-50 dark:bg-gray-800/30'\n      )}\n    >\n      {/* Avatar */}\n      <div className=\"relative flex-shrink-0\">\n        <div className=\"w-12 h-12 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white font-semibold\">\n          {other.profileImage ? (\n            <img\n              src={other.profileImage}\n              alt={other.name}\n              className=\"w-12 h-12 rounded-full object-cover\"\n            />\n          ) : (\n            other.name.charAt(0).toUpperCase()\n          )}\n        </div>\n        {/* Online indicator */}\n        {other.isOnline && (\n          <div className=\"absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-gray-900\"></div>\n        )}\n      </div>\n\n      {/* Content */}\n      <div className=\"flex-1 min-w-0\">\n        <div className=\"flex items-center justify-between\">\n          <span className={cn(\n            'font-medium truncate',\n            isUnread && 'text-gray-900 dark:text-white font-semibold'\n          )}>\n            {other.name}\n          </span>\n          {lastMessage && (\n            <span className=\"text-xs text-gray-500 flex-shrink-0\">\n              {formatDistanceToNow(new Date(lastMessage.createdAt), { addSuffix: false })}\n            </span>\n          )}\n        </div>\n        \n        <div className=\"flex items-center gap-1\">\n          {lastMessage ? (\n            <>\n              {isSentByMe && (\n                <span className=\"text-gray-400 text-sm\">\n                  {lastMessage.status === 'READ' ? '‚úì‚úì' : lastMessage.status === 'DELIVERED' ? '‚úì‚úì' : '‚úì'}\n                </span>\n              )}\n              <p className={cn(\n                'text-sm truncate',\n                isUnread \n                  ? 'text-gray-900 dark:text-white font-medium' \n                  : 'text-gray-500 dark:text-gray-400'\n              )}>\n                {lastMessage.contentType === 'image' ? 'üì∑ Photo' :\n                 lastMessage.contentType === 'file' ? 'üìé File' :\n                 lastMessage.contentType === 'voice' ? 'üé§ Voice message' :\n                 lastMessage.contentType === 'post' ? 'üìÑ Shared a post' :\n                 lastMessage.contentType === 'reel' ? 'üé¨ Reel' :\n                 lastMessage.contentType === 'video' ? 'üé¨ Video' :\n                 lastMessage.content}\n              </p>\n            </>\n          ) : (\n            <p className=\"text-sm text-gray-400 italic\">No messages yet</p>\n          )}\n        </div>\n      </div>\n\n      {/* Unread badge */}\n      {isUnread && (\n        <div className=\"flex-shrink-0 w-5 h-5 bg-blue-600 rounded-full flex items-center justify-center\">\n          <span className=\"text-xs text-white font-medium\">\n            {conversation.unreadCount > 9 ? '9+' : conversation.unreadCount}\n          </span>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["c","_c","React","useEffect","useState","useCallback","useRouter","getConversations","Conversation","initializeSocket","getSocket","formatDistanceToNow","cn","ChatListProps","selectedConversationId","onSelectConversation","conversation","currentUserId","ChatList","router","conversations","setConversations","loading","setLoading","error","setError","hasMore","setHasMore","nextCursor","setNextCursor","fetchConversations","cursor","length","result","prev","err","message","socket","processedMessageIds","Set","handleNewMessage","data","conversationId","has","id","add","size","first","values","next","value","undefined","delete","existingIndex","findIndex","existingConv","lastMessage","updated","conv","content","contentType","senderId","status","createdAt","lastMessageAt","unreadCount","splice","handleChatNotification","type","handleMessagesRead","map","on","off","handleSelectConversation","push","loadMore","ConversationItemProps","isSelected","onClick","ConversationItem","t0","$","$i","Symbol","for","other","otherParticipant","isUnread","isSentByMe","t1","t2","t3","t4","name","profileImage","charAt","toUpperCase","t5","t6","isOnline","t7","t8","t9","t10","t11","Date","addSuffix","t12","t13","t14","t15","t16"],"mappings":"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","ignoreList":[]}},
    {"offset": {"line": 826, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/lib/chat/customization.ts"],"sourcesContent":["export const DEFAULT_CHAT_REACTIONS = ['‚ù§Ô∏è', 'üëç', 'üòÇ', 'üòÆ', 'üò¢', 'üôè'];\n\nexport const REACTION_PACK_EMOJIS: Record<string, string[]> = {\n  'chat-reaction-startup-vibes': ['üöÄ', 'üí°', 'üî•', 'üôå', '‚ö°', 'üìà'],\n  'chat-reaction-desi-memes': ['ü§£', 'üòé', 'ü´°', 'ü§å', 'üíÉ', 'üòè'],\n  'chat-reaction-finance-bros': ['üí∏', 'ü§ë', 'üìâ', 'üí∞', 'üè¶', 'ü§ù'],\n};\n\nexport const WALLPAPER_PACK_REQUIREMENTS: Record<string, string> = {\n  'gradient-2': 'chat-theme-vibrant-dms',\n  'gradient-5': 'chat-theme-vibrant-dms',\n  'pattern-1': 'chat-theme-vibrant-dms',\n  'gradient-4': 'chat-theme-dark-variants',\n  'gradient-6': 'chat-theme-dark-variants',\n  'pattern-2': 'chat-theme-dark-variants',\n};\n\nexport interface MessageEffectEntitlements {\n  confetti: boolean;\n  fireworks: boolean;\n  voiceSfx: boolean;\n}\n\nexport interface ChatCustomizationEntitlements {\n  ownedItemSlugs: string[];\n  ownedThemePacks: string[];\n  availableReactions: string[];\n  animatedBubbles: boolean;\n  messageEffects: MessageEffectEntitlements;\n}\n\nexport const DEFAULT_CHAT_CUSTOMIZATION_ENTITLEMENTS: ChatCustomizationEntitlements = {\n  ownedItemSlugs: [],\n  ownedThemePacks: [],\n  availableReactions: DEFAULT_CHAT_REACTIONS,\n  animatedBubbles: false,\n  messageEffects: {\n    confetti: false,\n    fireworks: false,\n    voiceSfx: false,\n  },\n};\n\nexport function buildChatCustomizationEntitlements(\n  ownedItemSlugs: string[]\n): ChatCustomizationEntitlements {\n  const ownedSet = new Set(ownedItemSlugs);\n\n  const availableReactions = new Set(DEFAULT_CHAT_REACTIONS);\n  for (const [packSlug, emojis] of Object.entries(REACTION_PACK_EMOJIS)) {\n    if (ownedSet.has(packSlug)) {\n      for (const emoji of emojis) {\n        availableReactions.add(emoji);\n      }\n    }\n  }\n\n  const ownedThemePacks = [\n    'chat-theme-vibrant-dms',\n    'chat-theme-dark-variants',\n    'chat-theme-animated-bubbles',\n  ].filter((slug) => ownedSet.has(slug));\n\n  return {\n    ownedItemSlugs: ownedItemSlugs,\n    ownedThemePacks,\n    availableReactions: Array.from(availableReactions),\n    animatedBubbles: ownedSet.has('chat-theme-animated-bubbles'),\n    messageEffects: {\n      confetti: ownedSet.has('chat-effect-confetti'),\n      fireworks: ownedSet.has('chat-effect-fireworks'),\n      voiceSfx: ownedSet.has('chat-effect-voice-sfx'),\n    },\n  };\n}\n\nexport function isWallpaperUnlocked(\n  wallpaperId: string,\n  ownedThemePacks: string[]\n): boolean {\n  const requiredPack = WALLPAPER_PACK_REQUIREMENTS[wallpaperId];\n  if (!requiredPack) {\n    return true;\n  }\n\n  return ownedThemePacks.includes(requiredPack);\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAO,MAAM,yBAAyB;IAAC;IAAM;IAAM;IAAM;IAAM;IAAM;CAAK;AAEnE,MAAM,uBAAiD;IAC5D,+BAA+B;QAAC;QAAM;QAAM;QAAM;QAAM;QAAK;KAAK;IAClE,4BAA4B;QAAC;QAAM;QAAM;QAAM;QAAM;QAAM;KAAK;IAChE,8BAA8B;QAAC;QAAM;QAAM;QAAM;QAAM;QAAM;KAAK;AACpE;AAEO,MAAM,8BAAsD;IACjE,cAAc;IACd,cAAc;IACd,aAAa;IACb,cAAc;IACd,cAAc;IACd,aAAa;AACf;AAgBO,MAAM,0CAAyE;IACpF,gBAAgB,EAAE;IAClB,iBAAiB,EAAE;IACnB,oBAAoB;IACpB,iBAAiB;IACjB,gBAAgB;QACd,UAAU;QACV,WAAW;QACX,UAAU;IACZ;AACF;AAEO,SAAS,mCACd,cAAwB;IAExB,MAAM,WAAW,IAAI,IAAI;IAEzB,MAAM,qBAAqB,IAAI,IAAI;IACnC,KAAK,MAAM,CAAC,UAAU,OAAO,IAAI,OAAO,OAAO,CAAC,sBAAuB;QACrE,IAAI,SAAS,GAAG,CAAC,WAAW;YAC1B,KAAK,MAAM,SAAS,OAAQ;gBAC1B,mBAAmB,GAAG,CAAC;YACzB;QACF;IACF;IAEA,MAAM,kBAAkB;QACtB;QACA;QACA;KACD,CAAC,MAAM,CAAC,CAAC,OAAS,SAAS,GAAG,CAAC;IAEhC,OAAO;QACL,gBAAgB;QAChB;QACA,oBAAoB,MAAM,IAAI,CAAC;QAC/B,iBAAiB,SAAS,GAAG,CAAC;QAC9B,gBAAgB;YACd,UAAU,SAAS,GAAG,CAAC;YACvB,WAAW,SAAS,GAAG,CAAC;YACxB,UAAU,SAAS,GAAG,CAAC;QACzB;IACF;AACF;AAEO,SAAS,oBACd,WAAmB,EACnB,eAAyB;IAEzB,MAAM,eAAe,2BAA2B,CAAC,YAAY;IAC7D,IAAI,CAAC,cAAc;QACjB,OAAO;IACT;IAEA,OAAO,gBAAgB,QAAQ,CAAC;AAClC"}},
    {"offset": {"line": 934, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/chat/MessageMenu.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useRef, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { cn } from '@/lib/utils';\nimport {\n  Reply,\n  Copy,\n  Pencil,\n  Trash2,\n  Forward,\n  Star,\n  Pin,\n  MoreHorizontal,\n  Download,\n} from 'lucide-react';\nimport { DEFAULT_CHAT_REACTIONS } from '@/lib/chat/customization';\n\ninterface MessageMenuProps {\n  isOpen: boolean;\n  onClose: () => void;\n  isOwn: boolean;\n  messageContent: string;\n  hasMedia?: boolean;\n  mediaUrl?: string;\n  onReply: () => void;\n  onEdit?: () => void;\n  onDelete: (forEveryone: boolean) => void;\n  onReact: (emoji: string) => void;\n  onCopy: () => void;\n  onForward?: () => void;\n  onPin?: () => void;\n  onStar?: () => void;\n  availableReactions?: string[];\n  position?: { x: number; y: number };\n  anchorPosition?: 'left' | 'right';\n}\n\nexport default function MessageMenu({\n  isOpen,\n  onClose,\n  isOwn,\n  messageContent,\n  hasMedia,\n  mediaUrl,\n  onReply,\n  onEdit,\n  onDelete,\n  onReact,\n  onCopy,\n  onForward,\n  onPin,\n  onStar,\n  availableReactions = DEFAULT_CHAT_REACTIONS,\n  position,\n  anchorPosition = 'right',\n}: MessageMenuProps) {\n  const [showDeleteOptions, setShowDeleteOptions] = useState(false);\n  const showReactions = true;\n  const menuRef = useRef<HTMLDivElement>(null);\n\n  // Close menu when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\n        onClose();\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [isOpen, onClose]);\n\n  // Handle keyboard shortcuts\n  useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (!isOpen) return;\n      \n      if (event.key === 'Escape') {\n        onClose();\n      } else if (event.key === 'r' && !event.metaKey && !event.ctrlKey) {\n        onReply();\n        onClose();\n      } else if (event.key === 'c' && (event.metaKey || event.ctrlKey)) {\n        onCopy();\n        onClose();\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [isOpen, onClose, onReply, onCopy]);\n\n  const handleCopy = () => {\n    navigator.clipboard.writeText(messageContent);\n    onCopy();\n    onClose();\n  };\n\n  const handleDownload = () => {\n    if (mediaUrl) {\n      const link = document.createElement('a');\n      link.href = mediaUrl;\n      link.download = '';\n      link.target = '_blank';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n    }\n    onClose();\n  };\n\n  const menuItems = [\n    {\n      id: 'reply',\n      label: 'Reply',\n      icon: Reply,\n      onClick: () => { onReply(); onClose(); },\n      shortcut: 'R',\n    },\n    {\n      id: 'copy',\n      label: 'Copy',\n      icon: Copy,\n      onClick: handleCopy,\n      shortcut: '‚åòC',\n    },\n    ...(isOwn ? [{\n      id: 'edit',\n      label: 'Edit',\n      icon: Pencil,\n      onClick: () => { onEdit?.(); onClose(); },\n    }] : []),\n    ...(hasMedia && mediaUrl ? [{\n      id: 'download',\n      label: 'Download',\n      icon: Download,\n      onClick: handleDownload,\n    }] : []),\n    {\n      id: 'forward',\n      label: 'Forward',\n      icon: Forward,\n      onClick: () => { onForward?.(); onClose(); },\n      disabled: true, // Coming soon\n    },\n    {\n      id: 'pin',\n      label: 'Pin',\n      icon: Pin,\n      onClick: () => { onPin?.(); onClose(); },\n      disabled: true, // Coming soon\n    },\n    {\n      id: 'star',\n      label: 'Star',\n      icon: Star,\n      onClick: () => { onStar?.(); onClose(); },\n      disabled: true, // Coming soon\n    },\n    {\n      id: 'delete',\n      label: 'Delete',\n      icon: Trash2,\n      onClick: () => setShowDeleteOptions(true),\n      danger: true,\n    },\n  ];\n\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <motion.div\n          ref={menuRef}\n          initial={{ opacity: 0, scale: 0.95, y: -10 }}\n          animate={{ opacity: 1, scale: 1, y: 0 }}\n          exit={{ opacity: 0, scale: 0.95, y: -10 }}\n          transition={{ duration: 0.15 }}\n          className={cn(\n            'absolute z-50 min-w-[200px]',\n            'bg-white dark:bg-gray-800 rounded-xl shadow-xl',\n            'border border-gray-200 dark:border-gray-700',\n            'overflow-hidden'\n          )}\n          style={position ? {\n            top: position.y,\n            left: anchorPosition === 'left' ? position.x : undefined,\n            right: anchorPosition === 'right' ? position.x : undefined,\n          } : {\n            top: '-8px',\n            [anchorPosition === 'left' ? 'left' : 'right']: '100%',\n            marginLeft: anchorPosition === 'left' ? '8px' : undefined,\n            marginRight: anchorPosition === 'right' ? '8px' : undefined,\n          }}\n        >\n          {/* Reaction bar */}\n          {showReactions && !showDeleteOptions && (\n            <div className=\"p-2 border-b border-gray-200 dark:border-gray-700\">\n              <div className=\"flex items-center gap-1\">\n                {availableReactions.map((emoji) => (\n                  <button\n                    key={emoji}\n                    onClick={() => { onReact(emoji); onClose(); }}\n                    className=\"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-all hover:scale-125\"\n                  >\n                    <span className=\"text-lg\">{emoji}</span>\n                  </button>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Delete options submenu */}\n          {showDeleteOptions ? (\n            <div className=\"py-1\">\n              <div className=\"px-3 py-2 text-sm font-medium text-gray-500 dark:text-gray-400\">\n                Delete message?\n              </div>\n              <button\n                onClick={() => { onDelete(false); onClose(); }}\n                className=\"w-full flex items-center gap-3 px-3 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors\"\n              >\n                <Trash2 className=\"w-4 h-4\" />\n                <span>Delete for me</span>\n              </button>\n              {isOwn && (\n                <button\n                  onClick={() => { onDelete(true); onClose(); }}\n                  className=\"w-full flex items-center gap-3 px-3 py-2 text-left text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors\"\n                >\n                  <Trash2 className=\"w-4 h-4\" />\n                  <span>Delete for everyone</span>\n                </button>\n              )}\n              <button\n                onClick={() => setShowDeleteOptions(false)}\n                className=\"w-full px-3 py-2 text-left text-sm text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors\"\n              >\n                Cancel\n              </button>\n            </div>\n          ) : (\n            /* Main menu items */\n            <div className=\"py-1\">\n              {menuItems.map((item) => (\n                <button\n                  key={item.id}\n                  onClick={item.onClick}\n                  disabled={item.disabled}\n                  className={cn(\n                    'w-full flex items-center justify-between gap-3 px-3 py-2 text-left text-sm transition-colors',\n                    item.danger\n                      ? 'text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20'\n                      : 'text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700',\n                    item.disabled && 'opacity-50 cursor-not-allowed'\n                  )}\n                >\n                  <div className=\"flex items-center gap-3\">\n                    <item.icon className=\"w-4 h-4\" />\n                    <span>{item.label}</span>\n                    {item.disabled && (\n                      <span className=\"text-xs text-gray-400\">(soon)</span>\n                    )}\n                  </div>\n                  {item.shortcut && (\n                    <span className=\"text-xs text-gray-400\">{item.shortcut}</span>\n                  )}\n                </button>\n              ))}\n            </div>\n          )}\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n}\n\n// Simple hover-based quick actions component (Discord style)\ninterface QuickActionsProps {\n  isVisible: boolean;\n  isOwn: boolean;\n  onReply: () => void;\n  onReact: () => void;\n  onMore: () => void;\n}\n\nexport function MessageQuickActions({\n  isVisible,\n  isOwn,\n  onReply,\n  onReact,\n  onMore,\n}: QuickActionsProps) {\n  return (\n    <AnimatePresence>\n      {isVisible && (\n        <motion.div\n          initial={{ opacity: 0, y: 5 }}\n          animate={{ opacity: 1, y: 0 }}\n          exit={{ opacity: 0, y: 5 }}\n          transition={{ duration: 0.1 }}\n          className={cn(\n            'absolute -top-8 flex items-center gap-0.5',\n            'bg-white dark:bg-gray-800 rounded-lg shadow-lg',\n            'border border-gray-200 dark:border-gray-700 p-0.5',\n            isOwn ? 'right-0' : 'left-8'\n          )}\n        >\n          <button\n            onClick={onReact}\n            className=\"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors\"\n            title=\"Add reaction\"\n          >\n            <span className=\"text-sm\">üòÄ</span>\n          </button>\n          <button\n            onClick={onReply}\n            className=\"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors\"\n            title=\"Reply\"\n          >\n            <Reply className=\"w-4 h-4 text-gray-500\" />\n          </button>\n          <button\n            onClick={onMore}\n            className=\"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors\"\n            title=\"More options\"\n          >\n            <MoreHorizontal className=\"w-4 h-4 text-gray-500\" />\n          </button>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n}\n"],"names":["c","_c","React","useState","useRef","useEffect","motion","AnimatePresence","cn","Reply","Copy","Pencil","Trash2","Forward","Star","Pin","MoreHorizontal","Download","DEFAULT_CHAT_REACTIONS","MessageMenuProps","isOpen","onClose","isOwn","messageContent","hasMedia","mediaUrl","onReply","onEdit","onDelete","forEveryone","onReact","emoji","onCopy","onForward","onPin","onStar","availableReactions","position","x","y","anchorPosition","MessageMenu","showDeleteOptions","setShowDeleteOptions","showReactions","menuRef","HTMLDivElement","handleClickOutside","event","MouseEvent","current","contains","target","Node","document","addEventListener","removeEventListener","handleKeyDown","KeyboardEvent","key","metaKey","ctrlKey","handleCopy","navigator","clipboard","writeText","handleDownload","link","createElement","href","download","body","appendChild","click","removeChild","menuItems","id","label","icon","onClick","shortcut","disabled","danger","opacity","scale","duration","top","left","undefined","right","marginLeft","marginRight","map","item","QuickActionsProps","isVisible","onMore","MessageQuickActions","t0","$","$i","Symbol","for","t1","t2"],"mappings":"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","ignoreList":[]}},
    {"offset": {"line": 1449, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/chat/ChatSettingsPanel.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { cn } from '@/lib/utils';\nimport {\n  X,\n  Image as ImageIcon,\n  FileText,\n  Video,\n  Trash2,\n  Bell,\n  BellOff,\n  Ban,\n  Flag,\n  Search,\n  Lock,\n} from 'lucide-react';\nimport { isWallpaperUnlocked } from '@/lib/chat/customization';\n\n// Wallpaper option type\ninterface WallpaperOption {\n  id: string;\n  name: string;\n  color: string;\n  preview?: string | null;\n  pattern?: string;\n  requiredPackSlug?: string;\n}\n\n// Default wallpaper options\nconst WALLPAPER_OPTIONS: WallpaperOption[] = [\n  { id: 'default', name: 'Default', color: 'bg-gray-50 dark:bg-gray-900' },\n  { id: 'gradient-1', name: 'Ocean', color: 'bg-gradient-to-br from-blue-100 to-cyan-100 dark:from-blue-900/30 dark:to-cyan-900/30' },\n  { id: 'gradient-2', name: 'Sunset', color: 'bg-gradient-to-br from-orange-100 to-pink-100 dark:from-orange-900/30 dark:to-pink-900/30', requiredPackSlug: 'chat-theme-vibrant-dms' },\n  { id: 'gradient-3', name: 'Forest', color: 'bg-gradient-to-br from-green-100 to-emerald-100 dark:from-green-900/30 dark:to-emerald-900/30' },\n  { id: 'gradient-4', name: 'Lavender', color: 'bg-gradient-to-br from-purple-100 to-violet-100 dark:from-purple-900/30 dark:to-violet-900/30', requiredPackSlug: 'chat-theme-dark-variants' },\n  { id: 'gradient-5', name: 'Rose', color: 'bg-gradient-to-br from-rose-100 to-pink-100 dark:from-rose-900/30 dark:to-pink-900/30', requiredPackSlug: 'chat-theme-vibrant-dms' },\n  { id: 'gradient-6', name: 'Midnight', color: 'bg-gradient-to-br from-slate-800 to-gray-900', requiredPackSlug: 'chat-theme-dark-variants' },\n  { id: 'gradient-7', name: 'Sky', color: 'bg-gradient-to-br from-sky-100 to-indigo-100 dark:from-sky-900/30 dark:to-indigo-900/30' },\n  { id: 'gradient-8', name: 'Amber', color: 'bg-gradient-to-br from-amber-100 to-yellow-100 dark:from-amber-900/30 dark:to-yellow-900/30' },\n  { id: 'pattern-1', name: 'Dots', color: 'bg-gray-100 dark:bg-gray-800', pattern: 'bg-[radial-gradient(circle,_#00000010_1px,_transparent_1px)] bg-[size:20px_20px]', requiredPackSlug: 'chat-theme-vibrant-dms' },\n  { id: 'pattern-2', name: 'Grid', color: 'bg-gray-100 dark:bg-gray-800', pattern: 'bg-[linear-gradient(#00000008_1px,_transparent_1px),linear-gradient(90deg,_#00000008_1px,_transparent_1px)] bg-[size:20px_20px]', requiredPackSlug: 'chat-theme-dark-variants' },\n];\n\ninterface MediaItem {\n  id: string;\n  type: 'image' | 'video' | 'file' | 'audio';\n  url: string;\n  fileName?: string;\n  createdAt: string;\n}\n\ninterface ChatSettingsPanelProps {\n  isOpen: boolean;\n  onClose: () => void;\n  conversationId: string;\n  otherUser: {\n    id: string;\n    name: string;\n    username: string;\n    profileImage?: string | null;\n    isOnline?: boolean;\n  };\n  currentWallpaper: string;\n  onWallpaperChange: (wallpaperId: string) => void;\n  mediaItems?: MediaItem[];\n  onClearChat?: () => void;\n  onBlockUser?: () => void;\n  onReportUser?: () => void;\n  ownedThemePacks?: string[];\n  onOpenStore?: () => void;\n}\n\ntype TabType = 'settings' | 'wallpaper' | 'media';\n\nexport default function ChatSettingsPanel({\n  isOpen,\n  onClose,\n  conversationId,\n  otherUser,\n  currentWallpaper,\n  onWallpaperChange,\n  mediaItems = [],\n  onClearChat,\n  onBlockUser,\n  onReportUser,\n  ownedThemePacks = [],\n  onOpenStore,\n}: ChatSettingsPanelProps) {\n  const [activeTab, setActiveTab] = useState<TabType>('settings');\n  const [isMuted, setIsMuted] = useState(() => {\n    if (typeof window === 'undefined') return false;\n    return localStorage.getItem(`chat_muted_${conversationId}`) === 'true';\n  });\n  const [mediaFilter, setMediaFilter] = useState<'all' | 'images' | 'videos' | 'files'>('all');\n  const [searchQuery, setSearchQuery] = useState('');\n\n  const handleMuteToggle = () => {\n    const newMuted = !isMuted;\n    setIsMuted(newMuted);\n    localStorage.setItem(`chat_muted_${conversationId}`, String(newMuted));\n  };\n\n  // Filter media items\n  const filteredMedia = mediaItems.filter(item => {\n    if (mediaFilter === 'all') return true;\n    if (mediaFilter === 'images') return item.type === 'image';\n    if (mediaFilter === 'videos') return item.type === 'video';\n    if (mediaFilter === 'files') return item.type === 'file' || item.type === 'audio';\n    return true;\n  });\n\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <>\n          {/* Backdrop */}\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            onClick={onClose}\n            className=\"fixed inset-0 bg-black/30 backdrop-blur-sm z-40\"\n          />\n\n          {/* Panel */}\n          <motion.div\n            initial={{ x: '100%' }}\n            animate={{ x: 0 }}\n            exit={{ x: '100%' }}\n            transition={{ type: 'spring', damping: 25, stiffness: 200 }}\n            className=\"fixed right-0 top-0 bottom-0 w-full max-w-md bg-white dark:bg-gray-900 shadow-xl z-50 flex flex-col\"\n          >\n            {/* Header */}\n            <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700\">\n              <h2 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                Chat Info\n              </h2>\n              <button\n                onClick={onClose}\n                className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors\"\n              >\n                <X className=\"w-5 h-5\" />\n              </button>\n            </div>\n\n            {/* User Info */}\n            <div className=\"p-6 border-b border-gray-200 dark:border-gray-700 flex flex-col items-center\">\n              <div className=\"w-20 h-20 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white text-2xl font-semibold mb-3\">\n                {otherUser.profileImage ? (\n                  <img\n                    src={otherUser.profileImage}\n                    alt={otherUser.name}\n                    className=\"w-20 h-20 rounded-full object-cover\"\n                  />\n                ) : (\n                  otherUser.name.charAt(0).toUpperCase()\n                )}\n              </div>\n              <h3 className=\"text-xl font-semibold text-gray-900 dark:text-white\">{otherUser.name}</h3>\n              <p className=\"text-gray-500 dark:text-gray-400\">@{otherUser.username}</p>\n              {otherUser.isOnline && (\n                <span className=\"mt-2 px-2 py-0.5 bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 text-xs rounded-full\">\n                  Online\n                </span>\n              )}\n            </div>\n\n            {/* Tabs */}\n            <div className=\"flex border-b border-gray-200 dark:border-gray-700\">\n              {[\n                { id: 'settings', label: 'Settings' },\n                { id: 'wallpaper', label: 'Wallpaper' },\n                { id: 'media', label: 'Media' },\n              ].map((tab) => (\n                <button\n                  key={tab.id}\n                  onClick={() => setActiveTab(tab.id as TabType)}\n                  className={cn(\n                    'flex-1 py-3 text-sm font-medium transition-colors relative',\n                    activeTab === tab.id\n                      ? 'text-blue-600 dark:text-blue-400'\n                      : 'text-gray-500 hover:text-gray-700 dark:hover:text-gray-300'\n                  )}\n                >\n                  {tab.label}\n                  {activeTab === tab.id && (\n                    <motion.div\n                      layoutId=\"activeTab\"\n                      className=\"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 dark:bg-blue-400\"\n                    />\n                  )}\n                </button>\n              ))}\n            </div>\n\n            {/* Tab Content */}\n            <div className=\"flex-1 overflow-y-auto\">\n              {/* Settings Tab */}\n              {activeTab === 'settings' && (\n                <div className=\"p-4 space-y-2\">\n                  {/* Mute Notifications */}\n                  <button\n                    onClick={handleMuteToggle}\n                    className=\"w-full flex items-center justify-between p-3 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors\"\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      {isMuted ? (\n                        <BellOff className=\"w-5 h-5 text-gray-500\" />\n                      ) : (\n                        <Bell className=\"w-5 h-5 text-gray-500\" />\n                      )}\n                      <span className=\"text-gray-900 dark:text-white\">Mute Notifications</span>\n                    </div>\n                    <div className={cn(\n                      'w-10 h-6 rounded-full transition-colors relative',\n                      isMuted ? 'bg-blue-600' : 'bg-gray-300 dark:bg-gray-600'\n                    )}>\n                      <div className={cn(\n                        'absolute top-1 w-4 h-4 bg-white rounded-full transition-transform',\n                        isMuted ? 'translate-x-5' : 'translate-x-1'\n                      )} />\n                    </div>\n                  </button>\n\n                  {/* Divider */}\n                  <div className=\"my-4 border-t border-gray-200 dark:border-gray-700\" />\n\n                  {/* Clear Chat */}\n                  <button\n                    onClick={onClearChat}\n                    className=\"w-full flex items-center gap-3 p-3 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors text-red-600 dark:text-red-400\"\n                  >\n                    <Trash2 className=\"w-5 h-5\" />\n                    <span>Clear Chat History</span>\n                  </button>\n\n                  {/* Block User */}\n                  <button\n                    onClick={onBlockUser}\n                    className=\"w-full flex items-center gap-3 p-3 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors text-red-600 dark:text-red-400\"\n                  >\n                    <Ban className=\"w-5 h-5\" />\n                    <span>Block {otherUser.name}</span>\n                  </button>\n\n                  {/* Report User */}\n                  <button\n                    onClick={onReportUser}\n                    className=\"w-full flex items-center gap-3 p-3 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors text-red-600 dark:text-red-400\"\n                  >\n                    <Flag className=\"w-5 h-5\" />\n                    <span>Report</span>\n                  </button>\n                </div>\n              )}\n\n              {/* Wallpaper Tab */}\n              {activeTab === 'wallpaper' && (\n                <div className=\"p-4\">\n                  <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-4\">\n                    Choose a wallpaper for this chat\n                  </p>\n                  <div className=\"grid grid-cols-3 gap-3\">\n                    {WALLPAPER_OPTIONS.map((wallpaper) => {\n                      const unlocked = isWallpaperUnlocked(wallpaper.id, ownedThemePacks);\n                      const requiredPack = wallpaper.requiredPackSlug;\n\n                      return (\n                        <button\n                          key={wallpaper.id}\n                          onClick={() => {\n                            if (unlocked) {\n                              onWallpaperChange(wallpaper.id);\n                              return;\n                            }\n\n                            onOpenStore?.();\n                          }}\n                          className={cn(\n                            'aspect-[3/4] rounded-xl overflow-hidden relative transition-all',\n                            wallpaper.color,\n                            wallpaper.pattern,\n                            !unlocked && 'opacity-70',\n                            currentWallpaper === wallpaper.id\n                              ? 'ring-2 ring-blue-500 ring-offset-2 dark:ring-offset-gray-900'\n                              : 'hover:scale-105'\n                          )}\n                        >\n                          {wallpaper.preview && (\n                            <img\n                              src={wallpaper.preview}\n                              alt={wallpaper.name}\n                              className=\"w-full h-full object-cover\"\n                            />\n                          )}\n                          <div className=\"absolute bottom-0 left-0 right-0 p-2 bg-gradient-to-t from-black/50 to-transparent\">\n                            <span className=\"text-xs text-white font-medium\">{wallpaper.name}</span>\n                            {!unlocked && (\n                              <p className=\"text-[10px] text-white/90\">\n                                Requires {requiredPack === 'chat-theme-dark-variants' ? 'Dark Variants Pack' : 'Vibrant DMs Pack'}\n                              </p>\n                            )}\n                          </div>\n                          {!unlocked && (\n                            <div className=\"absolute top-2 left-2 w-6 h-6 bg-black/60 rounded-full flex items-center justify-center\">\n                              <Lock className=\"w-3 h-3 text-white\" />\n                            </div>\n                          )}\n                          {currentWallpaper === wallpaper.id && (\n                            <div className=\"absolute top-2 right-2 w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center\">\n                              <svg className=\"w-3 h-3 text-white\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={3} d=\"M5 13l4 4L19 7\" />\n                              </svg>\n                            </div>\n                          )}\n                        </button>\n                      );\n                    })}\n                  </div>\n                </div>\n              )}\n\n              {/* Media Tab */}\n              {activeTab === 'media' && (\n                <div className=\"p-4\">\n                  {/* Search */}\n                  <div className=\"relative mb-4\">\n                    <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400\" />\n                    <input\n                      type=\"text\"\n                      value={searchQuery}\n                      onChange={(e) => setSearchQuery(e.target.value)}\n                      placeholder=\"Search media...\"\n                      className=\"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-lg border-0 focus:ring-2 focus:ring-blue-500\"\n                    />\n                  </div>\n\n                  {/* Filter buttons */}\n                  <div className=\"flex gap-2 mb-4 overflow-x-auto pb-2\">\n                    {([\n                      { id: 'all', label: 'All', icon: null },\n                      { id: 'images', label: 'Images', icon: ImageIcon },\n                      { id: 'videos', label: 'Videos', icon: Video },\n                      { id: 'files', label: 'Files', icon: FileText },\n                    ] as const).map((filter) => (\n                      <button\n                        key={filter.id}\n                        onClick={() => setMediaFilter(filter.id)}\n                        className={cn(\n                          'flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm whitespace-nowrap transition-colors',\n                          mediaFilter === filter.id\n                            ? 'bg-blue-600 text-white'\n                            : 'bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700'\n                        )}\n                      >\n                        {filter.icon && <filter.icon className=\"w-4 h-4\" />}\n                        {filter.label}\n                      </button>\n                    ))}\n                  </div>\n\n                  {/* Media Grid */}\n                  {filteredMedia.length > 0 ? (\n                    <div className=\"grid grid-cols-3 gap-2\">\n                      {filteredMedia.map((item) => (\n                        <a\n                          key={item.id}\n                          href={item.url}\n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\"\n                          className=\"aspect-square rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-800 hover:opacity-80 transition-opacity relative group\"\n                        >\n                          {item.type === 'image' ? (\n                            <img\n                              src={item.url}\n                              alt=\"\"\n                              className=\"w-full h-full object-cover\"\n                            />\n                          ) : item.type === 'video' ? (\n                            <div className=\"w-full h-full flex items-center justify-center bg-gray-200 dark:bg-gray-700\">\n                              <Video className=\"w-8 h-8 text-gray-500\" />\n                            </div>\n                          ) : (\n                            <div className=\"w-full h-full flex flex-col items-center justify-center p-2\">\n                              <FileText className=\"w-8 h-8 text-gray-500 mb-1\" />\n                              <span className=\"text-xs text-gray-500 truncate w-full text-center\">\n                                {item.fileName || 'File'}\n                              </span>\n                            </div>\n                          )}\n                        </a>\n                      ))}\n                    </div>\n                  ) : (\n                    <div className=\"text-center py-12 text-gray-500\">\n                      <ImageIcon className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n                      <p>No media shared yet</p>\n                      <p className=\"text-sm\">Photos, videos, and files will appear here</p>\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n          </motion.div>\n        </>\n      )}\n    </AnimatePresence>\n  );\n}\n\n// Export wallpaper options for use in other components\nexport { WALLPAPER_OPTIONS };\nexport type { MediaItem };\n"],"names":["c","_c","React","useState","motion","AnimatePresence","cn","X","Image","ImageIcon","FileText","Video","Trash2","Bell","BellOff","Ban","Flag","Search","Lock","isWallpaperUnlocked","WallpaperOption","id","name","color","preview","pattern","requiredPackSlug","WALLPAPER_OPTIONS","MediaItem","type","url","fileName","createdAt","ChatSettingsPanelProps","isOpen","onClose","conversationId","otherUser","username","profileImage","isOnline","currentWallpaper","onWallpaperChange","wallpaperId","mediaItems","onClearChat","onBlockUser","onReportUser","ownedThemePacks","onOpenStore","TabType","ChatSettingsPanel","t0","$","$i","Symbol","for","t1","t2","undefined","t3","activeTab","setActiveTab","t4","ChatSettingsPanel[useState()]","window","localStorage","getItem","isMuted","setIsMuted","mediaFilter","setMediaFilter","searchQuery","setSearchQuery","t5","ChatSettingsPanel[handleMuteToggle]","newMuted","setItem","String","handleMuteToggle","t6","item","filteredMedia","filter","T0","t7","opacity","x","damping","stiffness","charAt","toUpperCase","label","map","tab","ChatSettingsPanel[(anonymous)() > <button>.onClick]","wallpaper","unlocked","requiredPack","ChatSettingsPanel[WALLPAPER_OPTIONS.map() > <button>.onClick]","e","target","value","icon","const","length","_ChatSettingsPanelFilteredMediaMap","t8","item_0"],"mappings":"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","ignoreList":[]}},
    {"offset": {"line": 2292, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/chat/ChatMessages.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\nimport { Message, getMessages } from '@/lib/api/chat';\nimport { \n  getSocket, \n  joinChatRoom, \n  leaveChatRoom, \n  markChatAsRead,\n  deleteChatMessage,\n  editChatMessage,\n  reactToChatMessage\n} from '@/lib/socket';\nimport { format, isToday, isYesterday } from 'date-fns';\nimport { cn } from '@/lib/utils';\nimport MessageMenu, { MessageQuickActions } from './MessageMenu';\nimport { WALLPAPER_OPTIONS } from './ChatSettingsPanel';\nimport type { UploadingMessage, OptimisticMessage } from './ChatInput';\nimport { DEFAULT_CHAT_REACTIONS } from '@/lib/chat/customization';\n\ninterface ChatMessagesProps {\n  conversationId: string;\n  currentUserId: string;\n  otherUser: {\n    id: string;\n    name: string;\n    username: string;\n    profileImage?: string | null;\n    isOnline?: boolean;\n  };\n  wallpaper?: string;\n  availableReactions?: string[];\n  animatedBubbles?: boolean;\n  onReply?: (message: { id: string; content: string; senderName: string }) => void;\n  uploadingMessages?: UploadingMessage[];\n  optimisticMessages?: OptimisticMessage[];\n  onLastMessageUpdate?: (message: string) => void;\n  onMessageConfirmed?: (content: string) => void;\n}\n\nexport default function ChatMessages({\n  conversationId,\n  currentUserId,\n  otherUser,\n  wallpaper = 'default',\n  availableReactions = DEFAULT_CHAT_REACTIONS,\n  animatedBubbles = false,\n  onReply,\n  uploadingMessages = [],\n  optimisticMessages = [],\n  onLastMessageUpdate,\n  onMessageConfirmed,\n}: ChatMessagesProps) {\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [loadingMore, setLoadingMore] = useState(false);\n  const [hasMore, setHasMore] = useState(false);\n  const [nextCursor, setNextCursor] = useState<string | undefined>();\n  const [typingUser, setTypingUser] = useState<string | null>(null);\n  const [highlightedMessageId, setHighlightedMessageId] = useState<string | null>(null);\n  const [viewingImage, setViewingImage] = useState<string | null>(null);\n  const [viewingVideo, setViewingVideo] = useState<string | null>(null);\n  \n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const messagesContainerRef = useRef<HTMLDivElement>(null);\n  const messageRefs = useRef<Map<string, HTMLDivElement>>(new Map());\n  const [shouldAutoScroll, setShouldAutoScroll] = useState(true);\n\n  // Scroll to a specific message and highlight it\n  const scrollToMessage = useCallback((messageId: string) => {\n    const messageElement = messageRefs.current.get(messageId);\n    if (messageElement) {\n      messageElement.scrollIntoView({ behavior: 'smooth', block: 'center' });\n      setHighlightedMessageId(messageId);\n      // Remove highlight after 1.5 seconds\n      setTimeout(() => {\n        setHighlightedMessageId(null);\n      }, 1500);\n    }\n  }, []);\n\n  // Register message ref\n  const registerMessageRef = useCallback((messageId: string, element: HTMLDivElement | null) => {\n    if (element) {\n      messageRefs.current.set(messageId, element);\n    } else {\n      messageRefs.current.delete(messageId);\n    }\n  }, []);\n\n  // Fetch messages\n  // Helper to determine if a message was edited based on timestamp difference\n  const wasMessageEdited = (message: Message): boolean => {\n    if (!message.createdAt || !message.updatedAt) return false;\n    const created = new Date(message.createdAt).getTime();\n    const updated = new Date(message.updatedAt).getTime();\n    // Consider edited if there's at least 1 second difference\n    // Prisma sets both timestamps at the exact same moment on creation\n    return updated - created >= 1000;\n  };\n\n  const fetchMessages = useCallback(async (cursor?: string) => {\n    try {\n      if (cursor) {\n        setLoadingMore(true);\n      } else {\n        setLoading(true);\n      }\n\n      const result = await getMessages(conversationId, 50, cursor);\n      \n      // Add isEdited flag to each message\n      const messagesWithEditFlag = result.messages.map(msg => ({\n        ...msg,\n        isEdited: wasMessageEdited(msg),\n      }));\n\n      if (cursor) {\n        // Prepend older messages\n        setMessages(prev => [...messagesWithEditFlag, ...prev]);\n      } else {\n        setMessages(messagesWithEditFlag);\n        \n        // Find the last message from the other user for AI assistant\n        if (onLastMessageUpdate) {\n          const lastFromOther = [...result.messages]\n            .reverse()\n            .find(m => m.senderId !== currentUserId && m.content);\n          if (lastFromOther) {\n            onLastMessageUpdate(lastFromOther.content);\n          }\n        }\n      }\n\n      setHasMore(result.hasMore);\n      setNextCursor(result.nextCursor);\n    } catch (err: unknown) {\n      console.error('Failed to fetch messages:', err);\n    } finally {\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [conversationId, currentUserId, onLastMessageUpdate]);\n\n  // Initial load and join room\n  useEffect(() => {\n    fetchMessages();\n    joinChatRoom(conversationId);\n    markChatAsRead(conversationId);\n\n    return () => {\n      leaveChatRoom(conversationId);\n    };\n  }, [conversationId, fetchMessages]);\n\n  // Socket event listeners\n  useEffect(() => {\n    const socket = getSocket();\n    if (!socket) return;\n\n    const handleNewMessage = (data: { conversationId: string; message: Message }) => {\n      if (data.conversationId === conversationId) {\n        // Deduplicate - check if message already exists\n        setMessages(prev => {\n          const exists = prev.some(m => m.id === data.message.id);\n          if (exists) return prev;\n          return [...prev, data.message];\n        });\n        setShouldAutoScroll(true);\n        \n        // If this is our own message, confirm it to remove optimistic version\n        if (data.message.senderId === currentUserId && onMessageConfirmed) {\n          onMessageConfirmed(data.message.content);\n        }\n        \n        // Mark as read if from other user\n        if (data.message.senderId !== currentUserId) {\n          markChatAsRead(conversationId);\n          // Update last received message for AI assistant\n          if (data.message.content && onLastMessageUpdate) {\n            onLastMessageUpdate(data.message.content);\n          }\n        }\n      }\n    };\n\n    const handleTyping = (data: { conversationId: string; userId: string; isTyping: boolean }) => {\n      if (data.conversationId === conversationId && data.userId !== currentUserId) {\n        setTypingUser(data.isTyping ? data.userId : null);\n      }\n    };\n\n    const handleMessagesRead = (data: { conversationId: string; readBy: string; readAt: Date }) => {\n      if (data.conversationId === conversationId) {\n        setMessages(prev => \n          prev.map(m => \n            m.senderId === currentUserId && m.status !== 'READ'\n              ? { ...m, status: 'READ', readAt: new Date(data.readAt).toISOString() }\n              : m\n          )\n        );\n      }\n    };\n\n    const handleMessagesDelivered = (data: { conversationId: string; deliveredAt: Date }) => {\n      if (data.conversationId === conversationId) {\n        setMessages(prev => \n          prev.map(m => \n            m.senderId === currentUserId && m.status === 'SENT'\n              ? { ...m, status: 'DELIVERED', deliveredAt: new Date(data.deliveredAt).toISOString() }\n              : m\n          )\n        );\n      }\n    };\n\n    const handleError = (data: { message: string }) => {\n      console.error('Chat socket error:', data.message);\n    };\n\n    const handleMessageDeleted = (data: { messageId: string; conversationId: string; forEveryone: boolean }) => {\n      if (data.conversationId === conversationId) {\n        if (data.forEveryone) {\n          setMessages(prev => \n            prev.map(m => \n              m.id === data.messageId \n                ? { ...m, isDeleted: true, content: 'This message was deleted' } \n                : m\n            )\n          );\n        } else {\n          setMessages(prev => prev.filter(m => m.id !== data.messageId));\n        }\n      }\n    };\n\n    const handleMessageEdited = (data: { messageId: string; conversationId: string; content: string; editedAt: Date }) => {\n      if (data.conversationId === conversationId) {\n        setMessages(prev => \n          prev.map(m => \n            m.id === data.messageId \n              ? { ...m, content: data.content, updatedAt: String(data.editedAt), isEdited: true } \n              : m\n          )\n        );\n      }\n    };\n\n    const handleReaction = (data: { messageId: string; conversationId: string; userId: string; emoji: string; action: string }) => {\n      if (data.conversationId === conversationId) {\n        setMessages(prev => \n          prev.map(m => {\n            if (m.id !== data.messageId) return m;\n            \n            let reactions = [...(m.reactions || [])];\n            \n            if (data.action === 'removed') {\n              reactions = reactions.filter(r => !(r.userId === data.userId));\n            } else if (data.action === 'added') {\n              reactions.push({\n                id: `temp-${Date.now()}`,\n                userId: data.userId,\n                emoji: data.emoji,\n                user: { id: data.userId, username: '', name: '' }\n              });\n            } else if (data.action === 'updated') {\n              const index = reactions.findIndex(r => r.userId === data.userId);\n              if (index >= 0) {\n                reactions[index] = { ...reactions[index], emoji: data.emoji };\n              }\n            }\n            \n            return { ...m, reactions };\n          })\n        );\n      }\n    };\n\n    // Handle chat:notification (sent to user's personal room as fallback)\n    const handleChatNotification = (data: { type: string; conversationId: string; message: Message }) => {\n      if (data.type === 'new_message' && data.conversationId === conversationId) {\n        // Deduplicate - check if message already exists\n        setMessages(prev => {\n          const exists = prev.some(m => m.id === data.message.id);\n          if (exists) return prev;\n          return [...prev, data.message];\n        });\n        setShouldAutoScroll(true);\n        \n        // If this is our own message, confirm it to remove optimistic version\n        if (data.message.senderId === currentUserId && onMessageConfirmed) {\n          onMessageConfirmed(data.message.content);\n        }\n        \n        // Mark as read if from other user\n        if (data.message.senderId !== currentUserId) {\n          markChatAsRead(conversationId);\n          if (data.message.content && onLastMessageUpdate) {\n            onLastMessageUpdate(data.message.content);\n          }\n        }\n      }\n    };\n\n    socket.on('chat:new_message', handleNewMessage);\n    socket.on('chat:notification', handleChatNotification);\n    socket.on('chat:user_typing', handleTyping);\n    socket.on('chat:messages_read', handleMessagesRead);\n    socket.on('chat:messages_delivered', handleMessagesDelivered);\n    socket.on('chat:message_deleted', handleMessageDeleted);\n    socket.on('chat:message_edited', handleMessageEdited);\n    socket.on('chat:message_reaction', handleReaction);\n    socket.on('error', handleError);\n\n    return () => {\n      socket.off('chat:new_message', handleNewMessage);\n      socket.off('chat:notification', handleChatNotification);\n      socket.off('chat:user_typing', handleTyping);\n      socket.off('chat:messages_read', handleMessagesRead);\n      socket.off('chat:messages_delivered', handleMessagesDelivered);\n      socket.off('chat:message_deleted', handleMessageDeleted);\n      socket.off('chat:message_edited', handleMessageEdited);\n      socket.off('chat:message_reaction', handleReaction);\n      socket.off('error', handleError);\n    };\n  }, [conversationId, currentUserId, otherUser.id, onLastMessageUpdate, onMessageConfirmed]);\n\n  // Auto-scroll to bottom\n  useEffect(() => {\n    if (shouldAutoScroll && messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\n      setShouldAutoScroll(false);\n    }\n  }, [messages, shouldAutoScroll]);\n\n  // Scroll detection for loading more\n  const handleScroll = (e: React.UIEvent<HTMLDivElement>) => {\n    const target = e.currentTarget;\n    if (target.scrollTop < 100 && hasMore && !loadingMore) {\n      fetchMessages(nextCursor);\n    }\n  };\n\n  // Group messages by date\n  const groupedMessages = messages.reduce((groups, message) => {\n    const date = new Date(message.createdAt);\n    const dateKey = format(date, 'yyyy-MM-dd');\n    \n    if (!groups[dateKey]) {\n      groups[dateKey] = [];\n    }\n    groups[dateKey].push(message);\n    \n    return groups;\n  }, {} as Record<string, Message[]>);\n\n  if (loading) {\n    return (\n      <div className=\"flex-1 flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  // Get wallpaper styles\n  const wallpaperOption = WALLPAPER_OPTIONS.find(w => w.id === wallpaper) || WALLPAPER_OPTIONS[0];\n  const wallpaperClasses = cn(wallpaperOption.color, wallpaperOption.pattern);\n\n  return (\n    <>\n    <div \n      ref={messagesContainerRef}\n      className={cn(\"flex-1 overflow-y-auto p-4 space-y-4\", wallpaperClasses)}\n      onScroll={handleScroll}\n    >\n      {loadingMore && (\n        <div className=\"flex justify-center py-2\">\n          <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n        </div>\n      )}\n\n      {Object.entries(groupedMessages).map(([dateKey, dateMessages]) => (\n        <div key={dateKey}>\n          {/* Date separator */}\n          <div className=\"flex items-center justify-center my-4\">\n            <div className=\"bg-gray-200 dark:bg-gray-700 px-3 py-1 rounded-full text-xs text-gray-600 dark:text-gray-300\">\n              {formatDateSeparator(new Date(dateKey))}\n            </div>\n          </div>\n\n          {/* Messages for this date */}\n          {dateMessages.map((message, index) => {\n            const prevMessage = index > 0 ? dateMessages[index - 1] : null;\n            const showAvatar = !prevMessage || prevMessage.senderId !== message.senderId;\n            \n            return (\n              <MessageBubble\n                key={message.id}\n                message={message}\n                isOwn={message.senderId === currentUserId}\n                showAvatar={showAvatar}\n                otherUser={otherUser}\n                conversationId={conversationId}\n                isHighlighted={highlightedMessageId === message.id}\n                onScrollToReply={scrollToMessage}\n                registerRef={(el) => registerMessageRef(message.id, el)}\n                onReply={onReply ? () => onReply({\n                  id: message.id,\n                  content: message.content,\n                  senderName: message.senderId === currentUserId ? 'You' : otherUser.name,\n                }) : undefined}\n                onViewImage={setViewingImage}\n                onViewVideo={setViewingVideo}\n                availableReactions={availableReactions}\n                animatedBubbles={animatedBubbles}\n              />\n            );\n          })}\n        </div>\n      ))}\n\n      {/* Optimistic Messages (sent but not yet confirmed) */}\n      {optimisticMessages.map(optMsg => (\n        <div key={optMsg.id} className=\"flex justify-end mb-2\">\n          <div className=\"max-w-[70%]\">\n            {/* Reply preview if present */}\n            {optMsg.replyTo && (\n              <div className=\"text-xs p-2 rounded-t-lg border-l-2 bg-blue-600/20 border-blue-400\">\n                <span className=\"text-gray-500 text-[10px]\">‚Ü© Replying to</span>\n                <p className=\"truncate text-gray-700 dark:text-gray-300\">{optMsg.replyTo.content}</p>\n              </div>\n            )}\n            <div className={cn(\n              \"bg-blue-600 text-white px-4 py-2 rounded-2xl rounded-br-sm\",\n              optMsg.replyTo && \"rounded-t-none\"\n            )}>\n              <p className=\"break-words whitespace-pre-wrap\">{optMsg.content}</p>\n            </div>\n            <div className=\"text-xs text-gray-500 mt-1 flex items-center gap-1 justify-end\">\n              <span>{format(new Date(optMsg.createdAt), 'HH:mm')}</span>\n              <span className=\"animate-pulse\">‚è≥</span>\n            </div>\n          </div>\n        </div>\n      ))}\n\n      {/* Uploading Messages */}\n      {uploadingMessages.map(uploadingMsg => (\n        <div key={uploadingMsg.id} className=\"flex justify-end mb-2\">\n          <div className=\"relative max-w-[70%]\">\n            <div className=\"bg-blue-600 text-white px-4 py-2 rounded-2xl rounded-br-sm\">\n              {/* Preview for images/videos */}\n              {uploadingMsg.preview && (uploadingMsg.type === 'image' || uploadingMsg.type === 'video') && (\n                <div className=\"relative mb-2 rounded-lg overflow-hidden\">\n                  {uploadingMsg.type === 'image' ? (\n                    <img \n                      src={uploadingMsg.preview} \n                      alt=\"Uploading\" \n                      className=\"max-w-full opacity-70\"\n                      style={{ maxHeight: '200px' }}\n                    />\n                  ) : (\n                    <video \n                      src={uploadingMsg.preview}\n                      className=\"max-w-full opacity-70\"\n                      style={{ maxHeight: '200px' }}\n                      muted\n                    />\n                  )}\n                  {/* Overlay with spinner */}\n                  <div className=\"absolute inset-0 flex items-center justify-center bg-black/30\">\n                    <div className=\"relative\">\n                      <svg className=\"w-12 h-12\" viewBox=\"0 0 36 36\">\n                        <circle\n                          cx=\"18\"\n                          cy=\"18\"\n                          r=\"16\"\n                          fill=\"none\"\n                          stroke=\"rgba(255,255,255,0.3)\"\n                          strokeWidth=\"3\"\n                        />\n                        <circle\n                          cx=\"18\"\n                          cy=\"18\"\n                          r=\"16\"\n                          fill=\"none\"\n                          stroke=\"white\"\n                          strokeWidth=\"3\"\n                          strokeDasharray={`${uploadingMsg.progress}, 100`}\n                          strokeLinecap=\"round\"\n                          transform=\"rotate(-90 18 18)\"\n                        />\n                      </svg>\n                      <span className=\"absolute inset-0 flex items-center justify-center text-white text-xs font-medium\">\n                        {uploadingMsg.progress}%\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              )}\n              \n              {/* For audio/documents - show icon with progress */}\n              {(uploadingMsg.type === 'audio' || uploadingMsg.type === 'document') && (\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"relative w-10 h-10\">\n                    <svg className=\"w-10 h-10\" viewBox=\"0 0 36 36\">\n                      <circle\n                        cx=\"18\"\n                        cy=\"18\"\n                        r=\"16\"\n                        fill=\"none\"\n                        stroke=\"rgba(255,255,255,0.3)\"\n                        strokeWidth=\"3\"\n                      />\n                      <circle\n                        cx=\"18\"\n                        cy=\"18\"\n                        r=\"16\"\n                        fill=\"none\"\n                        stroke=\"white\"\n                        strokeWidth=\"3\"\n                        strokeDasharray={`${uploadingMsg.progress}, 100`}\n                        strokeLinecap=\"round\"\n                        transform=\"rotate(-90 18 18)\"\n                      />\n                    </svg>\n                    <span className=\"absolute inset-0 flex items-center justify-center text-white text-xs\">\n                      {uploadingMsg.type === 'audio' ? 'üé§' : 'üìÑ'}\n                    </span>\n                  </div>\n                  <div className=\"flex-1\">\n                    <p className=\"text-sm truncate\">{uploadingMsg.fileName || 'Uploading...'}</p>\n                    <p className=\"text-xs opacity-70\">Sending... {uploadingMsg.progress}%</p>\n                  </div>\n                </div>\n              )}\n              \n              {/* Text label */}\n              {(uploadingMsg.type === 'image' || uploadingMsg.type === 'video') && (\n                <p className=\"text-sm\">\n                  {uploadingMsg.type === 'image' ? 'üì∑ Sending photo...' : 'üé• Sending video...'}\n                </p>\n              )}\n            </div>\n          </div>\n        </div>\n      ))}\n\n      {/* Typing indicator */}\n      {typingUser && (\n        <div className=\"flex items-center gap-2 text-gray-500 text-sm\">\n          <div className=\"flex gap-1\">\n            <span className=\"animate-bounce\">‚Ä¢</span>\n            <span className=\"animate-bounce\" style={{ animationDelay: '0.1s' }}>‚Ä¢</span>\n            <span className=\"animate-bounce\" style={{ animationDelay: '0.2s' }}>‚Ä¢</span>\n          </div>\n          <span>{otherUser.name} is typing...</span>\n        </div>\n      )}\n\n      <div ref={messagesEndRef} />\n    </div>\n\n    {/* Image Viewer Modal */}\n    {viewingImage && (\n      <div \n        className=\"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4\"\n        onClick={() => setViewingImage(null)}\n      >\n        <button\n          onClick={() => setViewingImage(null)}\n          className=\"absolute top-4 right-4 text-white hover:bg-white/10 p-2 rounded-full transition-colors\"\n        >\n          <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-8 w-8\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n          </svg>\n        </button>\n        <img \n          src={viewingImage} \n          alt=\"Full size image\" \n          className=\"max-w-full max-h-full object-contain rounded-lg\"\n          onClick={(e) => e.stopPropagation()}\n        />\n        <a\n          href={viewingImage}\n          download\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          onClick={(e) => e.stopPropagation()}\n          className=\"absolute bottom-4 right-4 bg-white/10 hover:bg-white/20 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors\"\n        >\n          <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\" />\n          </svg>\n          Download\n        </a>\n      </div>\n    )}\n\n    {/* Video Viewer Modal */}\n    {viewingVideo && (\n      <div \n        className=\"fixed inset-0 bg-black/95 z-50 flex items-center justify-center p-4\"\n        onClick={() => setViewingVideo(null)}\n      >\n        <button\n          onClick={() => setViewingVideo(null)}\n          className=\"absolute top-4 right-4 text-white hover:bg-white/10 p-2 rounded-full transition-colors z-10\"\n        >\n          <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-8 w-8\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n          </svg>\n        </button>\n        <video \n          src={viewingVideo} \n          controls\n          autoPlay\n          className=\"max-w-full max-h-full rounded-lg\"\n          style={{ maxHeight: '90vh', maxWidth: '90vw' }}\n          onClick={(e) => e.stopPropagation()}\n        />\n        <a\n          href={viewingVideo}\n          download\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          onClick={(e) => e.stopPropagation()}\n          className=\"absolute bottom-4 right-4 bg-white/10 hover:bg-white/20 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors\"\n        >\n          <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\" />\n          </svg>\n          Download\n        </a>\n      </div>\n    )}\n    </>\n  );\n}\n\n// ============================================\n// Message Bubble Component\n// ============================================\ninterface MessageBubbleProps {\n  message: Message;\n  isOwn: boolean;\n  showAvatar: boolean;\n  otherUser: {\n    name: string;\n    profileImage?: string | null;\n  };\n  conversationId: string;\n  isHighlighted?: boolean;\n  onScrollToReply?: (messageId: string) => void;\n  registerRef?: (el: HTMLDivElement | null) => void;\n  onReply?: () => void;\n  onViewImage?: (url: string) => void;\n  onViewVideo?: (url: string) => void;\n  availableReactions?: string[];\n  animatedBubbles?: boolean;\n}\n\nfunction MessageBubble({ \n  message, \n  isOwn, \n  showAvatar, \n  otherUser,\n  conversationId,\n  isHighlighted = false,\n  onScrollToReply,\n  registerRef,\n  onReply,\n  onViewImage,\n  onViewVideo,\n  availableReactions = DEFAULT_CHAT_REACTIONS,\n  animatedBubbles = false,\n}: MessageBubbleProps) {\n  const [showActions, setShowActions] = useState(false);\n  const [showMenu, setShowMenu] = useState(false);\n  const [showReactions, setShowReactions] = useState(false);\n  const [isEditing, setIsEditing] = useState(false);\n  const [editContent, setEditContent] = useState(message.content);\n  const [copied, setCopied] = useState(false);\n\n  const handleDelete = (forEveryone: boolean) => {\n    deleteChatMessage(message.id, conversationId, forEveryone);\n    setShowActions(false);\n    setShowMenu(false);\n  };\n\n  const handleEdit = () => {\n    if (editContent.trim() && editContent !== message.content) {\n      editChatMessage(message.id, conversationId, editContent);\n    }\n    setIsEditing(false);\n  };\n\n  const handleReaction = (emoji: string) => {\n    reactToChatMessage(message.id, conversationId, emoji);\n    setShowReactions(false);\n  };\n\n  if (message.isDeleted) {\n    return (\n      <div \n        ref={registerRef}\n        className={cn(\n          'flex items-center gap-2',\n          isOwn ? 'justify-end' : 'justify-start'\n        )}\n      >\n        <div className=\"bg-gray-100 dark:bg-gray-800 text-gray-500 italic px-4 py-2 rounded-lg text-sm\">\n          This message was deleted\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div \n      ref={registerRef}\n      className={cn(\n        'flex gap-2 group transition-all duration-300',\n        isOwn ? 'justify-end' : 'justify-start',\n        isHighlighted && 'bg-yellow-100/50 dark:bg-yellow-900/30 -mx-2 px-2 py-1 rounded-lg'\n      )}\n      onMouseEnter={() => setShowActions(true)}\n      onMouseLeave={() => { setShowActions(false); setShowReactions(false); }}\n    >\n      {/* Avatar for received messages */}\n      {!isOwn && (\n        <div className={cn('w-8 h-8 flex-shrink-0', !showAvatar && 'invisible')}>\n          {showAvatar && (\n            <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white text-sm font-medium\">\n              {otherUser.profileImage ? (\n                <img\n                  src={otherUser.profileImage}\n                  alt={otherUser.name}\n                  className=\"w-8 h-8 rounded-full object-cover\"\n                />\n              ) : (\n                otherUser.name.charAt(0).toUpperCase()\n              )}\n            </div>\n          )}\n        </div>\n      )}\n\n      <div className={cn('max-w-[70%] relative', isOwn && 'order-first')}>\n        {/* Reply preview - clickable to scroll to original message */}\n        {message.replyTo && (\n          <button\n            onClick={() => onScrollToReply?.(message.replyTo!.id)}\n            className={cn(\n              'text-xs p-2 rounded-t-lg border-l-2 w-full text-left cursor-pointer hover:opacity-80 transition-opacity',\n              isOwn \n                ? 'bg-blue-600/20 border-blue-400' \n                : 'bg-gray-100 dark:bg-gray-800 border-gray-400'\n            )}\n          >\n            <span className=\"text-gray-500 text-[10px]\">‚Ü© Replying to</span>\n            <p className=\"truncate text-gray-700 dark:text-gray-300\">{message.replyTo.content}</p>\n          </button>\n        )}\n\n        {/* Message content */}\n        <div className={cn(\n          'px-4 py-2 rounded-2xl relative',\n          animatedBubbles && 'shadow-sm shadow-blue-400/15 transition-transform duration-150 hover:scale-[1.01]',\n          isOwn \n            ? 'bg-blue-600 text-white rounded-br-sm' \n            : 'bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white rounded-bl-sm',\n          message.replyTo && 'rounded-t-none'\n        )}>\n          {/* Image content */}\n          {message.mediaUrl && message.contentType === 'image' && (\n            <button \n              onClick={() => onViewImage?.(message.mediaUrl!)}\n              className=\"block w-full text-left\"\n            >\n              <img \n                src={message.mediaUrl} \n                alt=\"Shared image\" \n                className=\"rounded-lg max-w-full mb-2 cursor-pointer hover:opacity-90 transition-opacity\"\n                style={{ maxHeight: '300px' }}\n              />\n            </button>\n          )}\n\n          {/* Video content */}\n          {message.mediaUrl && message.contentType === 'video' && (\n            <div className=\"relative group cursor-pointer mb-2\" onClick={() => onViewVideo?.(message.mediaUrl!)}>\n              <video \n                src={message.mediaUrl}\n                className=\"rounded-lg max-w-full\"\n                style={{ maxHeight: '300px' }}\n              />\n              <div className=\"absolute inset-0 flex items-center justify-center bg-black/30 group-hover:bg-black/40 transition-colors rounded-lg\">\n                <div className=\"w-14 h-14 rounded-full bg-white/90 flex items-center justify-center\">\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-8 w-8 text-gray-900 ml-1\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path d=\"M8 5v14l11-7z\"/>\n                  </svg>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Audio content */}\n          {message.mediaUrl && message.contentType === 'audio' && (\n            <div className={cn(\n              'flex items-center gap-3 p-2 rounded-lg mb-2',\n              isOwn ? 'bg-blue-700/50' : 'bg-gray-200 dark:bg-gray-700'\n            )}>\n              <div className=\"w-10 h-10 rounded-full bg-green-500 flex items-center justify-center\">\n                <span className=\"text-white text-lg\">üé§</span>\n              </div>\n              <audio \n                src={message.mediaUrl}\n                controls\n                className=\"flex-1 h-8\"\n                style={{ maxWidth: '200px' }}\n              />\n            </div>\n          )}\n\n          {/* Document content */}\n          {message.mediaUrl && message.contentType === 'document' && (\n            <a \n              href={message.mediaUrl} \n              target=\"_blank\" \n              rel=\"noopener noreferrer\"\n              className={cn(\n                'flex items-center gap-3 p-3 rounded-lg mb-2 transition-colors',\n                isOwn ? 'bg-blue-700/50 hover:bg-blue-700/70' : 'bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600'\n              )}\n            >\n              <div className=\"w-10 h-10 rounded-lg bg-red-500 flex items-center justify-center\">\n                <span className=\"text-white text-lg\">üìÑ</span>\n              </div>\n              <div className=\"flex-1 min-w-0\">\n                <p className={cn('font-medium truncate text-sm', isOwn ? 'text-white' : 'text-gray-900 dark:text-white')}>\n                  {message.fileName || 'Document'}\n                </p>\n                {message.fileSize && (\n                  <p className={cn('text-xs', isOwn ? 'text-blue-200' : 'text-gray-500')}>\n                    {(message.fileSize / 1024).toFixed(1)} KB\n                  </p>\n                )}\n              </div>\n            </a>\n          )}\n\n          {/* Generic file content */}\n          {message.mediaUrl && message.contentType === 'file' && (\n            <a \n              href={message.mediaUrl} \n              target=\"_blank\" \n              rel=\"noopener noreferrer\"\n              className=\"flex items-center gap-2 bg-white/10 p-2 rounded mb-2 hover:bg-white/20\"\n            >\n              <span>üìé</span>\n              <span className=\"truncate\">{message.fileName || 'File'}</span>\n            </a>\n          )}\n\n          {/* Shared Reel content - thumbnail only, click to open reel */}\n          {message.contentType === 'reel' && (() => {\n            let reelId: string | null = null;\n            try {\n              const data = JSON.parse(message.content);\n              reelId = data.reelId || null;\n            } catch {\n              // Legacy: content might be plain text, try to extract reel ID from URL if any\n              const match = message.content?.match(/\\/reels\\/([a-f0-9-]+)/i);\n              reelId = match?.[1] || null;\n            }\n            const thumbnailUrl = message.mediaUrl;\n            const reelUrl = reelId ? `/reels/${reelId}` : '/reels';\n            // Show thumbnail card even for legacy messages without reelId (links to reels feed)\n            return (\n              <a\n                href={reelUrl}\n                onClick={(e) => {\n                  e.preventDefault();\n                  window.location.href = reelUrl;\n                }}\n                className={cn(\n                  'block relative rounded-xl overflow-hidden w-24 h-36 flex-shrink-0 cursor-pointer hover:opacity-90 transition-opacity',\n                  isOwn ? 'ring-2 ring-white/30' : 'ring-2 ring-gray-300 dark:ring-gray-600'\n                )}\n              >\n                {thumbnailUrl ? (\n                  <img\n                    src={thumbnailUrl}\n                    alt=\"Reel\"\n                    className=\"w-full h-full object-cover\"\n                  />\n                ) : (\n                  <div className={cn(\n                    'w-full h-full flex items-center justify-center',\n                    isOwn ? 'bg-blue-700/50' : 'bg-gray-200 dark:bg-gray-700'\n                  )}>\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-10 w-10 opacity-70\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\">\n                      <rect width=\"18\" height=\"18\" x=\"3\" y=\"3\" rx=\"2\" />\n                      <path d=\"M7 3v18\" />\n                      <path d=\"M17 3v18\" />\n                      <path d=\"M3 12h18\" />\n                    </svg>\n                  </div>\n                )}\n                <div className=\"absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t from-black/60 to-transparent flex items-end justify-center pb-1\">\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4 text-white\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path d=\"M8 5v14l11-7z\"/>\n                  </svg>\n                </div>\n              </a>\n            );\n          })()}\n\n          {/* Shared Post content */}\n          {(message.contentType === 'post' || message.contentType === 'application/x-shared-post') && (() => {\n            try {\n              const postData = JSON.parse(message.content);\n              const postId = postData.postId;\n              const postUrl = postData.postUrl || (postId ? `/post/${postId}` : null);\n              \n              return (\n                <a\n                  href={postUrl || '#'}\n                  onClick={(e) => {\n                    if (postUrl) {\n                      e.preventDefault();\n                      window.location.href = postUrl;\n                    }\n                  }}\n                  className={cn(\n                    'block rounded-lg p-3 mb-2 cursor-pointer transition-colors',\n                    isOwn ? 'bg-blue-700/50 hover:bg-blue-700/70' : 'bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600'\n                  )}\n                >\n                  <div className=\"flex items-center gap-2 mb-2 text-xs opacity-70\">\n                    <span>üìÑ</span>\n                    <span>Shared Post</span>\n                  </div>\n                  {postData.mediaUrl && (\n                    <img \n                      src={postData.mediaUrl} \n                      alt=\"Post media\" \n                      className=\"rounded-md w-full h-24 object-cover mb-2\"\n                    />\n                  )}\n                  {postData.author && (\n                    <>\n                      <div className=\"flex items-center gap-2 mb-1\">\n                        {postData.author.profileImage && (\n                          <img \n                            src={postData.author.profileImage} \n                            alt={postData.author.name} \n                            className=\"w-6 h-6 rounded-full object-cover\"\n                          />\n                        )}\n                        <p className={cn('font-medium text-sm', isOwn ? 'text-white' : 'text-gray-900 dark:text-white')}>\n                          {postData.author.name}\n                        </p>\n                      </div>\n                      {postData.author.username && (\n                        <p className={cn('text-xs opacity-60', isOwn ? 'text-blue-200' : 'text-gray-500')}>\n                          @{postData.author.username}\n                        </p>\n                      )}\n                    </>\n                  )}\n                  {/* Legacy format support */}\n                  {!postData.author && postData.authorName && (\n                    <>\n                      <p className={cn('font-medium text-sm', isOwn ? 'text-white' : 'text-gray-900 dark:text-white')}>\n                        {postData.authorName}\n                      </p>\n                      {postData.authorUsername && (\n                        <p className={cn('text-xs opacity-60', isOwn ? 'text-blue-200' : 'text-gray-500')}>\n                          @{postData.authorUsername}\n                        </p>\n                      )}\n                    </>\n                  )}\n                  {(postData.preview || postData.contentPreview) && (\n                    <p className={cn('text-sm mt-1 line-clamp-2', isOwn ? 'text-blue-100' : 'text-gray-600 dark:text-gray-300')}>\n                      {postData.preview || postData.contentPreview}\n                    </p>\n                  )}\n                  <p className=\"text-xs opacity-50 mt-2 italic\">Tap to view post ‚Üí</p>\n                </a>\n              );\n            } catch {\n              return <p className=\"break-words whitespace-pre-wrap\">{message.content}</p>;\n            }\n          })()}\n\n          {/* Text content - hide for reel (thumbnail only) and post */}\n          {message.contentType !== 'post' && message.contentType !== 'reel' && (isEditing ? (\n            <div className=\"flex gap-2\">\n              <input\n                type=\"text\"\n                value={editContent}\n                onChange={(e) => setEditContent(e.target.value)}\n                className=\"flex-1 bg-white/20 rounded px-2 py-1 text-sm\"\n                autoFocus\n                onKeyDown={(e) => {\n                  if (e.key === 'Enter') handleEdit();\n                  if (e.key === 'Escape') setIsEditing(false);\n                }}\n              />\n              <button onClick={handleEdit} className=\"text-xs\">Save</button>\n            </div>\n          ) : (\n            <p className=\"break-words whitespace-pre-wrap\">{message.content}</p>\n          ))}\n\n          {/* Edited indicator - only show if message was explicitly edited */}\n          {!message.isDeleted && message.isEdited && (\n            <span className=\"text-xs opacity-60 ml-1\">(edited)</span>\n          )}\n        </div>\n\n        {/* Reactions */}\n        {message.reactions && message.reactions.length > 0 && (\n          <div className={cn(\n            'flex flex-wrap gap-1 mt-1',\n            isOwn ? 'justify-end' : 'justify-start'\n          )}>\n            {Array.from(new Set(message.reactions.map(r => r.emoji))).map(emoji => {\n              const count = message.reactions.filter(r => r.emoji === emoji).length;\n              return (\n                <button\n                  key={emoji}\n                  onClick={() => handleReaction(emoji)}\n                  className=\"bg-gray-100 dark:bg-gray-800 px-2 py-0.5 rounded-full text-sm flex items-center gap-1 hover:bg-gray-200 dark:hover:bg-gray-700\"\n                >\n                  <span>{emoji}</span>\n                  <span className=\"text-xs text-gray-500\">{count}</span>\n                </button>\n              );\n            })}\n          </div>\n        )}\n\n        {/* Time and status */}\n        <div className={cn(\n          'text-xs text-gray-500 mt-1 flex items-center gap-1',\n          isOwn ? 'justify-end' : 'justify-start'\n        )}>\n          <span>{format(new Date(message.createdAt), 'HH:mm')}</span>\n          {isOwn && (\n            <span className={cn(\n              message.status === 'READ' && 'text-blue-500'\n            )}>\n              {message.status === 'READ' ? '‚úì‚úì' : message.status === 'DELIVERED' ? '‚úì‚úì' : '‚úì'}\n            </span>\n          )}\n        </div>\n\n        {/* Quick Action buttons (Discord-style) */}\n        <MessageQuickActions\n          isVisible={showActions && !isEditing && !showMenu}\n          isOwn={isOwn}\n          onReply={() => onReply?.()}\n          onReact={() => setShowReactions(!showReactions)}\n          onMore={() => setShowMenu(true)}\n        />\n\n        {/* Full Message Menu */}\n        <MessageMenu\n          isOpen={showMenu}\n          onClose={() => setShowMenu(false)}\n          isOwn={isOwn}\n          messageContent={message.content}\n          hasMedia={!!message.mediaUrl}\n          mediaUrl={message.mediaUrl}\n          onReply={() => onReply?.()}\n          onEdit={() => setIsEditing(true)}\n          onDelete={handleDelete}\n          onReact={handleReaction}\n          onCopy={() => {\n            setCopied(true);\n            setTimeout(() => setCopied(false), 2000);\n          }}\n          availableReactions={availableReactions}\n          anchorPosition={isOwn ? 'right' : 'left'}\n        />\n\n        {/* Reaction picker */}\n        {showReactions && !showMenu && (\n          <div className={cn(\n            'absolute -top-10 flex items-center gap-1 bg-white dark:bg-gray-900 shadow-lg rounded-full px-2 py-1',\n            isOwn ? 'right-0' : 'left-0'\n          )}>\n            {availableReactions.map(emoji => (\n              <button\n                key={emoji}\n                onClick={() => handleReaction(emoji)}\n                className=\"hover:scale-125 transition-transform p-1\"\n              >\n                {emoji}\n              </button>\n            ))}\n          </div>\n        )}\n\n        {/* Copied notification */}\n        {copied && (\n          <div className=\"absolute -top-8 left-1/2 -translate-x-1/2 bg-black/70 text-white text-xs px-2 py-1 rounded\">\n            Copied!\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\n// ============================================\n// Utility Functions\n// ============================================\nfunction formatDateSeparator(date: Date): string {\n  if (isToday(date)) return 'Today';\n  if (isYesterday(date)) return 'Yesterday';\n  return format(date, 'MMMM d, yyyy');\n}\n"],"names":["React","useEffect","useRef","useState","useCallback","Message","getMessages","getSocket","joinChatRoom","leaveChatRoom","markChatAsRead","deleteChatMessage","editChatMessage","reactToChatMessage","format","isToday","isYesterday","cn","MessageMenu","MessageQuickActions","WALLPAPER_OPTIONS","UploadingMessage","OptimisticMessage","DEFAULT_CHAT_REACTIONS","ChatMessagesProps","conversationId","currentUserId","otherUser","id","name","username","profileImage","isOnline","wallpaper","availableReactions","animatedBubbles","onReply","message","content","senderName","uploadingMessages","optimisticMessages","onLastMessageUpdate","onMessageConfirmed","ChatMessages","messages","setMessages","loading","setLoading","loadingMore","setLoadingMore","hasMore","setHasMore","nextCursor","setNextCursor","typingUser","setTypingUser","highlightedMessageId","setHighlightedMessageId","viewingImage","setViewingImage","viewingVideo","setViewingVideo","messagesEndRef","HTMLDivElement","messagesContainerRef","messageRefs","Map","shouldAutoScroll","setShouldAutoScroll","scrollToMessage","messageId","messageElement","current","get","scrollIntoView","behavior","block","setTimeout","registerMessageRef","element","set","delete","wasMessageEdited","createdAt","updatedAt","created","Date","getTime","updated","fetchMessages","cursor","result","messagesWithEditFlag","map","msg","isEdited","prev","lastFromOther","reverse","find","m","senderId","err","console","error","socket","handleNewMessage","data","exists","some","handleTyping","userId","isTyping","handleMessagesRead","readBy","readAt","status","toISOString","handleMessagesDelivered","deliveredAt","handleError","handleMessageDeleted","forEveryone","isDeleted","filter","handleMessageEdited","editedAt","String","handleReaction","emoji","action","reactions","r","push","now","user","index","findIndex","handleChatNotification","type","on","off","handleScroll","e","UIEvent","target","currentTarget","scrollTop","groupedMessages","reduce","groups","date","dateKey","Record","wallpaperOption","w","wallpaperClasses","color","pattern","Object","entries","dateMessages","formatDateSeparator","prevMessage","showAvatar","el","undefined","optMsg","replyTo","uploadingMsg","preview","maxHeight","progress","fileName","animationDelay","stopPropagation","maxWidth","MessageBubbleProps","isOwn","isHighlighted","onScrollToReply","registerRef","onViewImage","url","onViewVideo","MessageBubble","showActions","setShowActions","showMenu","setShowMenu","showReactions","setShowReactions","isEditing","setIsEditing","editContent","setEditContent","copied","setCopied","handleDelete","handleEdit","trim","charAt","toUpperCase","mediaUrl","contentType","fileSize","toFixed","reelId","JSON","parse","match","thumbnailUrl","reelUrl","preventDefault","window","location","href","postData","postId","postUrl","author","authorName","authorUsername","contentPreview","value","key","length","Array","from","Set","count"],"mappings":"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","ignoreList":[]}},
    {"offset": {"line": 4092, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/lib/api/connections.ts"],"sourcesContent":["import apiClient from './client';\nimport type { PersonCard } from './people';\n\n// ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n// TYPES\n// ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nexport type ConnectionStatus = 'none' | 'pending_sent' | 'pending_received' | 'connected' | 'blocked';\n\nexport interface Connection {\n  id: string;\n  status: 'PENDING' | 'ACCEPTED' | 'REJECTED' | 'BLOCKED';\n  message: string | null;\n  createdAt: string;\n  user: {\n    id: string;\n    username: string;\n    name: string;\n    profileImage: string | null;\n    headline: string | null;\n    college: string | null;\n  };\n}\n\nexport interface ConnectionsResponse {\n  connections: Connection[];\n  total: number;\n  page: number;\n  totalPages: number;\n  hasMore: boolean;\n}\n\nexport interface ConnectionStatusResponse {\n  status: ConnectionStatus;\n  connectionId?: string;\n  direction?: 'sent' | 'received';\n}\n\n// ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n// API FUNCTIONS\n// ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n/**\n * Send a connection request to another user\n */\nexport async function sendConnectionRequest(\n  receiverId: string,\n  message?: string\n): Promise<{ message: string; connection: Connection }> {\n  return apiClient.post('/connections/request', { receiverId, message });\n}\n\n/**\n * Accept a connection request\n */\nexport async function acceptConnectionRequest(\n  connectionId: string\n): Promise<{ message: string; connection: Connection }> {\n  return apiClient.post(`/connections/${connectionId}/accept`);\n}\n\n/**\n * Reject a connection request\n */\nexport async function rejectConnectionRequest(\n  connectionId: string\n): Promise<{ message: string }> {\n  return apiClient.post(`/connections/${connectionId}/reject`);\n}\n\n/**\n * Cancel a sent connection request\n */\nexport async function cancelConnectionRequest(\n  connectionId: string\n): Promise<{ message: string }> {\n  return apiClient.delete(`/connections/${connectionId}/cancel`);\n}\n\n/**\n * Remove an existing connection\n */\nexport async function removeConnection(\n  connectionId: string\n): Promise<{ message: string }> {\n  return apiClient.delete(`/connections/${connectionId}`);\n}\n\n/**\n * Get all connections for current user\n */\nexport async function getConnections(\n  page: number = 1,\n  limit: number = 20\n): Promise<ConnectionsResponse> {\n  return apiClient.get(`/connections?page=${page}&limit=${limit}`);\n}\n\n/**\n * Get all connections for a specific user\n */\nexport async function getUserConnections(\n  userId: string,\n  page: number = 1,\n  limit: number = 20\n): Promise<ConnectionsResponse> {\n  return apiClient.get(`/connections/user/${userId}?page=${page}&limit=${limit}`);\n}\n\n/**\n * Get pending connection requests (received)\n */\nexport async function getPendingRequests(\n  page: number = 1,\n  limit: number = 20\n): Promise<ConnectionsResponse> {\n  const response: any = await apiClient.get(`/connections/pending?page=${page}&limit=${limit}`);\n  // Backend returns 'requests', normalize to 'connections'\n  return {\n    connections: response.connections || response.requests || [],\n    total: response.total || 0,\n    page: response.page || page,\n    totalPages: response.totalPages || 1,\n    hasMore: response.hasMore || false,\n  };\n}\n\n/**\n * Get sent connection requests\n */\nexport async function getSentRequests(\n  page: number = 1,\n  limit: number = 20\n): Promise<ConnectionsResponse> {\n  const response: any = await apiClient.get(`/connections/sent?page=${page}&limit=${limit}`);\n  // Backend returns 'requests', normalize to 'connections'\n  return {\n    connections: response.connections || response.requests || [],\n    total: response.total || 0,\n    page: response.page || page,\n    totalPages: response.totalPages || 1,\n    hasMore: response.hasMore || false,\n  };\n}\n\n/**\n * Get connection status with a specific user\n */\nexport async function getConnectionStatus(\n  userId: string\n): Promise<ConnectionStatusResponse> {\n  return apiClient.get(`/connections/status/${userId}`);\n}\n\n/**\n * Block a user\n */\nexport async function blockUser(\n  userId: string\n): Promise<{ message: string }> {\n  return apiClient.post(`/users/${userId}/block`);\n}\n\n/**\n * Unblock a user\n */\nexport async function unblockUser(\n  userId: string\n): Promise<{ message: string }> {\n  return apiClient.delete(`/users/${userId}/block`);\n}\n\n/**\n * Get blocked users\n */\nexport async function getBlockedUsers(\n  page: number = 1,\n  limit: number = 20\n): Promise<{ users: Array<{ id: string; username: string; name: string; profileImage: string | null }>; total: number; hasMore: boolean }> {\n  return apiClient.get(`/users/blocked?page=${page}&limit=${limit}`);\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AA6CO,eAAe,sBACpB,UAAkB,EAClB,OAAgB;IAEhB,OAAO,yIAAS,CAAC,IAAI,CAAC,wBAAwB;QAAE;QAAY;IAAQ;AACtE;AAKO,eAAe,wBACpB,YAAoB;IAEpB,OAAO,yIAAS,CAAC,IAAI,CAAC,CAAC,aAAa,EAAE,aAAa,OAAO,CAAC;AAC7D;AAKO,eAAe,wBACpB,YAAoB;IAEpB,OAAO,yIAAS,CAAC,IAAI,CAAC,CAAC,aAAa,EAAE,aAAa,OAAO,CAAC;AAC7D;AAKO,eAAe,wBACpB,YAAoB;IAEpB,OAAO,yIAAS,CAAC,MAAM,CAAC,CAAC,aAAa,EAAE,aAAa,OAAO,CAAC;AAC/D;AAKO,eAAe,iBACpB,YAAoB;IAEpB,OAAO,yIAAS,CAAC,MAAM,CAAC,CAAC,aAAa,EAAE,cAAc;AACxD;AAKO,eAAe,eACpB,OAAe,CAAC,EAChB,QAAgB,EAAE;IAElB,OAAO,yIAAS,CAAC,GAAG,CAAC,CAAC,kBAAkB,EAAE,KAAK,OAAO,EAAE,OAAO;AACjE;AAKO,eAAe,mBACpB,MAAc,EACd,OAAe,CAAC,EAChB,QAAgB,EAAE;IAElB,OAAO,yIAAS,CAAC,GAAG,CAAC,CAAC,kBAAkB,EAAE,OAAO,MAAM,EAAE,KAAK,OAAO,EAAE,OAAO;AAChF;AAKO,eAAe,mBACpB,OAAe,CAAC,EAChB,QAAgB,EAAE;IAElB,MAAM,WAAgB,MAAM,yIAAS,CAAC,GAAG,CAAC,CAAC,0BAA0B,EAAE,KAAK,OAAO,EAAE,OAAO;IAC5F,yDAAyD;IACzD,OAAO;QACL,aAAa,SAAS,WAAW,IAAI,SAAS,QAAQ,IAAI,EAAE;QAC5D,OAAO,SAAS,KAAK,IAAI;QACzB,MAAM,SAAS,IAAI,IAAI;QACvB,YAAY,SAAS,UAAU,IAAI;QACnC,SAAS,SAAS,OAAO,IAAI;IAC/B;AACF;AAKO,eAAe,gBACpB,OAAe,CAAC,EAChB,QAAgB,EAAE;IAElB,MAAM,WAAgB,MAAM,yIAAS,CAAC,GAAG,CAAC,CAAC,uBAAuB,EAAE,KAAK,OAAO,EAAE,OAAO;IACzF,yDAAyD;IACzD,OAAO;QACL,aAAa,SAAS,WAAW,IAAI,SAAS,QAAQ,IAAI,EAAE;QAC5D,OAAO,SAAS,KAAK,IAAI;QACzB,MAAM,SAAS,IAAI,IAAI;QACvB,YAAY,SAAS,UAAU,IAAI;QACnC,SAAS,SAAS,OAAO,IAAI;IAC/B;AACF;AAKO,eAAe,oBACpB,MAAc;IAEd,OAAO,yIAAS,CAAC,GAAG,CAAC,CAAC,oBAAoB,EAAE,QAAQ;AACtD;AAKO,eAAe,UACpB,MAAc;IAEd,OAAO,yIAAS,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,OAAO,MAAM,CAAC;AAChD;AAKO,eAAe,YACpB,MAAc;IAEd,OAAO,yIAAS,CAAC,MAAM,CAAC,CAAC,OAAO,EAAE,OAAO,MAAM,CAAC;AAClD;AAKO,eAAe,gBACpB,OAAe,CAAC,EAChB,QAAgB,EAAE;IAElB,OAAO,yIAAS,CAAC,GAAG,CAAC,CAAC,oBAAoB,EAAE,KAAK,OAAO,EAAE,OAAO;AACnE"}},
    {"offset": {"line": 4187, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/lib/api/ai-chat.ts"],"sourcesContent":["import apiClient from './client';\n\n// ============================================\n// Types\n// ============================================\n\nexport interface ConversationStartersResponse {\n  suggestions: string[];\n  type: 'conversation_starters';\n}\n\nexport interface RevivalSuggestionsResponse {\n  suggestions: string[];\n  type: 'revival_suggestions';\n}\n\nexport interface GrammarFixResponse {\n  corrected: string;\n  alternatives: string[];\n  type: 'grammar_fix';\n}\n\nexport interface SmartRepliesResponse {\n  suggestions: string[];\n  type: 'smart_replies';\n}\n\nexport interface ToneChangeResponse {\n  original: string;\n  result: string;\n  tone: string;\n  type: 'tone_change';\n}\n\nexport interface TranslationResponse {\n  original: string;\n  translated: string;\n  targetLanguage: string;\n  type: 'translation';\n}\n\nexport interface ExpansionResponse {\n  original: string;\n  expanded: string;\n  type: 'expansion';\n}\n\nexport type ToneType = 'professional' | 'casual' | 'friendly' | 'formal' | 'enthusiastic' | 'concise';\nexport type LanguageType = 'english' | 'hindi' | 'telugu' | 'hinglish' | 'tenglish';\n\n// ============================================\n// AI Chat API Functions\n// ============================================\n\n/**\n * Get personalized conversation starters based on both users' profiles\n */\nexport async function getConversationStarters(\n  otherUserId: string\n): Promise<ConversationStartersResponse> {\n  return apiClient.post('/ai/chat/conversation-starters', { otherUserId });\n}\n\n/**\n * Get suggestions to continue a stalled conversation\n */\nexport async function getChatRevivalSuggestions(\n  conversationId: string,\n  otherUserId: string\n): Promise<RevivalSuggestionsResponse> {\n  return apiClient.post('/ai/chat/revival-suggestions', {\n    conversationId,\n    otherUserId,\n  });\n}\n\n/**\n * Fix grammar and spelling in a message\n */\nexport async function fixGrammar(\n  message: string,\n  context?: string\n): Promise<GrammarFixResponse> {\n  return apiClient.post('/ai/chat/fix-grammar', { message, context });\n}\n\n/**\n * Get smart reply suggestions based on the last message\n */\nexport async function getSmartReplies(\n  lastMessage: string,\n  conversationId?: string\n): Promise<SmartRepliesResponse> {\n  return apiClient.post('/ai/chat/smart-replies', {\n    lastMessage,\n    conversationId,\n  });\n}\n\n/**\n * Change the tone of a message\n */\nexport async function changeTone(\n  message: string,\n  tone: ToneType\n): Promise<ToneChangeResponse> {\n  return apiClient.post('/ai/chat/change-tone', { message, tone });\n}\n\n/**\n * Translate a message to another language\n */\nexport async function translateMessage(\n  message: string,\n  targetLanguage: LanguageType\n): Promise<TranslationResponse> {\n  return apiClient.post('/ai/chat/translate', { message, targetLanguage });\n}\n\n/**\n * Expand a short message into a more detailed one\n */\nexport async function expandMessage(\n  message: string,\n  context?: 'professional' | 'casual'\n): Promise<ExpansionResponse> {\n  return apiClient.post('/ai/chat/expand', { message, context });\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;;AAyDO,eAAe,wBACpB,WAAmB;IAEnB,OAAO,yIAAS,CAAC,IAAI,CAAC,kCAAkC;QAAE;IAAY;AACxE;AAKO,eAAe,0BACpB,cAAsB,EACtB,WAAmB;IAEnB,OAAO,yIAAS,CAAC,IAAI,CAAC,gCAAgC;QACpD;QACA;IACF;AACF;AAKO,eAAe,WACpB,OAAe,EACf,OAAgB;IAEhB,OAAO,yIAAS,CAAC,IAAI,CAAC,wBAAwB;QAAE;QAAS;IAAQ;AACnE;AAKO,eAAe,gBACpB,WAAmB,EACnB,cAAuB;IAEvB,OAAO,yIAAS,CAAC,IAAI,CAAC,0BAA0B;QAC9C;QACA;IACF;AACF;AAKO,eAAe,WACpB,OAAe,EACf,IAAc;IAEd,OAAO,yIAAS,CAAC,IAAI,CAAC,wBAAwB;QAAE;QAAS;IAAK;AAChE;AAKO,eAAe,iBACpB,OAAe,EACf,cAA4B;IAE5B,OAAO,yIAAS,CAAC,IAAI,CAAC,sBAAsB;QAAE;QAAS;IAAe;AACxE;AAKO,eAAe,cACpB,OAAe,EACf,OAAmC;IAEnC,OAAO,yIAAS,CAAC,IAAI,CAAC,mBAAmB;QAAE;QAAS;IAAQ;AAC9D"}},
    {"offset": {"line": 4253, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/chat/AIChatAssistant.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { cn } from '@/lib/utils';\nimport {\n  Sparkles,\n  MessageSquarePlus,\n  RefreshCw,\n  SpellCheck,\n  Zap,\n  Languages,\n  ArrowUpRight,\n  Palette,\n  X,\n  Loader2,\n  Check,\n  ChevronDown,\n} from 'lucide-react';\nimport {\n  getConversationStarters,\n  getChatRevivalSuggestions,\n  fixGrammar,\n  getSmartReplies,\n  changeTone,\n  translateMessage,\n  expandMessage,\n  type ToneType,\n  type LanguageType,\n} from '@/lib/api/ai-chat';\n\n// ============================================\n// Types\n// ============================================\n\ninterface AIChatAssistantProps {\n  conversationId: string;\n  otherUserId: string;\n  otherUserName: string;\n  currentMessage: string;\n  lastReceivedMessage?: string;\n  onSuggestionSelect: (text: string) => void;\n  onClose?: () => void;\n}\n\ntype AIFeature = \n  | 'starters'\n  | 'revival'\n  | 'grammar'\n  | 'smart-reply'\n  | 'tone'\n  | 'translate'\n  | 'expand';\n\ninterface FeatureOption {\n  id: AIFeature;\n  label: string;\n  icon: React.ReactNode;\n  description: string;\n  requiresMessage?: boolean;\n  requiresReceivedMessage?: boolean;\n}\n\n// ============================================\n// Constants\n// ============================================\n\nconst FEATURES: FeatureOption[] = [\n  {\n    id: 'starters',\n    label: 'Ice Breakers',\n    icon: <MessageSquarePlus className=\"w-4 h-4\" />,\n    description: 'Personalized conversation starters',\n  },\n  {\n    id: 'revival',\n    label: 'Continue Chat',\n    icon: <RefreshCw className=\"w-4 h-4\" />,\n    description: 'Revive a stalled conversation',\n  },\n  {\n    id: 'smart-reply',\n    label: 'Quick Reply',\n    icon: <Zap className=\"w-4 h-4\" />,\n    description: 'Smart reply suggestions',\n    requiresReceivedMessage: true,\n  },\n  {\n    id: 'grammar',\n    label: 'Fix Grammar',\n    icon: <SpellCheck className=\"w-4 h-4\" />,\n    description: 'Fix grammar & spelling',\n    requiresMessage: true,\n  },\n  {\n    id: 'tone',\n    label: 'Change Tone',\n    icon: <Palette className=\"w-4 h-4\" />,\n    description: 'Rewrite in different tone',\n    requiresMessage: true,\n  },\n  {\n    id: 'translate',\n    label: 'Translate',\n    icon: <Languages className=\"w-4 h-4\" />,\n    description: 'Translate to another language',\n    requiresMessage: true,\n  },\n  {\n    id: 'expand',\n    label: 'Expand',\n    icon: <ArrowUpRight className=\"w-4 h-4\" />,\n    description: 'Expand short message',\n    requiresMessage: true,\n  },\n];\n\nconst TONE_OPTIONS: { value: ToneType; label: string; emoji: string }[] = [\n  { value: 'professional', label: 'Professional', emoji: 'üíº' },\n  { value: 'casual', label: 'Casual', emoji: 'üòé' },\n  { value: 'friendly', label: 'Friendly', emoji: 'ü§ó' },\n  { value: 'formal', label: 'Formal', emoji: 'üé©' },\n  { value: 'enthusiastic', label: 'Enthusiastic', emoji: 'üî•' },\n  { value: 'concise', label: 'Concise', emoji: '‚ö°' },\n];\n\nconst LANGUAGE_OPTIONS: { value: LanguageType; label: string }[] = [\n  { value: 'english', label: 'English' },\n  { value: 'hindi', label: 'Hindi' },\n  { value: 'telugu', label: 'Telugu' },\n  { value: 'hinglish', label: 'Hinglish' },\n  { value: 'tenglish', label: 'Tenglish' },\n];\n\n// ============================================\n// Component\n// ============================================\n\nexport default function AIChatAssistant({\n  conversationId,\n  otherUserId,\n  otherUserName,\n  currentMessage,\n  lastReceivedMessage,\n  onSuggestionSelect,\n  onClose,\n}: AIChatAssistantProps) {\n  const [selectedFeature, setSelectedFeature] = useState<AIFeature | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [suggestions, setSuggestions] = useState<string[]>([]);\n  const [selectedTone, setSelectedTone] = useState<ToneType>('casual');\n  const [selectedLanguage, setSelectedLanguage] = useState<LanguageType>('english');\n  const [showToneDropdown, setShowToneDropdown] = useState(false);\n  const [showLanguageDropdown, setShowLanguageDropdown] = useState(false);\n\n  // Handle feature selection\n  const handleFeatureClick = async (feature: AIFeature) => {\n    // Check requirements\n    if (FEATURES.find(f => f.id === feature)?.requiresMessage && !currentMessage.trim()) {\n      setError('Please type a message first');\n      return;\n    }\n    if (FEATURES.find(f => f.id === feature)?.requiresReceivedMessage && !lastReceivedMessage) {\n      setError('No message to reply to');\n      return;\n    }\n\n    setSelectedFeature(feature);\n    setError(null);\n    setSuggestions([]);\n\n    // For tone and translate, just show the options\n    if (feature === 'tone' || feature === 'translate') {\n      return;\n    }\n\n    await fetchSuggestions(feature);\n  };\n\n  // Fetch suggestions based on feature\n  const fetchSuggestions = async (feature: AIFeature, extraParams?: { tone?: ToneType; language?: LanguageType }) => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      let result: string[] = [];\n\n      switch (feature) {\n        case 'starters': {\n          const response = await getConversationStarters(otherUserId);\n          result = response.suggestions;\n          break;\n        }\n        case 'revival': {\n          const response = await getChatRevivalSuggestions(conversationId, otherUserId);\n          result = response.suggestions;\n          break;\n        }\n        case 'grammar': {\n          const response = await fixGrammar(currentMessage);\n          result = [response.corrected, ...response.alternatives];\n          break;\n        }\n        case 'smart-reply': {\n          const response = await getSmartReplies(lastReceivedMessage || '', conversationId);\n          result = response.suggestions;\n          break;\n        }\n        case 'tone': {\n          const response = await changeTone(currentMessage, extraParams?.tone || selectedTone);\n          result = [response.result];\n          break;\n        }\n        case 'translate': {\n          const response = await translateMessage(currentMessage, extraParams?.language || selectedLanguage);\n          result = [response.translated];\n          break;\n        }\n        case 'expand': {\n          const response = await expandMessage(currentMessage);\n          result = [response.expanded];\n          break;\n        }\n      }\n\n      setSuggestions(result);\n    } catch (err: any) {\n      console.error('AI suggestion error:', err);\n      setError(err.response?.data?.error || 'Failed to generate suggestions');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Handle tone selection\n  const handleToneSelect = async (tone: ToneType) => {\n    setSelectedTone(tone);\n    setShowToneDropdown(false);\n    await fetchSuggestions('tone', { tone });\n  };\n\n  // Handle language selection\n  const handleLanguageSelect = async (language: LanguageType) => {\n    setSelectedLanguage(language);\n    setShowLanguageDropdown(false);\n    await fetchSuggestions('translate', { language });\n  };\n\n  // Handle suggestion selection\n  const handleSuggestionClick = (suggestion: string) => {\n    onSuggestionSelect(suggestion);\n    onClose?.();\n  };\n\n  // Reset to feature selection\n  const handleBack = () => {\n    setSelectedFeature(null);\n    setSuggestions([]);\n    setError(null);\n  };\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 10 }}\n      animate={{ opacity: 1, y: 0 }}\n      exit={{ opacity: 0, y: 10 }}\n      className=\"absolute bottom-full left-0 right-0 mb-3 mx-0 bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 overflow-hidden z-50\"\n      style={{ maxHeight: 'calc(100vh - 200px)' }}\n    >\n      {/* Header */}\n      <div className=\"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20\">\n        <div className=\"flex items-center gap-2\">\n          <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-blue-500 flex items-center justify-center\">\n            <Sparkles className=\"w-4 h-4 text-white\" />\n          </div>\n          <div>\n            <h3 className=\"font-semibold text-sm text-gray-900 dark:text-white\">\n              AI Assistant\n            </h3>\n            <p className=\"text-xs text-gray-500\">\n              {selectedFeature \n                ? FEATURES.find(f => f.id === selectedFeature)?.description \n                : 'Choose an action'}\n            </p>\n          </div>\n        </div>\n        <button\n          onClick={onClose}\n          className=\"p-1.5 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors\"\n        >\n          <X className=\"w-4 h-4 text-gray-500\" />\n        </button>\n      </div>\n\n      {/* Content */}\n      <div className=\"p-3 max-h-80 overflow-y-auto\">\n        <AnimatePresence mode=\"wait\">\n          {!selectedFeature ? (\n            // Feature Selection Grid\n            <motion.div\n              key=\"features\"\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={{ opacity: 0 }}\n              className=\"grid grid-cols-2 gap-2\"\n            >\n              {FEATURES.map((feature) => {\n                const isDisabled = \n                  (feature.requiresMessage && !currentMessage.trim()) ||\n                  (feature.requiresReceivedMessage && !lastReceivedMessage);\n\n                return (\n                  <button\n                    key={feature.id}\n                    onClick={() => handleFeatureClick(feature.id)}\n                    disabled={isDisabled}\n                    className={cn(\n                      \"flex items-center gap-3 p-3 rounded-xl text-left transition-all\",\n                      isDisabled\n                        ? \"opacity-50 cursor-not-allowed bg-gray-50 dark:bg-gray-800\"\n                        : \"hover:bg-gray-100 dark:hover:bg-gray-700 bg-gray-50 dark:bg-gray-800/50 hover:scale-[1.02]\"\n                    )}\n                  >\n                    <div className={cn(\n                      \"w-9 h-9 rounded-xl flex items-center justify-center\",\n                      feature.id === 'starters' && \"bg-green-100 dark:bg-green-900/30 text-green-600\",\n                      feature.id === 'revival' && \"bg-orange-100 dark:bg-orange-900/30 text-orange-600\",\n                      feature.id === 'smart-reply' && \"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-600\",\n                      feature.id === 'grammar' && \"bg-blue-100 dark:bg-blue-900/30 text-blue-600\",\n                      feature.id === 'tone' && \"bg-purple-100 dark:bg-purple-900/30 text-purple-600\",\n                      feature.id === 'translate' && \"bg-pink-100 dark:bg-pink-900/30 text-pink-600\",\n                      feature.id === 'expand' && \"bg-cyan-100 dark:bg-cyan-900/30 text-cyan-600\",\n                    )}>\n                      {feature.icon}\n                    </div>\n                    <div className=\"flex-1 min-w-0\">\n                      <p className=\"font-medium text-sm text-gray-900 dark:text-white truncate\">\n                        {feature.label}\n                      </p>\n                      <p className=\"text-xs text-gray-500 truncate\">\n                        {feature.description}\n                      </p>\n                    </div>\n                  </button>\n                );\n              })}\n            </motion.div>\n          ) : (\n            // Suggestions View\n            <motion.div\n              key=\"suggestions\"\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={{ opacity: 0 }}\n            >\n              {/* Back button */}\n              <button\n                onClick={handleBack}\n                className=\"flex items-center gap-1 text-sm text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 mb-3\"\n              >\n                <ChevronDown className=\"w-4 h-4 rotate-90\" />\n                Back to options\n              </button>\n\n              {/* Tone/Language Selector for those features */}\n              {selectedFeature === 'tone' && (\n                <div className=\"mb-3 relative\">\n                  <button\n                    onClick={() => setShowToneDropdown(!showToneDropdown)}\n                    className=\"w-full flex items-center justify-between px-4 py-2.5 bg-gray-100 dark:bg-gray-700 rounded-xl text-sm\"\n                  >\n                    <span className=\"flex items-center gap-2\">\n                      <span>{TONE_OPTIONS.find(t => t.value === selectedTone)?.emoji}</span>\n                      <span>{TONE_OPTIONS.find(t => t.value === selectedTone)?.label}</span>\n                    </span>\n                    <ChevronDown className={cn(\"w-4 h-4 transition-transform\", showToneDropdown && \"rotate-180\")} />\n                  </button>\n                  {showToneDropdown && (\n                    <div className=\"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden z-10\">\n                      {TONE_OPTIONS.map((tone) => (\n                        <button\n                          key={tone.value}\n                          onClick={() => handleToneSelect(tone.value)}\n                          className=\"w-full flex items-center gap-2 px-4 py-2.5 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 text-left\"\n                        >\n                          <span>{tone.emoji}</span>\n                          <span>{tone.label}</span>\n                          {selectedTone === tone.value && (\n                            <Check className=\"w-4 h-4 ml-auto text-green-500\" />\n                          )}\n                        </button>\n                      ))}\n                    </div>\n                  )}\n                </div>\n              )}\n\n              {selectedFeature === 'translate' && (\n                <div className=\"mb-3 relative\">\n                  <button\n                    onClick={() => setShowLanguageDropdown(!showLanguageDropdown)}\n                    className=\"w-full flex items-center justify-between px-4 py-2.5 bg-gray-100 dark:bg-gray-700 rounded-xl text-sm\"\n                  >\n                    <span>{LANGUAGE_OPTIONS.find(l => l.value === selectedLanguage)?.label}</span>\n                    <ChevronDown className={cn(\"w-4 h-4 transition-transform\", showLanguageDropdown && \"rotate-180\")} />\n                  </button>\n                  {showLanguageDropdown && (\n                    <div className=\"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden z-10\">\n                      {LANGUAGE_OPTIONS.map((lang) => (\n                        <button\n                          key={lang.value}\n                          onClick={() => handleLanguageSelect(lang.value)}\n                          className=\"w-full flex items-center gap-2 px-4 py-2.5 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 text-left\"\n                        >\n                          <span>{lang.label}</span>\n                          {selectedLanguage === lang.value && (\n                            <Check className=\"w-4 h-4 ml-auto text-green-500\" />\n                          )}\n                        </button>\n                      ))}\n                    </div>\n                  )}\n                </div>\n              )}\n\n              {/* Loading State */}\n              {loading && (\n                <div className=\"flex items-center justify-center py-8\">\n                  <Loader2 className=\"w-6 h-6 animate-spin text-blue-500\" />\n                  <span className=\"ml-2 text-sm text-gray-500\">Generating suggestions...</span>\n                </div>\n              )}\n\n              {/* Error State */}\n              {error && (\n                <div className=\"p-4 bg-red-50 dark:bg-red-900/20 rounded-xl text-center\">\n                  <p className=\"text-sm text-red-600 dark:text-red-400\">{error}</p>\n                  <button\n                    onClick={() => fetchSuggestions(selectedFeature)}\n                    className=\"mt-2 text-sm text-blue-600 hover:underline\"\n                  >\n                    Try again\n                  </button>\n                </div>\n              )}\n\n              {/* Suggestions List */}\n              {!loading && !error && suggestions.length > 0 && (\n                <div className=\"space-y-2\">\n                  {suggestions.map((suggestion, index) => (\n                    <motion.button\n                      key={index}\n                      initial={{ opacity: 0, x: -10 }}\n                      animate={{ opacity: 1, x: 0 }}\n                      transition={{ delay: index * 0.1 }}\n                      onClick={() => handleSuggestionClick(suggestion)}\n                      className={cn(\n                        \"w-full p-3 text-left rounded-xl transition-all\",\n                        \"bg-gray-50 dark:bg-gray-700/50 hover:bg-gray-100 dark:hover:bg-gray-700\",\n                        \"hover:shadow-md hover:scale-[1.01]\",\n                        \"border border-transparent hover:border-blue-200 dark:hover:border-blue-800\"\n                      )}\n                    >\n                      <p className=\"text-sm text-gray-800 dark:text-gray-200 leading-relaxed\">\n                        {suggestion}\n                      </p>\n                      {index === 0 && selectedFeature === 'grammar' && (\n                        <span className=\"inline-flex items-center gap-1 mt-1 text-xs text-green-600 dark:text-green-400\">\n                          <Check className=\"w-3 h-3\" />\n                          Best correction\n                        </span>\n                      )}\n                    </motion.button>\n                  ))}\n                </div>\n              )}\n\n              {/* Regenerate button */}\n              {!loading && suggestions.length > 0 && selectedFeature !== 'tone' && selectedFeature !== 'translate' && (\n                <button\n                  onClick={() => fetchSuggestions(selectedFeature)}\n                  className=\"w-full mt-3 flex items-center justify-center gap-2 py-2.5 text-sm text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors\"\n                >\n                  <RefreshCw className=\"w-4 h-4\" />\n                  Generate new suggestions\n                </button>\n              )}\n            </motion.div>\n          )}\n        </AnimatePresence>\n      </div>\n\n      {/* Footer tip */}\n      <div className=\"px-4 py-2 bg-gray-50 dark:bg-gray-900/50 border-t border-gray-200 dark:border-gray-700\">\n        <p className=\"text-xs text-gray-500 text-center\">\n          {currentMessage.trim() \n            ? `Message: \"${currentMessage.slice(0, 30)}${currentMessage.length > 30 ? '...' : ''}\"`\n            : 'Type a message to use grammar, tone, or translate features'}\n        </p>\n      </div>\n    </motion.div>\n  );\n}\n"],"names":["React","useState","motion","AnimatePresence","cn","Sparkles","MessageSquarePlus","RefreshCw","SpellCheck","Zap","Languages","ArrowUpRight","Palette","X","Loader2","Check","ChevronDown","getConversationStarters","getChatRevivalSuggestions","fixGrammar","getSmartReplies","changeTone","translateMessage","expandMessage","ToneType","LanguageType","AIChatAssistantProps","conversationId","otherUserId","otherUserName","currentMessage","lastReceivedMessage","onSuggestionSelect","text","onClose","AIFeature","FeatureOption","id","label","icon","ReactNode","description","requiresMessage","requiresReceivedMessage","FEATURES","TONE_OPTIONS","value","emoji","LANGUAGE_OPTIONS","AIChatAssistant","selectedFeature","setSelectedFeature","loading","setLoading","error","setError","suggestions","setSuggestions","selectedTone","setSelectedTone","selectedLanguage","setSelectedLanguage","showToneDropdown","setShowToneDropdown","showLanguageDropdown","setShowLanguageDropdown","handleFeatureClick","feature","find","f","trim","fetchSuggestions","extraParams","tone","language","result","response","corrected","alternatives","translated","expanded","err","console","data","handleToneSelect","handleLanguageSelect","handleSuggestionClick","suggestion","handleBack","opacity","y","maxHeight","map","isDisabled","t","l","lang","length","index","x","delay","slice"],"mappings":"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","ignoreList":[]}},
    {"offset": {"line": 5062, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/chat/ChatInput.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useRef, useEffect, useCallback, useMemo } from 'react';\nimport { sendChatMessage, sendChatTyping } from '@/lib/socket';\nimport { uploadChatMedia, getMessageLimitStatus, type MessageLimitStatus } from '@/lib/api/chat';\nimport { sendConnectionRequest } from '@/lib/api/connections';\nimport { cn } from '@/lib/utils';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport {\n  Paperclip,\n  Image as ImageIcon,\n  FileText,\n  Video,\n  Mic,\n  X,\n  Send,\n  Smile,\n  File,\n  Square,\n  Trash2,\n  Sparkles,\n  Pencil,\n  Loader2,\n  UserPlus,\n  Lock,\n  MessageCircle,\n  Zap,\n} from 'lucide-react';\nimport AIChatAssistant from './AIChatAssistant';\nimport { fixGrammar } from '@/lib/api/ai-chat';\n\n// File type configurations\nconst ALLOWED_FILE_TYPES = {\n  image: ['image/jpeg', 'image/png', 'image/gif', 'image/webp'],\n  video: ['video/mp4', 'video/webm', 'video/quicktime'],\n  document: ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'],\n  audio: ['audio/mpeg', 'audio/wav', 'audio/ogg', 'audio/webm'],\n};\n\nconst MAX_FILE_SIZE = 50 * 1024 * 1024; // 50MB\nconst MAX_VIDEO_DURATION = 60; // 60 seconds\n\n// Uploading message interface for optimistic UI\nexport interface UploadingMessage {\n  id: string;\n  type: 'image' | 'video' | 'document' | 'audio';\n  preview?: string;\n  fileName?: string;\n  progress: number;\n}\n\n// Optimistic message for immediate display\nexport interface OptimisticMessage {\n  id: string;\n  conversationId: string;\n  senderId: string;\n  content: string;\n  contentType: string;\n  mediaUrl?: string;\n  fileName?: string;\n  fileSize?: number;\n  replyToId?: string;\n  replyTo?: {\n    id: string;\n    content: string;\n    senderName: string;\n  };\n  status: 'SENDING';\n  createdAt: string;\n}\n\ninterface ChatInputProps {\n  conversationId: string;\n  currentUserId?: string;\n  replyTo?: {\n    id: string;\n    content: string;\n    senderName: string;\n  };\n  onCancelReply?: () => void;\n  disabled?: boolean;\n  onUploadingMessagesChange?: (messages: UploadingMessage[]) => void;\n  onOptimisticMessage?: (message: OptimisticMessage) => void;\n  // AI Assistant props\n  otherUserId?: string;\n  otherUserName?: string;\n  lastReceivedMessage?: string;\n  enabledMessageEffects?: {\n    confetti: boolean;\n    fireworks: boolean;\n    voiceSfx: boolean;\n  };\n}\n\ninterface FilePreview {\n  file: File;\n  preview: string;\n  type: 'image' | 'video' | 'document' | 'audio';\n}\n\nexport default function ChatInput({\n  conversationId,\n  currentUserId,\n  replyTo,\n  onCancelReply,\n  disabled = false,\n  onUploadingMessagesChange,\n  onOptimisticMessage,\n  otherUserId,\n  otherUserName,\n  lastReceivedMessage,\n  enabledMessageEffects,\n}: ChatInputProps) {\n  const [message, setMessage] = useState('');\n  const [isTyping, setIsTyping] = useState(false);\n  const [showEmoji, setShowEmoji] = useState(false);\n  const [showAttachMenu, setShowAttachMenu] = useState(false);\n  const [showAIAssistant, setShowAIAssistant] = useState(false);\n  const [isFixingGrammar, setIsFixingGrammar] = useState(false);\n  const [selectedFiles, setSelectedFiles] = useState<FilePreview[]>([]);\n  const [isRecording, setIsRecording] = useState(false);\n  const [recordingDuration, setRecordingDuration] = useState(0);\n  const [audioBlob, setAudioBlob] = useState<Blob | null>(null);\n  const [uploadingMessages, setUploadingMessages] = useState<UploadingMessage[]>([]);\n  \n  // Message limit state\n  const [messageLimitInfo, setMessageLimitInfo] = useState<MessageLimitStatus | null>(null);\n  const [showConnectionPrompt, setShowConnectionPrompt] = useState(false);\n  const [isSendingConnectionRequest, setIsSendingConnectionRequest] = useState(false);\n  const [connectionRequestSent, setConnectionRequestSent] = useState(false);\n  const [selectedMessageEffect, setSelectedMessageEffect] = useState<'none' | 'confetti' | 'fireworks'>('none');\n  \n  const inputRef = useRef<HTMLTextAreaElement>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const typingTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const attachMenuRef = useRef<HTMLDivElement>(null);\n  const mediaRecorderRef = useRef<MediaRecorder | null>(null);\n  const audioChunksRef = useRef<Blob[]>([]);\n  const recordingIntervalRef = useRef<NodeJS.Timeout | null>(null);\n\n  // Check message limit on mount and when conversation changes\n  useEffect(() => {\n    const checkMessageLimit = async () => {\n      if (!otherUserId) return;\n      \n      try {\n        const limitStatus = await getMessageLimitStatus(otherUserId);\n        setMessageLimitInfo(limitStatus);\n        \n        // Show prompt immediately if limit is reached and not connected\n        if (!limitStatus.isConnected && !limitStatus.canSend) {\n          setShowConnectionPrompt(true);\n        }\n      } catch (error) {\n        console.error('Failed to check message limit:', error);\n      }\n    };\n    \n    checkMessageLimit();\n  }, [conversationId, otherUserId]);\n\n  const availableMessageEffects = useMemo<Array<'confetti' | 'fireworks'>>(\n    () => [\n      ...(enabledMessageEffects?.confetti ? ['confetti' as const] : []),\n      ...(enabledMessageEffects?.fireworks ? ['fireworks' as const] : []),\n    ],\n    [enabledMessageEffects?.confetti, enabledMessageEffects?.fireworks]\n  );\n\n  useEffect(() => {\n    if (selectedMessageEffect === 'none') return;\n    if (!availableMessageEffects.includes(selectedMessageEffect)) {\n      setSelectedMessageEffect('none');\n    }\n  }, [availableMessageEffects, selectedMessageEffect]);\n\n  const cycleMessageEffect = () => {\n    const cycle: Array<'none' | 'confetti' | 'fireworks'> = ['none', ...availableMessageEffects];\n    if (cycle.length <= 1) return;\n\n    const currentIndex = cycle.indexOf(selectedMessageEffect);\n    const nextIndex = currentIndex === -1 ? 0 : (currentIndex + 1) % cycle.length;\n    setSelectedMessageEffect(cycle[nextIndex]);\n  };\n\n  const triggerMessageEffect = useCallback(async (effect: 'confetti' | 'fireworks') => {\n    try {\n      const confetti = (await import('canvas-confetti')).default;\n\n      if (effect === 'confetti') {\n        confetti({\n          particleCount: 60,\n          spread: 55,\n          origin: { y: 0.7 },\n          colors: ['#22c55e', '#38bdf8', '#f59e0b', '#f43f5e'],\n        });\n        return;\n      }\n\n      confetti({\n        particleCount: 80,\n        spread: 70,\n        origin: { x: 0.2, y: 0.7 },\n        colors: ['#f97316', '#facc15', '#fb7185', '#60a5fa'],\n      });\n      confetti({\n        particleCount: 80,\n        spread: 70,\n        origin: { x: 0.8, y: 0.7 },\n        colors: ['#f97316', '#facc15', '#fb7185', '#60a5fa'],\n      });\n    } catch {\n      // Ignore silently if canvas-confetti cannot load\n    }\n  }, []);\n\n  const playVoiceSfx = useCallback(() => {\n    if (!enabledMessageEffects?.voiceSfx || typeof window === 'undefined') return;\n\n    try {\n      const AudioContextClass =\n        window.AudioContext ||\n        (window as Window & { webkitAudioContext?: typeof AudioContext }).webkitAudioContext;\n      if (!AudioContextClass) return;\n\n      const audioContext = new AudioContextClass();\n      const oscillator = audioContext.createOscillator();\n      const gainNode = audioContext.createGain();\n\n      oscillator.type = 'triangle';\n      oscillator.frequency.setValueAtTime(660, audioContext.currentTime);\n      oscillator.frequency.exponentialRampToValueAtTime(440, audioContext.currentTime + 0.12);\n\n      gainNode.gain.setValueAtTime(0.0001, audioContext.currentTime);\n      gainNode.gain.exponentialRampToValueAtTime(0.12, audioContext.currentTime + 0.01);\n      gainNode.gain.exponentialRampToValueAtTime(0.0001, audioContext.currentTime + 0.14);\n\n      oscillator.connect(gainNode);\n      gainNode.connect(audioContext.destination);\n      oscillator.start();\n      oscillator.stop(audioContext.currentTime + 0.14);\n    } catch {\n      // Ignore silently when browser blocks autoplay/audio context\n    }\n  }, [enabledMessageEffects?.voiceSfx]);\n\n  // Handle sending connection request\n  const handleSendConnectionRequest = async () => {\n    if (!otherUserId || isSendingConnectionRequest) return;\n    \n    setIsSendingConnectionRequest(true);\n    try {\n      await sendConnectionRequest(otherUserId);\n      setConnectionRequestSent(true);\n      // Don't close prompt, show success message\n    } catch (error: unknown) {\n      console.error('Failed to send connection request:', error);\n      // Check if request already exists\n      const errorMessage = error instanceof Error ? error.message : '';\n      if (errorMessage.includes('already') || errorMessage.includes('pending')) {\n        setConnectionRequestSent(true);\n      } else {\n        alert('Failed to send connection request. Please try again.');\n      }\n    } finally {\n      setIsSendingConnectionRequest(false);\n    }\n  };\n\n  // Auto-resize textarea\n  useEffect(() => {\n    if (inputRef.current) {\n      inputRef.current.style.height = 'auto';\n      inputRef.current.style.height = `${Math.min(inputRef.current.scrollHeight, 120)}px`;\n    }\n  }, [message]);\n\n  // Close attachment menu when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (attachMenuRef.current && !attachMenuRef.current.contains(event.target as Node)) {\n        setShowAttachMenu(false);\n      }\n    };\n\n    if (showAttachMenu) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [showAttachMenu]);\n\n  // Handle typing indicator\n  const handleTyping = useCallback(() => {\n    if (!isTyping) {\n      setIsTyping(true);\n      sendChatTyping(conversationId, true);\n    }\n\n    // Clear existing timeout\n    if (typingTimeoutRef.current) {\n      clearTimeout(typingTimeoutRef.current);\n    }\n\n    // Set new timeout to stop typing indicator\n    typingTimeoutRef.current = setTimeout(() => {\n      setIsTyping(false);\n      sendChatTyping(conversationId, false);\n    }, 2000);\n  }, [conversationId, isTyping]);\n\n  // Clean up typing timeout\n  useEffect(() => {\n    return () => {\n      if (typingTimeoutRef.current) {\n        clearTimeout(typingTimeoutRef.current);\n      }\n    };\n  }, []);\n\n  // Get file type category\n  const getFileType = (file: File): 'image' | 'video' | 'document' | 'audio' | null => {\n    for (const [type, mimes] of Object.entries(ALLOWED_FILE_TYPES)) {\n      if (mimes.includes(file.type)) {\n        return type as 'image' | 'video' | 'document' | 'audio';\n      }\n    }\n    return null;\n  };\n\n  // Check video duration\n  const checkVideoDuration = (file: File): Promise<boolean> => {\n    return new Promise((resolve) => {\n      const video = document.createElement('video');\n      video.preload = 'metadata';\n      video.onloadedmetadata = () => {\n        URL.revokeObjectURL(video.src);\n        if (video.duration > MAX_VIDEO_DURATION) {\n          alert(`Video \"${file.name}\" is too long. Maximum duration is ${MAX_VIDEO_DURATION} seconds.`);\n          resolve(false);\n        } else {\n          resolve(true);\n        }\n      };\n      video.onerror = () => {\n        URL.revokeObjectURL(video.src);\n        resolve(true); // Allow if we can't check duration\n      };\n      video.src = URL.createObjectURL(file);\n    });\n  };\n\n  // Handle file selection\n  const handleFileSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = Array.from(e.target.files || []);\n    \n    const validFiles: FilePreview[] = [];\n    \n    for (const file of files) {\n      // Check file size\n      if (file.size > MAX_FILE_SIZE) {\n        alert(`File \"${file.name}\" is too large. Maximum size is 50MB.`);\n        continue;\n      }\n\n      const fileType = getFileType(file);\n      \n      if (!fileType) {\n        alert(`File type not supported: ${file.name}`);\n        continue;\n      }\n\n      // Check video duration\n      if (fileType === 'video') {\n        const isValidDuration = await checkVideoDuration(file);\n        if (!isValidDuration) {\n          continue;\n        }\n      }\n\n      // Create preview URL\n      let preview = '';\n      if (fileType === 'image' || fileType === 'video') {\n        preview = URL.createObjectURL(file);\n      }\n\n      validFiles.push({\n        file,\n        preview,\n        type: fileType,\n      });\n    }\n\n    setSelectedFiles(prev => [...prev, ...validFiles]);\n    setShowAttachMenu(false);\n    \n    // Reset file input\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  // Remove selected file\n  const removeFile = (index: number) => {\n    setSelectedFiles(prev => {\n      const newFiles = [...prev];\n      // Revoke object URL to free memory\n      if (newFiles[index].preview) {\n        URL.revokeObjectURL(newFiles[index].preview);\n      }\n      newFiles.splice(index, 1);\n      return newFiles;\n    });\n  };\n\n  // Open file picker for specific type\n  const openFilePicker = (accept: string) => {\n    if (fileInputRef.current) {\n      fileInputRef.current.accept = accept;\n      fileInputRef.current.click();\n    }\n    setShowAttachMenu(false);\n  };\n\n  // Voice recording functions\n  const startRecording = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n      const mediaRecorder = new MediaRecorder(stream, { mimeType: 'audio/webm' });\n      mediaRecorderRef.current = mediaRecorder;\n      audioChunksRef.current = [];\n\n      mediaRecorder.ondataavailable = (e) => {\n        if (e.data.size > 0) {\n          audioChunksRef.current.push(e.data);\n        }\n      };\n\n      mediaRecorder.onstop = () => {\n        const audioBlob = new Blob(audioChunksRef.current, { type: 'audio/webm' });\n        setAudioBlob(audioBlob);\n        stream.getTracks().forEach(track => track.stop());\n      };\n\n      mediaRecorder.start();\n      setIsRecording(true);\n      setRecordingDuration(0);\n\n      // Update duration every second\n      recordingIntervalRef.current = setInterval(() => {\n        setRecordingDuration(prev => prev + 1);\n      }, 1000);\n    } catch (error) {\n      console.error('Failed to start recording:', error);\n      alert('Could not access microphone. Please grant permission.');\n    }\n  };\n\n  const stopRecording = () => {\n    if (mediaRecorderRef.current && isRecording) {\n      mediaRecorderRef.current.stop();\n      setIsRecording(false);\n      if (recordingIntervalRef.current) {\n        clearInterval(recordingIntervalRef.current);\n        recordingIntervalRef.current = null;\n      }\n    }\n  };\n\n  const cancelRecording = () => {\n    if (mediaRecorderRef.current) {\n      mediaRecorderRef.current.stream.getTracks().forEach(track => track.stop());\n    }\n    setIsRecording(false);\n    setAudioBlob(null);\n    setRecordingDuration(0);\n    if (recordingIntervalRef.current) {\n      clearInterval(recordingIntervalRef.current);\n      recordingIntervalRef.current = null;\n    }\n  };\n\n  const formatDuration = (seconds: number): string => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  // Sync uploading messages to parent via useEffect to avoid setState during render\n  useEffect(() => {\n    onUploadingMessagesChange?.(uploadingMessages);\n  }, [uploadingMessages, onUploadingMessagesChange]);\n\n  const handleSend = async () => {\n    const trimmedMessage = message.trim();\n    const hasFiles = selectedFiles.length > 0;\n    const hasAudio = audioBlob !== null;\n    \n    if (!trimmedMessage && !hasFiles && !hasAudio) return;\n\n    // Check message limit before sending (for non-connected users)\n    if (messageLimitInfo && !messageLimitInfo.isConnected && !messageLimitInfo.canSend) {\n      setShowConnectionPrompt(true);\n      return;\n    }\n\n    // Immediately clear typing state and stop broadcasting\n    if (typingTimeoutRef.current) {\n      clearTimeout(typingTimeoutRef.current);\n      typingTimeoutRef.current = null;\n    }\n    setIsTyping(false);\n    sendChatTyping(conversationId, false);\n\n    // Update local message limit tracking\n    if (messageLimitInfo && !messageLimitInfo.isConnected) {\n      setMessageLimitInfo(prev => prev ? {\n        ...prev,\n        messagesSent: prev.messagesSent + 1,\n        messagesRemaining: Math.max(0, prev.messagesRemaining - 1),\n        canSend: prev.messagesRemaining > 1,\n      } : null);\n    }\n\n    // Clear input immediately for better UX\n    const filesToUpload = [...selectedFiles];\n    const audioToUpload = audioBlob;\n    const textToSend = trimmedMessage;\n    const currentReplyTo = replyTo;\n    \n    setMessage('');\n    setSelectedFiles([]);\n    setAudioBlob(null);\n    setRecordingDuration(0);\n    onCancelReply?.();\n    inputRef.current?.focus();\n\n    // Upload and send audio message if exists\n    if (hasAudio && audioToUpload) {\n      const uploadId = `upload-audio-${Date.now()}`;\n      \n      // Add optimistic uploading message\n      setUploadingMessages(prev => [...prev, {\n        id: uploadId,\n        type: 'audio',\n        fileName: 'Voice message',\n        progress: 0,\n      }]);\n\n      try {\n        const audioFile = new globalThis.File([audioToUpload], `voice-${Date.now()}.webm`, { type: 'audio/webm' });\n        \n        const result = await uploadChatMedia(audioFile, 'audio', (progress) => {\n          setUploadingMessages(prev => \n            prev.map(m => m.id === uploadId ? { ...m, progress } : m)\n          );\n        });\n        \n        // Remove uploading message\n        setUploadingMessages(prev => prev.filter(m => m.id !== uploadId));\n        \n        // Send actual message\n        sendChatMessage({\n          conversationId,\n          content: 'üé§ Voice message',\n          contentType: 'audio',\n          mediaUrl: result.mediaUrl,\n          fileName: result.fileName,\n          fileSize: result.fileSize,\n          replyToId: currentReplyTo?.id,\n        });\n        playVoiceSfx();\n      } catch (error) {\n        console.error('Failed to upload audio:', error);\n        setUploadingMessages(prev => prev.filter(m => m.id !== uploadId));\n        alert('Failed to send voice message');\n      }\n    }\n\n    // Upload files in parallel with optimistic UI\n    if (hasFiles) {\n      const uploadPromises = filesToUpload.map(async (filePreview, index) => {\n        const uploadId = `upload-${Date.now()}-${index}`;\n        \n        // Add optimistic uploading message immediately\n        setUploadingMessages(prev => [...prev, {\n          id: uploadId,\n          type: filePreview.type,\n          preview: filePreview.preview,\n          fileName: filePreview.file.name,\n          progress: 0,\n        }]);\n\n        try {\n          const result = await uploadChatMedia(filePreview.file, filePreview.type, (progress) => {\n            setUploadingMessages(prev => \n              prev.map(m => m.id === uploadId ? { ...m, progress } : m)\n            );\n          });\n          \n          // Remove uploading message\n          setUploadingMessages(prev => prev.filter(m => m.id !== uploadId));\n          \n          // Send actual message\n          sendChatMessage({\n            conversationId,\n            content: filePreview.type === 'image' ? 'üì∑ Photo' : \n                     filePreview.type === 'video' ? 'üé• Video' :\n                     filePreview.type === 'document' ? `üìÑ ${filePreview.file.name}` :\n                     `üìé ${filePreview.file.name}`,\n            contentType: filePreview.type,\n            mediaUrl: result.mediaUrl,\n            fileName: result.fileName,\n            fileSize: result.fileSize,\n            replyToId: index === 0 ? currentReplyTo?.id : undefined,\n          });\n          \n          // Clean up preview URL\n          if (filePreview.preview) {\n            URL.revokeObjectURL(filePreview.preview);\n          }\n        } catch (error) {\n          console.error('Failed to upload file:', error);\n          setUploadingMessages(prev => prev.filter(m => m.id !== uploadId));\n          alert(`Failed to send ${filePreview.file.name}`);\n        }\n      });\n\n      // Don't await - let uploads happen in background\n      Promise.all(uploadPromises);\n    }\n\n    // Send text message immediately\n    if (textToSend) {\n      // Create optimistic message for immediate UI feedback\n      if (onOptimisticMessage && currentUserId) {\n        const optimisticMsg: OptimisticMessage = {\n          id: `optimistic-${Date.now()}`,\n          conversationId,\n          senderId: currentUserId,\n          content: textToSend,\n          contentType: 'text',\n          replyToId: currentReplyTo?.id,\n          replyTo: currentReplyTo ? {\n            id: currentReplyTo.id,\n            content: currentReplyTo.content,\n            senderName: currentReplyTo.senderName,\n          } : undefined,\n          status: 'SENDING',\n          createdAt: new Date().toISOString(),\n        };\n        onOptimisticMessage(optimisticMsg);\n      }\n\n      sendChatMessage({\n        conversationId,\n        content: textToSend,\n        contentType: 'text',\n        replyToId: currentReplyTo?.id,\n      });\n\n      if (selectedMessageEffect !== 'none') {\n        triggerMessageEffect(selectedMessageEffect);\n      }\n    }\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSend();\n    }\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    setMessage(e.target.value);\n    handleTyping();\n  };\n\n  const handleEmojiClick = (emoji: string) => {\n    setMessage(prev => prev + emoji);\n    setShowEmoji(false);\n    inputRef.current?.focus();\n  };\n\n  // Quick grammar fix function\n  const handleQuickGrammarFix = async () => {\n    if (!message.trim() || isFixingGrammar) return;\n    \n    setIsFixingGrammar(true);\n    try {\n      const response = await fixGrammar(message);\n      setMessage(response.corrected);\n      inputRef.current?.focus();\n    } catch (error) {\n      console.error('Grammar fix error:', error);\n    } finally {\n      setIsFixingGrammar(false);\n    }\n  };\n\n  const commonEmojis = ['üòÄ', 'üòÇ', '‚ù§Ô∏è', 'üëç', 'üî•', 'üéâ', 'üòä', 'üôè', 'üíØ', '‚ú®', 'üòç', 'ü§î', 'üëÄ', 'üôå', 'üí™'];\n\n  return (\n    <div className=\"relative border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900 p-4\">\n      {/* AI Assistant Panel - positioned at container level for proper width */}\n      <AnimatePresence>\n        {showAIAssistant && otherUserId && (\n          <AIChatAssistant\n            conversationId={conversationId}\n            otherUserId={otherUserId}\n            otherUserName={otherUserName || 'User'}\n            currentMessage={message}\n            lastReceivedMessage={lastReceivedMessage}\n            onSuggestionSelect={(text) => {\n              setMessage(text);\n              setShowAIAssistant(false);\n              inputRef.current?.focus();\n            }}\n            onClose={() => setShowAIAssistant(false)}\n          />\n        )}\n      </AnimatePresence>\n\n      {/* Connection Required Prompt - Shows when message limit reached */}\n      <AnimatePresence>\n        {showConnectionPrompt && messageLimitInfo && !messageLimitInfo.isConnected && !messageLimitInfo.canSend && (\n          <motion.div\n            initial={{ opacity: 0, y: 20, scale: 0.95 }}\n            animate={{ opacity: 1, y: 0, scale: 1 }}\n            exit={{ opacity: 0, y: 20, scale: 0.95 }}\n            className=\"absolute bottom-full left-0 right-0 mb-2 mx-4\"\n          >\n            <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/30 dark:to-indigo-900/30 border border-blue-200 dark:border-blue-700 rounded-xl p-4 shadow-lg\">\n              <div className=\"flex items-start gap-3\">\n                <div className=\"flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-800 flex items-center justify-center\">\n                  <Lock className=\"w-5 h-5 text-blue-600 dark:text-blue-400\" />\n                </div>\n                <div className=\"flex-1 min-w-0\">\n                  <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-1\">\n                    Connect to Continue Messaging\n                  </h4>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-400 mb-3\">\n                    You&apos;ve sent {messageLimitInfo.messagesSent} of {messageLimitInfo.limit} messages. \n                    Connect with <span className=\"font-medium\">{otherUserName || 'this user'}</span> to send unlimited messages.\n                  </p>\n                  \n                  <div className=\"flex items-center gap-2\">\n                    {connectionRequestSent ? (\n                      <div className=\"flex items-center gap-2 text-sm text-green-600 dark:text-green-400\">\n                        <div className=\"w-5 h-5 rounded-full bg-green-100 dark:bg-green-800 flex items-center justify-center\">\n                          <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                            <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\n                          </svg>\n                        </div>\n                        <span className=\"font-medium\">Connection request sent!</span>\n                      </div>\n                    ) : (\n                      <button\n                        onClick={handleSendConnectionRequest}\n                        disabled={isSendingConnectionRequest}\n                        className=\"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white text-sm font-medium rounded-lg transition-colors\"\n                      >\n                        {isSendingConnectionRequest ? (\n                          <>\n                            <Loader2 className=\"w-4 h-4 animate-spin\" />\n                            Sending...\n                          </>\n                        ) : (\n                          <>\n                            <UserPlus className=\"w-4 h-4\" />\n                            Send Connection Request\n                          </>\n                        )}\n                      </button>\n                    )}\n                    \n                    <button\n                      onClick={() => setShowConnectionPrompt(false)}\n                      className=\"px-3 py-2 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors\"\n                    >\n                      Dismiss\n                    </button>\n                  </div>\n                </div>\n                \n                <button\n                  onClick={() => setShowConnectionPrompt(false)}\n                  className=\"flex-shrink-0 p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors\"\n                >\n                  <X className=\"w-4 h-4\" />\n                </button>\n              </div>\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Message Limit Warning Banner - Shows when approaching limit */}\n      <AnimatePresence>\n        {messageLimitInfo && !messageLimitInfo.isConnected && messageLimitInfo.canSend && messageLimitInfo.messagesRemaining === 1 && (\n          <motion.div\n            initial={{ opacity: 0, height: 0 }}\n            animate={{ opacity: 1, height: 'auto' }}\n            exit={{ opacity: 0, height: 0 }}\n            className=\"mb-3 overflow-hidden\"\n          >\n            <div className=\"flex items-center gap-2 px-3 py-2 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-700 rounded-lg\">\n              <MessageCircle className=\"w-4 h-4 text-amber-600 dark:text-amber-400 flex-shrink-0\" />\n              <p className=\"text-xs text-amber-700 dark:text-amber-300\">\n                <span className=\"font-medium\">Last message!</span> Connect with {otherUserName || 'this user'} to continue the conversation.\n              </p>\n              <button\n                onClick={handleSendConnectionRequest}\n                disabled={isSendingConnectionRequest || connectionRequestSent}\n                className=\"ml-auto text-xs font-medium text-amber-700 dark:text-amber-300 hover:text-amber-800 dark:hover:text-amber-200 underline disabled:opacity-50\"\n              >\n                {connectionRequestSent ? 'Request Sent' : 'Connect'}\n              </button>\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* File input (hidden) */}\n      <input\n        ref={fileInputRef}\n        type=\"file\"\n        multiple\n        onChange={handleFileSelect}\n        className=\"hidden\"\n      />\n\n      {/* File previews */}\n      <AnimatePresence>\n        {selectedFiles.length > 0 && (\n          <motion.div\n            initial={{ height: 0, opacity: 0 }}\n            animate={{ height: 'auto', opacity: 1 }}\n            exit={{ height: 0, opacity: 0 }}\n            className=\"mb-3 overflow-hidden\"\n          >\n            <div className=\"flex gap-2 overflow-x-auto py-2\">\n              {selectedFiles.map((file, index) => (\n                <div\n                  key={index}\n                  className=\"relative flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-800 border border-gray-200 dark:border-gray-700\"\n                >\n                  {file.type === 'image' ? (\n                    <img\n                      src={file.preview}\n                      alt={file.file.name}\n                      className=\"w-full h-full object-cover\"\n                    />\n                  ) : (\n                    <div className=\"w-full h-full flex flex-col items-center justify-center p-1\">\n                      {file.type === 'video' && <Video className=\"w-6 h-6 text-gray-500\" />}\n                      {file.type === 'document' && <FileText className=\"w-6 h-6 text-gray-500\" />}\n                      {file.type === 'audio' && <Mic className=\"w-6 h-6 text-gray-500\" />}\n                      <span className=\"text-[10px] text-gray-500 truncate w-full text-center mt-1\">\n                        {file.file.name.slice(0, 10)}...\n                      </span>\n                    </div>\n                  )}\n                  <button\n                    onClick={() => removeFile(index)}\n                    className=\"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600\"\n                  >\n                    <X className=\"w-3 h-3\" />\n                  </button>\n                </div>\n              ))}\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Reply preview */}\n      {replyTo && (\n        <div className=\"flex items-center justify-between mb-2 p-2 bg-gray-100 dark:bg-gray-800 rounded-lg\">\n          <div className=\"flex items-center gap-2 min-w-0\">\n            <div className=\"w-1 h-8 bg-blue-500 rounded-full\" />\n            <div className=\"min-w-0\">\n              <p className=\"text-xs text-blue-600 dark:text-blue-400 font-medium\">\n                Replying to {replyTo.senderName}\n              </p>\n              <p className=\"text-sm text-gray-600 dark:text-gray-400 truncate\">\n                {replyTo.content}\n              </p>\n            </div>\n          </div>\n          <button\n            onClick={onCancelReply}\n            className=\"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded\"\n          >\n            <X className=\"w-4 h-4\" />\n          </button>\n        </div>\n      )}\n\n      {/* Input area */}\n      <div className=\"flex items-end gap-2\">\n        {/* Attachment button with menu */}\n        <div className=\"relative\" ref={attachMenuRef}>\n          <button\n            onClick={() => setShowAttachMenu(!showAttachMenu)}\n            className={cn(\n              \"p-2 rounded-full transition-colors\",\n              showAttachMenu \n                ? \"bg-blue-100 dark:bg-blue-900/30 text-blue-600\" \n                : \"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800\"\n            )}\n            title=\"Attach file\"\n          >\n            <Paperclip className=\"w-5 h-5\" />\n          </button>\n\n          {/* Attachment menu */}\n          <AnimatePresence>\n            {showAttachMenu && (\n              <motion.div\n                initial={{ opacity: 0, y: 10, scale: 0.95 }}\n                animate={{ opacity: 1, y: 0, scale: 1 }}\n                exit={{ opacity: 0, y: 10, scale: 0.95 }}\n                className=\"absolute bottom-full left-0 mb-2 w-48 bg-white dark:bg-gray-800 shadow-xl rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden z-20\"\n              >\n                <div className=\"p-2 space-y-1\">\n                  <button\n                    onClick={() => openFilePicker('image/*')}\n                    className=\"w-full flex items-center gap-3 px-3 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors\"\n                  >\n                    <div className=\"w-8 h-8 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center\">\n                      <ImageIcon className=\"w-4 h-4 text-purple-600\" />\n                    </div>\n                    <span>Photos</span>\n                  </button>\n                  \n                  <button\n                    onClick={() => openFilePicker('video/*')}\n                    className=\"w-full flex items-center gap-3 px-3 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors\"\n                  >\n                    <div className=\"w-8 h-8 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center\">\n                      <Video className=\"w-4 h-4 text-red-600\" />\n                    </div>\n                    <span>Videos</span>\n                  </button>\n                  \n                  <button\n                    onClick={() => openFilePicker('.pdf,.doc,.docx')}\n                    className=\"w-full flex items-center gap-3 px-3 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors\"\n                  >\n                    <div className=\"w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center\">\n                      <FileText className=\"w-4 h-4 text-blue-600\" />\n                    </div>\n                    <span>Documents</span>\n                  </button>\n                  \n                  <button\n                    onClick={() => {\n                      setShowAttachMenu(false);\n                      startRecording();\n                    }}\n                    className=\"w-full flex items-center gap-3 px-3 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors\"\n                  >\n                    <div className=\"w-8 h-8 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center\">\n                      <Mic className=\"w-4 h-4 text-orange-600\" />\n                    </div>\n                    <span>Voice Mail</span>\n                  </button>\n                </div>\n              </motion.div>\n            )}\n          </AnimatePresence>\n        </div>\n\n        {/* AI Assistant button */}\n        {otherUserId && (\n          <button\n            onClick={() => {\n              setShowAIAssistant(!showAIAssistant);\n              setShowEmoji(false);\n              setShowAttachMenu(false);\n            }}\n            className={cn(\n              \"p-2 rounded-full transition-colors\",\n              showAIAssistant\n                ? \"bg-gradient-to-br from-purple-100 to-blue-100 dark:from-purple-900/30 dark:to-blue-900/30 text-purple-600\"\n                : \"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800\"\n            )}\n            title=\"AI Assistant\"\n          >\n            <Sparkles className=\"w-5 h-5\" />\n          </button>\n        )}\n\n        {/* Message effect toggle (premium packs) */}\n        {availableMessageEffects.length > 0 && (\n          <button\n            onClick={cycleMessageEffect}\n            className={cn(\n              \"p-2 rounded-full transition-colors relative\",\n              selectedMessageEffect !== 'none'\n                ? \"bg-orange-100 dark:bg-orange-900/30 text-orange-600\"\n                : \"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800\"\n            )}\n            title={\n              selectedMessageEffect === 'none'\n                ? 'Message effect: Off (tap to cycle)'\n                : `Message effect: ${selectedMessageEffect} (tap to cycle)`\n            }\n          >\n            <Zap className=\"w-5 h-5\" />\n            {selectedMessageEffect !== 'none' && (\n              <span className=\"absolute -bottom-1.5 left-1/2 -translate-x-1/2 px-1 py-0.5 rounded bg-orange-600 text-white text-[9px] leading-none uppercase tracking-wide\">\n                {selectedMessageEffect === 'confetti' ? 'C' : 'F'}\n              </span>\n            )}\n          </button>\n        )}\n\n        {/* Emoji button */}\n        <div className=\"relative\">\n          <button\n            onClick={() => setShowEmoji(!showEmoji)}\n            className={cn(\n              \"p-2 rounded-full transition-colors\",\n              showEmoji\n                ? \"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-600\"\n                : \"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800\"\n            )}\n            title=\"Add emoji\"\n          >\n            <Smile className=\"w-5 h-5\" />\n          </button>\n\n          {/* Emoji picker */}\n          <AnimatePresence>\n            {showEmoji && (\n              <motion.div\n                initial={{ opacity: 0, y: 10, scale: 0.95 }}\n                animate={{ opacity: 1, y: 0, scale: 1 }}\n                exit={{ opacity: 0, y: 10, scale: 0.95 }}\n                className=\"absolute bottom-full left-0 mb-2 p-3 bg-white dark:bg-gray-800 shadow-xl rounded-xl border border-gray-200 dark:border-gray-700 z-20\"\n              >\n                <div className=\"grid grid-cols-5 gap-1 w-[200px]\">\n                  {commonEmojis.map(emoji => (\n                    <button\n                      key={emoji}\n                      onClick={() => handleEmojiClick(emoji)}\n                      className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg text-xl transition-transform hover:scale-110\"\n                    >\n                      {emoji}\n                    </button>\n                  ))}\n                </div>\n              </motion.div>\n            )}\n          </AnimatePresence>\n        </div>\n\n        {/* Voice Recording UI */}\n        {isRecording ? (\n          <div className=\"flex-1 flex items-center gap-3 px-4 py-2.5 bg-red-50 dark:bg-red-900/20 rounded-2xl\">\n            <div className=\"w-3 h-3 bg-red-500 rounded-full animate-pulse\" />\n            <span className=\"text-red-600 dark:text-red-400 font-medium\">\n              {formatDuration(recordingDuration)}\n            </span>\n            <span className=\"text-sm text-gray-500 flex-1\">Recording...</span>\n            <button\n              onClick={cancelRecording}\n              className=\"p-2 text-gray-500 hover:text-red-500 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-full transition-colors\"\n              title=\"Cancel\"\n            >\n              <Trash2 className=\"w-5 h-5\" />\n            </button>\n            <button\n              onClick={stopRecording}\n              className=\"p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors\"\n              title=\"Stop recording\"\n            >\n              <Square className=\"w-4 h-4\" />\n            </button>\n          </div>\n        ) : audioBlob ? (\n          <div className=\"flex-1 flex items-center gap-3 px-4 py-2.5 bg-green-50 dark:bg-green-900/20 rounded-2xl\">\n            <Mic className=\"w-5 h-5 text-green-600\" />\n            <span className=\"text-sm text-green-700 dark:text-green-400 flex-1\">\n              Voice message ({formatDuration(recordingDuration)})\n            </span>\n            <button\n              onClick={() => { setAudioBlob(null); setRecordingDuration(0); }}\n              className=\"p-1.5 text-gray-500 hover:text-red-500 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-full transition-colors\"\n              title=\"Delete recording\"\n            >\n              <X className=\"w-4 h-4\" />\n            </button>\n          </div>\n        ) : (\n          /* Text input */\n          <div className=\"flex-1 relative\">\n            <textarea\n              ref={inputRef}\n              value={message}\n              onChange={handleChange}\n              onKeyDown={handleKeyDown}\n              placeholder=\"Type a message...\"\n              disabled={disabled}\n              rows={1}\n              className={cn(\n                'w-full resize-none rounded-2xl px-4 py-2.5',\n                'bg-gray-100 dark:bg-gray-800',\n                'border border-transparent focus:border-blue-500',\n                'focus:outline-none focus:ring-2 focus:ring-blue-500/20',\n                'text-gray-900 dark:text-white placeholder-gray-500',\n                'disabled:opacity-50 disabled:cursor-not-allowed',\n                'max-h-32'\n              )}\n            />\n          </div>\n        )}\n\n        {/* Mic button (show when no text/files) or Grammar Fix + Send buttons */}\n        {!message.trim() && selectedFiles.length === 0 && !audioBlob && !isRecording ? (\n          <button\n            onClick={startRecording}\n            disabled={disabled}\n            className={cn(\n              'p-3 rounded-full transition-all',\n              'bg-gray-200 dark:bg-gray-700 text-gray-500 hover:bg-gray-300 dark:hover:bg-gray-600',\n              'disabled:opacity-50 disabled:cursor-not-allowed'\n            )}\n            title=\"Record voice message\"\n          >\n            <Mic className=\"w-5 h-5\" />\n          </button>\n        ) : (\n          <>\n            {/* Grammar Fix button - shows when there's text */}\n            {message.trim() && otherUserId && (\n              <button\n                onClick={handleQuickGrammarFix}\n                disabled={isFixingGrammar || disabled}\n                className={cn(\n                  'p-3 rounded-full transition-all',\n                  'bg-purple-100 dark:bg-purple-900/30 text-purple-600 hover:bg-purple-200 dark:hover:bg-purple-800/40',\n                  'disabled:opacity-50 disabled:cursor-not-allowed'\n                )}\n                title=\"Fix grammar with AI\"\n              >\n                {isFixingGrammar ? (\n                  <Loader2 className=\"w-5 h-5 animate-spin\" />\n                ) : (\n                  <Pencil className=\"w-5 h-5\" />\n                )}\n              </button>\n            )}\n\n            {/* Send button */}\n            <button\n              onClick={handleSend}\n              disabled={(!message.trim() && selectedFiles.length === 0 && !audioBlob) || disabled || isRecording}\n              className={cn(\n                'p-3 rounded-full transition-all',\n                (message.trim() || selectedFiles.length > 0 || audioBlob)\n                  ? 'bg-blue-600 text-white hover:bg-blue-700 scale-100'\n                  : 'bg-gray-200 dark:bg-gray-700 text-gray-400 scale-95',\n                'disabled:opacity-50 disabled:cursor-not-allowed'\n              )}\n            >\n              <Send className=\"w-5 h-5\" />\n            </button>\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":["React","useState","useRef","useEffect","useCallback","useMemo","sendChatMessage","sendChatTyping","uploadChatMedia","getMessageLimitStatus","MessageLimitStatus","sendConnectionRequest","cn","motion","AnimatePresence","Paperclip","Image","ImageIcon","FileText","Video","Mic","X","Send","Smile","File","Square","Trash2","Sparkles","Pencil","Loader2","UserPlus","Lock","MessageCircle","Zap","AIChatAssistant","fixGrammar","ALLOWED_FILE_TYPES","image","video","document","audio","MAX_FILE_SIZE","MAX_VIDEO_DURATION","UploadingMessage","id","type","preview","fileName","progress","OptimisticMessage","conversationId","senderId","content","contentType","mediaUrl","fileSize","replyToId","replyTo","senderName","status","createdAt","ChatInputProps","currentUserId","onCancelReply","disabled","onUploadingMessagesChange","messages","onOptimisticMessage","message","otherUserId","otherUserName","lastReceivedMessage","enabledMessageEffects","confetti","fireworks","voiceSfx","FilePreview","file","ChatInput","setMessage","isTyping","setIsTyping","showEmoji","setShowEmoji","showAttachMenu","setShowAttachMenu","showAIAssistant","setShowAIAssistant","isFixingGrammar","setIsFixingGrammar","selectedFiles","setSelectedFiles","isRecording","setIsRecording","recordingDuration","setRecordingDuration","audioBlob","setAudioBlob","Blob","uploadingMessages","setUploadingMessages","messageLimitInfo","setMessageLimitInfo","showConnectionPrompt","setShowConnectionPrompt","isSendingConnectionRequest","setIsSendingConnectionRequest","connectionRequestSent","setConnectionRequestSent","selectedMessageEffect","setSelectedMessageEffect","inputRef","HTMLTextAreaElement","fileInputRef","HTMLInputElement","typingTimeoutRef","NodeJS","Timeout","attachMenuRef","HTMLDivElement","mediaRecorderRef","MediaRecorder","audioChunksRef","recordingIntervalRef","checkMessageLimit","limitStatus","isConnected","canSend","error","console","availableMessageEffects","Array","const","includes","cycleMessageEffect","cycle","length","currentIndex","indexOf","nextIndex","triggerMessageEffect","effect","default","particleCount","spread","origin","y","colors","x","playVoiceSfx","window","AudioContextClass","AudioContext","Window","webkitAudioContext","audioContext","oscillator","createOscillator","gainNode","createGain","frequency","setValueAtTime","currentTime","exponentialRampToValueAtTime","gain","connect","destination","start","stop","handleSendConnectionRequest","errorMessage","Error","alert","current","style","height","Math","min","scrollHeight","handleClickOutside","event","MouseEvent","contains","target","Node","addEventListener","removeEventListener","handleTyping","clearTimeout","setTimeout","getFileType","mimes","Object","entries","checkVideoDuration","Promise","resolve","createElement","preload","onloadedmetadata","URL","revokeObjectURL","src","duration","name","onerror","createObjectURL","handleFileSelect","e","ChangeEvent","files","from","validFiles","size","fileType","isValidDuration","push","prev","value","removeFile","index","newFiles","splice","openFilePicker","accept","click","startRecording","stream","navigator","mediaDevices","getUserMedia","mediaRecorder","mimeType","ondataavailable","data","onstop","getTracks","forEach","track","setInterval","stopRecording","clearInterval","cancelRecording","formatDuration","seconds","mins","floor","secs","toString","padStart","handleSend","trimmedMessage","trim","hasFiles","hasAudio","messagesSent","messagesRemaining","max","filesToUpload","audioToUpload","textToSend","currentReplyTo","focus","uploadId","Date","now","audioFile","globalThis","result","map","m","filter","uploadPromises","filePreview","undefined","all","optimisticMsg","toISOString","handleKeyDown","KeyboardEvent","key","shiftKey","preventDefault","handleChange","handleEmojiClick","emoji","handleQuickGrammarFix","response","corrected","commonEmojis","text","opacity","scale","limit","slice"],"mappings":"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","ignoreList":[]}},
    {"offset": {"line": 6764, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/lib/api/reports.ts"],"sourcesContent":["import apiClient from './client';\n\nexport interface ReportReason {\n  value: string;\n  label: string;\n  description: string;\n}\n\nexport interface ReportResponse {\n  message: string;\n  reportId: string;\n}\n\nexport interface MyReport {\n  id: string;\n  reportType: 'POST' | 'CHAT' | 'USER' | 'COMMENT' | 'GROUP';\n  reason: string;\n  description: string | null;\n  status: 'PENDING' | 'UNDER_REVIEW' | 'RESOLVED' | 'DISMISSED';\n  actionTaken: string;\n  createdAt: string;\n  reviewedAt: string | null;\n  post: {\n    id: string;\n    content: string;\n    type: string;\n  } | null;\n  reportedUser: {\n    id: string;\n    name: string;\n    username: string;\n    profileImage: string | null;\n  } | null;\n}\n\nexport interface ReportRequest {\n  reason: string;\n  description?: string;\n}\n\nexport interface ChatReportRequest extends ReportRequest {\n  reportedUserId: string;\n}\n\nexport const reportAPI = {\n  // Get available report reasons\n  getReasons: async (): Promise<{ reasons: ReportReason[] }> => {\n    return apiClient.get('/reports/reasons');\n  },\n\n  // Report a post\n  reportPost: async (postId: string, data: ReportRequest): Promise<ReportResponse> => {\n    return apiClient.post(`/reports/post/${postId}`, data);\n  },\n\n  // Report a comment\n  reportComment: async (commentId: string, data: ReportRequest): Promise<ReportResponse> => {\n    return apiClient.post(`/reports/comment/${commentId}`, data);\n  },\n\n  // Report a user in chat\n  reportChatUser: async (conversationId: string, data: ChatReportRequest): Promise<ReportResponse> => {\n    return apiClient.post(`/reports/chat/${conversationId}`, data);\n  },\n\n  // Report a user profile\n  reportUser: async (userId: string, data: ReportRequest): Promise<ReportResponse> => {\n    return apiClient.post(`/reports/user/${userId}`, data);\n  },\n\n  // Report a group\n  reportGroup: async (groupId: string, data: ReportRequest): Promise<ReportResponse> => {\n    return apiClient.post(`/reports/group/${groupId}`, data);\n  },\n\n  // Get user's own reports\n  getMyReports: async (page = 1, limit = 10): Promise<{\n    reports: MyReport[];\n    pagination: {\n      page: number;\n      limit: number;\n      total: number;\n      totalPages: number;\n    };\n  }> => {\n    return apiClient.get(`/reports/my-reports?page=${page}&limit=${limit}`);\n  },\n};\n"],"names":[],"mappings":";;;;AAAA;;AA4CO,MAAM,YAAY;IACvB,+BAA+B;IAC/B,YAAY;QACV,OAAO,yIAAS,CAAC,GAAG,CAAC;IACvB;IAEA,gBAAgB;IAChB,YAAY,OAAO,QAAgB;QACjC,OAAO,yIAAS,CAAC,IAAI,CAAC,CAAC,cAAc,EAAE,QAAQ,EAAE;IACnD;IAEA,mBAAmB;IACnB,eAAe,OAAO,WAAmB;QACvC,OAAO,yIAAS,CAAC,IAAI,CAAC,CAAC,iBAAiB,EAAE,WAAW,EAAE;IACzD;IAEA,wBAAwB;IACxB,gBAAgB,OAAO,gBAAwB;QAC7C,OAAO,yIAAS,CAAC,IAAI,CAAC,CAAC,cAAc,EAAE,gBAAgB,EAAE;IAC3D;IAEA,wBAAwB;IACxB,YAAY,OAAO,QAAgB;QACjC,OAAO,yIAAS,CAAC,IAAI,CAAC,CAAC,cAAc,EAAE,QAAQ,EAAE;IACnD;IAEA,iBAAiB;IACjB,aAAa,OAAO,SAAiB;QACnC,OAAO,yIAAS,CAAC,IAAI,CAAC,CAAC,eAAe,EAAE,SAAS,EAAE;IACrD;IAEA,yBAAyB;IACzB,cAAc,OAAO,OAAO,CAAC,EAAE,QAAQ,EAAE;QASvC,OAAO,yIAAS,CAAC,GAAG,CAAC,CAAC,yBAAyB,EAAE,KAAK,OAAO,EAAE,OAAO;IACxE;AACF"}},
    {"offset": {"line": 6807, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/reports/ReportModal.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { X, Flag, AlertTriangle, Loader2, CheckCircle } from 'lucide-react';\nimport { reportAPI, ReportReason } from '@/lib/api/reports';\nimport { motion, AnimatePresence } from 'framer-motion';\n\ninterface ReportModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  type: 'post' | 'comment' | 'user' | 'group' | 'chat';\n  targetId: string;\n  targetName?: string;\n  conversationId?: string; // For chat reports\n  reportedUserId?: string; // For chat reports\n}\n\nexport default function ReportModal({\n  isOpen,\n  onClose,\n  type,\n  targetId,\n  targetName,\n  conversationId,\n  reportedUserId,\n}: ReportModalProps) {\n  const [reasons, setReasons] = useState<ReportReason[]>([]);\n  const [selectedReason, setSelectedReason] = useState('');\n  const [description, setDescription] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [fetchingReasons, setFetchingReasons] = useState(true);\n  const [success, setSuccess] = useState(false);\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    const fetchReasons = async () => {\n      try {\n        const response = await reportAPI.getReasons();\n        setReasons(response.reasons);\n      } catch (err) {\n        console.error('Failed to fetch report reasons:', err);\n      } finally {\n        setFetchingReasons(false);\n      }\n    };\n\n    if (isOpen) {\n      fetchReasons();\n      // Reset state\n      setSelectedReason('');\n      setDescription('');\n      setSuccess(false);\n      setError('');\n    }\n  }, [isOpen]);\n\n  const handleSubmit = async () => {\n    if (!selectedReason) {\n      setError('Please select a reason');\n      return;\n    }\n\n    setLoading(true);\n    setError('');\n\n    try {\n      const data = {\n        reason: selectedReason,\n        description: description.trim() || undefined,\n      };\n\n      switch (type) {\n        case 'post':\n          await reportAPI.reportPost(targetId, data);\n          break;\n        case 'comment':\n          await reportAPI.reportComment(targetId, data);\n          break;\n        case 'user':\n          await reportAPI.reportUser(targetId, data);\n          break;\n        case 'group':\n          await reportAPI.reportGroup(targetId, data);\n          break;\n        case 'chat':\n          if (!conversationId || !reportedUserId) {\n            throw new Error('Missing conversation or user info');\n          }\n          await reportAPI.reportChatUser(conversationId, {\n            ...data,\n            reportedUserId,\n          });\n          break;\n      }\n\n      setSuccess(true);\n      setTimeout(() => {\n        onClose();\n      }, 2000);\n    } catch (err: any) {\n      setError(err.response?.data?.error || 'Failed to submit report');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getTitle = () => {\n    switch (type) {\n      case 'post':\n        return 'Report Post';\n      case 'comment':\n        return 'Report Comment';\n      case 'user':\n        return `Report ${targetName || 'User'}`;\n      case 'group':\n        return 'Report Group';\n      case 'chat':\n        return `Report ${targetName || 'User'}`;\n      default:\n        return 'Report';\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <AnimatePresence>\n      <div className=\"fixed inset-0 z-50 flex items-center justify-center\">\n        {/* Backdrop */}\n        <motion.div\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          exit={{ opacity: 0 }}\n          className=\"absolute inset-0 bg-black/50 backdrop-blur-sm\"\n          onClick={onClose}\n        />\n\n        {/* Modal */}\n        <motion.div\n          initial={{ opacity: 0, scale: 0.95 }}\n          animate={{ opacity: 1, scale: 1 }}\n          exit={{ opacity: 0, scale: 0.95 }}\n          className=\"relative w-full max-w-md mx-4 bg-white dark:bg-gray-900 rounded-2xl shadow-xl overflow-hidden\"\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 bg-red-100 dark:bg-red-900/30 rounded-full\">\n                <Flag className=\"w-5 h-5 text-red-600 dark:text-red-400\" />\n              </div>\n              <h2 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                {getTitle()}\n              </h2>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors\"\n            >\n              <X className=\"w-5 h-5 text-gray-500\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"p-6\">\n            {success ? (\n              <div className=\"text-center py-8\">\n                <div className=\"mx-auto w-16 h-16 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mb-4\">\n                  <CheckCircle className=\"w-8 h-8 text-green-600 dark:text-green-400\" />\n                </div>\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\n                  Report Submitted\n                </h3>\n                <p className=\"text-gray-600 dark:text-gray-400\">\n                  Thank you for helping keep our community safe. We'll review your report shortly.\n                </p>\n              </div>\n            ) : fetchingReasons ? (\n              <div className=\"flex items-center justify-center py-8\">\n                <Loader2 className=\"w-8 h-8 animate-spin text-blue-600\" />\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                  Why are you reporting this {type}? Your report will be reviewed by our team.\n                </p>\n\n                {/* Reason Selection */}\n                <div className=\"space-y-2\">\n                  <label className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Select a reason <span className=\"text-red-500\">*</span>\n                  </label>\n                  <div className=\"space-y-2 max-h-60 overflow-y-auto\">\n                    {reasons.map((reason) => (\n                      <label\n                        key={reason.value}\n                        className={`flex items-start gap-3 p-3 rounded-lg border cursor-pointer transition-all ${\n                          selectedReason === reason.value\n                            ? 'border-blue-500 bg-blue-50 dark:bg-blue-900/20'\n                            : 'border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600'\n                        }`}\n                      >\n                        <input\n                          type=\"radio\"\n                          name=\"reason\"\n                          value={reason.value}\n                          checked={selectedReason === reason.value}\n                          onChange={(e) => setSelectedReason(e.target.value)}\n                          className=\"mt-1 text-blue-600 focus:ring-blue-500\"\n                        />\n                        <div>\n                          <span className=\"font-medium text-gray-900 dark:text-white\">\n                            {reason.label}\n                          </span>\n                          <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-0.5\">\n                            {reason.description}\n                          </p>\n                        </div>\n                      </label>\n                    ))}\n                  </div>\n                </div>\n\n                {/* Additional Details */}\n                <div className=\"space-y-2\">\n                  <label className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Additional details (optional)\n                  </label>\n                  <textarea\n                    value={description}\n                    onChange={(e) => setDescription(e.target.value)}\n                    placeholder=\"Provide any additional context that might help us review this report...\"\n                    rows={3}\n                    maxLength={500}\n                    className=\"w-full px-4 py-3 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\"\n                  />\n                  <p className=\"text-xs text-gray-400 text-right\">\n                    {description.length}/500\n                  </p>\n                </div>\n\n                {/* Error */}\n                {error && (\n                  <div className=\"flex items-center gap-2 p-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded-lg text-sm\">\n                    <AlertTriangle className=\"w-4 h-4 flex-shrink-0\" />\n                    {error}\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n\n          {/* Footer */}\n          {!success && (\n            <div className=\"flex items-center justify-end gap-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50\">\n              <button\n                onClick={onClose}\n                className=\"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleSubmit}\n                disabled={loading || !selectedReason}\n                className=\"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2\"\n              >\n                {loading ? (\n                  <>\n                    <Loader2 className=\"w-4 h-4 animate-spin\" />\n                    Submitting...\n                  </>\n                ) : (\n                  <>\n                    <Flag className=\"w-4 h-4\" />\n                    Submit Report\n                  </>\n                )}\n              </button>\n            </div>\n          )}\n        </motion.div>\n      </div>\n    </AnimatePresence>\n  );\n}\n"],"names":["useState","useEffect","X","Flag","AlertTriangle","Loader2","CheckCircle","reportAPI","ReportReason","motion","AnimatePresence","ReportModalProps","isOpen","onClose","type","targetId","targetName","conversationId","reportedUserId","ReportModal","reasons","setReasons","selectedReason","setSelectedReason","description","setDescription","loading","setLoading","fetchingReasons","setFetchingReasons","success","setSuccess","error","setError","fetchReasons","response","getReasons","err","console","handleSubmit","data","reason","trim","undefined","reportPost","reportComment","reportUser","reportGroup","Error","reportChatUser","setTimeout","getTitle","opacity","scale","map","value","e","target","label","length"],"mappings":";;;;;AAEA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;;;;AAC3C,SAASC,CAAC,EAAEC,IAAI,EAAEC,aAAa,EAAEC,OAAO,EAAEC,WAAW,QAAQ,cAAc;;AAC3E,SAASC,SAAS,EAAEC,YAAY,QAAQ,mBAAmB;;AAC3D,SAASC,MAAM,EAAEC,eAAe,QAAQ,eAAe;;;AALvD,YAAY;;;;;AAiBG,qBAAqB,EAClCE,MAAM,EACNC,OAAO,EACPC,IAAI,EACJC,QAAQ,EACRC,UAAU,EACVC,cAAc,EACdC,cAAAA,EACiB,EAAE;;IACnB,MAAM,CAACE,OAAO,EAAEC,UAAU,CAAC,OAAGrB,yKAAQ,CAACQ,CAAgB,EAAE,CAAC,QAAP,EAAE,CAAC;IACtD,MAAM,CAACc,cAAc,EAAEC,iBAAiB,CAAC,OAAGvB,yKAAQ,EAAC,EAAE,CAAC;IACxD,MAAM,CAACwB,WAAW,EAAEC,cAAc,CAAC,OAAGzB,yKAAQ,EAAC,EAAE,CAAC;IAClD,MAAM,CAAC0B,OAAO,EAAEC,UAAU,CAAC,OAAG3B,yKAAQ,EAAC,KAAK,CAAC;IAC7C,MAAM,CAAC4B,eAAe,EAAEC,kBAAkB,CAAC,OAAG7B,yKAAQ,EAAC,IAAI,CAAC;IAC5D,MAAM,CAAC8B,OAAO,EAAEC,UAAU,CAAC,OAAG/B,yKAAQ,EAAC,KAAK,CAAC;IAC7C,MAAM,CAACgC,KAAK,EAAEC,QAAQ,CAAC,GAAGjC,6KAAQ,EAAC,EAAE,CAAC;QAEtCC,0KAAS;iCAAC,MAAM;YACd,MAAMiC,YAAY;sDAAG,MAAAA,CAAA,KAAY;oBAC/B,IAAI;wBACF,MAAMC,QAAQ,GAAG,MAAM5B,4IAAS,CAAC6B,UAAU,CAAC,CAAC;wBAC7Cf,UAAU,CAACc,QAAQ,CAACf,OAAO,CAAC;oBAC9B,CAAC,CAAC,OAAOiB,GAAG,EAAE;wBACZC,OAAO,CAACN,KAAK,CAAC,iCAAiC,EAAEK,GAAG,CAAC;oBACvD,CAAC,QAAS;wBACRR,kBAAkB,CAAC,KAAK,CAAC;oBAC3B;gBACF,CAAC;;YAED,IAAIjB,MAAM,EAAE;gBACVsB,YAAY,CAAC,CAAC;gBACd,cAAA;gBACAX,iBAAiB,CAAC,EAAE,CAAC;gBACrBE,cAAc,CAAC,EAAE,CAAC;gBAClBM,UAAU,CAAC,KAAK,CAAC;gBACjBE,QAAQ,CAAC,EAAE,CAAC;YACd;QACF,CAAC;gCAAE;QAACrB,MAAM;KAAC,CAAC;IAEZ,MAAM2B,YAAY,GAAG,MAAAA,CAAA,KAAY;QAC/B,IAAI,CAACjB,cAAc,EAAE;YACnBW,QAAQ,CAAC,wBAAwB,CAAC;YAClC;QACF;QAEAN,UAAU,CAAC,IAAI,CAAC;QAChBM,QAAQ,CAAC,EAAE,CAAC;QAEZ,IAAI;YACF,MAAMO,IAAI,GAAG;gBACXC,MAAM,EAAEnB,cAAc;gBACtBE,WAAW,EAAEA,WAAW,CAACkB,IAAI,CAAC,CAAC,IAAIC;YACrC,CAAC;YAED,OAAQ7B,IAAI;gBACV,KAAK,MAAM;oBACT,MAAMP,4IAAS,CAACqC,UAAU,CAAC7B,QAAQ,EAAEyB,IAAI,CAAC;oBAC1C;gBACF,KAAK,SAAS;oBACZ,MAAMjC,4IAAS,CAACsC,aAAa,CAAC9B,QAAQ,EAAEyB,IAAI,CAAC;oBAC7C;gBACF,KAAK,MAAM;oBACT,MAAMjC,4IAAS,CAACuC,UAAU,CAAC/B,QAAQ,EAAEyB,IAAI,CAAC;oBAC1C;gBACF,KAAK,OAAO;oBACV,MAAMjC,4IAAS,CAACwC,WAAW,CAAChC,QAAQ,EAAEyB,IAAI,CAAC;oBAC3C;gBACF,KAAK,MAAM;oBACT,IAAI,CAACvB,cAAc,IAAI,CAACC,cAAc,EAAE;wBACtC,MAAM,IAAI8B,KAAK,CAAC,mCAAmC,CAAC;oBACtD;oBACA,MAAMzC,4IAAS,CAAC0C,cAAc,CAAChC,cAAc,EAAE;wBAC7C,GAAGuB,IAAI;wBACPtB;oBACF,CAAC,CAAC;oBACF;YACJ;YAEAa,UAAU,CAAC,IAAI,CAAC;YAChBmB,UAAU,CAAC,MAAM;gBACfrC,OAAO,CAAC,CAAC;YACX,CAAC,EAAE,IAAI,CAAC;QACV,CAAC,CAAC,OAAOwB,KAAG,EAAO,AAAL,GAAG;YACfJ,QAAQ,CAACI,KAAG,CAACF,QAAQ,EAAEK,IAAI,EAAER,KAAK,IAAI,yBAAyB,CAAC;QAClE,CAAC,QAAS;YACRL,UAAU,CAAC,KAAK,CAAC;QACnB;IACF,CAAC;IAED,MAAMwB,QAAQ,GAAGA,CAAA,KAAM;QACrB,OAAQrC,IAAI;YACV,KAAK,MAAM;gBACT,OAAO,aAAa;YACtB,KAAK,SAAS;gBACZ,OAAO,gBAAgB;YACzB,KAAK,MAAM;gBACT,OAAO,CAAA,OAAA,EAAUE,UAAU,IAAI,MAAM,EAAE;YACzC,KAAK,OAAO;gBACV,OAAO,cAAc;YACvB,KAAK,MAAM;gBACT,OAAO,CAAA,OAAA,EAAUA,UAAU,IAAI,MAAM,EAAE;YACzC;gBACE,OAAO,QAAQ;QACnB;IACF,CAAC;IAED,IAAI,CAACJ,MAAM,EAAE,OAAO,IAAI;IAExB,qBACE,6LAAC,+MAAe;gCACd,6LAAC,GAAG;YAAC,SAAS,EAAC,qDAAqD;;8BAElE,6LAAC,uMAAM,CAAC,GAAG;oBACT,OAAO,CAAC,CAAC;wBAAEwC,OAAO,EAAE;oBAAE,CAAC,CAAC;oBACxB,OAAO,CAAC,CAAC;wBAAEA,OAAO,EAAE;oBAAE,CAAC,CAAC;oBACxB,IAAI,CAAC,CAAC;wBAAEA,OAAO,EAAE;oBAAE,CAAC,CAAC;oBACrB,SAAS,EAAC,+CAA+C;oBACzD,OAAO,CAAC,CAACvC,OAAO,CAAC;;;;;;8BAInB,6LAAC,uMAAM,CAAC,GAAG;oBACT,OAAO,CAAC,CAAC;wBAAEuC,OAAO,EAAE,CAAC;wBAAEC,KAAK,EAAE;oBAAK,CAAC,CAAC;oBACrC,OAAO,CAAC,CAAC;wBAAED,OAAO,EAAE,CAAC;wBAAEC,KAAK,EAAE;oBAAE,CAAC,CAAC;oBAClC,IAAI,CAAC,CAAC;wBAAED,OAAO,EAAE,CAAC;wBAAEC,KAAK,EAAE;oBAAK,CAAC,CAAC;oBAClC,SAAS,EAAC,+FAA+F;;sCAGzG,6LAAC,GAAG;4BAAC,SAAS,EAAC,2FAA2F;;8CACxG,6LAAC,GAAG;oCAAC,SAAS,EAAC,yBAAyB;;sDACtC,6LAAC,GAAG;4CAAC,SAAS,EAAC,gDAAgD;oEAC7D,6LAAC,6MAAI;gDAAC,SAAS,EAAC,wCAAwC;;;;;;;;;;;sDAE1D,6LAAC,EAAE;4CAAC,SAAS,EAAC,qDAAqD;sDAChEF,QAAQ,CAAC,CAAC;;;;;;;;;;;;8CAGf,6LAAC,MAAM;oCACL,OAAO,CAAC,CAACtC,OAAO,CAAC;oCACjB,SAAS,EAAC,6EAA6E;4DAEvF,6LAAC,oMAAC;wCAAC,SAAS,EAAC,uBAAuB;;;;;;;;;;;;;;;;;sCAKxC,6LAAC,GAAG;4BAAC,SAAS,EAAC,KAAK;sCACjBiB,OAAO,iBACN,6LAAC,GAAG;gCAAC,SAAS,EAAC,kBAAkB;;kDAC/B,6LAAC,GAAG;wCAAC,SAAS,EAAC,wGAAwG;kDACrH,2MAAC,6OAAW;4CAAC,SAAS,EAAC,4CAA4C;;;;;;;;;;;kDAErE,6LAAC,EAAE;wCAAC,SAAS,EAAC,0DAA0D;kDAAA;;;;;;kDAGxE,6LAAC,CAAC;wCAAC,SAAS,EAAC,kCAAkC;kDAAA;;;;;;;;;;;uCAI/CF,eAAe,iBACjB,6LAAC,GAAG;gCAAC,SAAS,EAAC,uCAAuC;wDACpD,6LAAC,+NAAO;oCAAC,SAAS,EAAC,oCAAoC;;;;;;;;;;qDAGzD,6LAAC,GAAG;gCAAC,SAAS,EAAC,WAAW;;kDACxB,6LAAC,CAAC;wCAAC,SAAS,EAAC,0CAA0C;;4CAAA;4CACzBd,IAAI;4CAAC;;;;;;;kDAInC,6LAAC,GAAG;wCAAC,SAAS,EAAC,WAAW;;0DACxB,6LAAC,KAAK;gDAAC,SAAS,EAAC,sDAAsD;;oDAAA;kEACrD,6LAAC,IAAI;wDAAC,SAAS,EAAC,cAAc;kEAAC,CAAC,EAAE,IAAI;;;;;;;;;;;;0DAExD,6LAAC,GAAG;gDAAC,SAAS,EAAC,oCAAoC;0DAChDM,OAAO,CAACkC,GAAG,EAAEb,MAAM,iBAClB,6LAAC,KAAK,CACJ,GAAG,CAAC;wDACJ,SAAS,CAAC,CAAC,CAAA,2EAAA,EACTnB,cAAc,KAAKmB,MAAM,CAACc,KAAK,GAC3B,gDAAgD,GAChD,uFAAuF,EAC3F,CAAC;;0EAEH,6LAAC,KAAK;gEACJ,IAAI,EAAC,OAAO;gEACZ,IAAI,EAAC,QAAQ;gEACb,KAAK,CAAC,CAACd,MAAM,CAACc,KAAK,CAAC;gEACpB,OAAO,CAAC,CAACjC,cAAc,KAAKmB,MAAM,CAACc,KAAK,CAAC;gEACzC,QAAQ,CAAC,EAAEC,CAAC,GAAKjC,iBAAiB,CAACiC,CAAC,CAACC,MAAM,CAACF,KAAK,CAAC,CAAC;gEACnD,SAAS,EAAC,wCAAwC;;;;;;0EAEpD,6LAAC,GAAG;;kFACF,6LAAC,IAAI;wEAAC,SAAS,EAAC,2CAA2C;kFACxDd,MAAM,CAACiB,KAAK;;;;;;kFAEf,6LAAC,CAAC;wEAAC,SAAS,EAAC,iDAAiD;kFAC3DjB,MAAM,CAACjB,WAAW;;;;;;;;;;;;;uDApBlBiB,MAAM,CAACc,KAAK,CAAC;;;;;;;;;;;;;;;;kDA6B1B,6LAAC,GAAG;wCAAC,SAAS,EAAC,WAAW;;0DACxB,6LAAC,KAAK;gDAAC,SAAS,EAAC,sDAAsD;0DAAA;;;;;;0DAGvE,6LAAC,QAAQ;gDACP,KAAK,CAAC,CAAC/B,WAAW,CAAC;gDACnB,QAAQ,CAAC,EAAEgC,GAAC,GAAK/B,cAAc,CAAC+B,GAAC,CAACC,MAAM,CAACF,KAAK,CAAC,CAAC;gDAChD,WAAW,EAAC,yEAAyE;gDACrF,IAAI,CAAC,CAAC,CAAC,CAAC;gDACR,SAAS,CAAC,CAAC,GAAG,CAAC;gDACf,SAAS,EAAC,4NAA4N;;;;;;0DAExO,6LAAC,CAAC;gDAAC,SAAS,EAAC,kCAAkC;;oDAC5C/B,WAAW,CAACmC,MAAM;oDAAC;;;;;;;;;;;;;oCAKvB3B,KAAK,kBACJ,6LAAC,GAAG;wCAAC,SAAS,EAAC,4GAA4G;;0DACzH,6LAAC,4OAAa;gDAAC,SAAS,EAAC,uBAAuB;;;;;;4CAC/CA,KAAK;;;;;;;;;;;;;;;;;;wBAQf,CAACF,OAAO,kBACP,6LAAC,GAAG;4BAAC,SAAS,EAAC,4HAA4H;;8CACzI,6LAAC,MAAM;oCACL,OAAO,CAAC,CAACjB,OAAO,CAAC;oCACjB,SAAS,EAAC,kHAAkH;8CAAA;;;;;;8CAI9H,6LAAC,MAAM;oCACL,OAAO,CAAC,CAAC0B,YAAY,CAAC;oCACtB,QAAQ,CAAC,CAACb,OAAO,IAAI,CAACJ,cAAc,CAAC;oCACrC,SAAS,EAAC,mKAAmK;8CAE5KI,OAAO,iBACN;;0DACE,6LAAC,+NAAO;gDAAC,SAAS,EAAC,sBAAsB;;;;;;4CAAA;;qEAI3C;;0DACE,6LAAC,6MAAI;gDAAC,SAAS,EAAC,SAAS;;;;;;4CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAW7C;;KA1QwBP,WAAWA","ignoreList":[]}},
    {"offset": {"line": 7310, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/chat/ChatHeader.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport Link from 'next/link';\nimport { formatDistanceToNow } from 'date-fns';\nimport { getSocket } from '@/lib/socket';\nimport { cn } from '@/lib/utils';\nimport ReportModal from '@/components/reports/ReportModal';\nimport { MoreVertical, Flag, UserX, Bell, BellOff } from 'lucide-react';\n\ninterface ChatHeaderProps {\n  user: {\n    id: string;\n    name: string;\n    username: string;\n    profileImage?: string | null;\n    isOnline?: boolean;\n    lastActiveAt?: string | null;\n  };\n  conversationId: string;\n  onBack?: () => void;\n  onInfo?: () => void;\n}\n\nexport default function ChatHeader({ user, conversationId, onBack, onInfo }: ChatHeaderProps) {\n  const [isOnline, setIsOnline] = useState(user.isOnline || false);\n  const [lastActive, setLastActive] = useState(user.lastActiveAt);\n  const [showMenu, setShowMenu] = useState(false);\n  const [showReportModal, setShowReportModal] = useState(false);\n  const menuRef = useRef<HTMLDivElement>(null);\n\n  // Close menu when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\n        setShowMenu(false);\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  // Listen for online/offline status\n  useEffect(() => {\n    const socket = getSocket();\n    if (!socket) return;\n\n    const handleOnline = (data: { userId: string }) => {\n      if (data.userId === user.id) {\n        setIsOnline(true);\n      }\n    };\n\n    const handleOffline = (data: { userId: string }) => {\n      if (data.userId === user.id) {\n        setIsOnline(false);\n        setLastActive(new Date().toISOString());\n      }\n    };\n\n    // Handle immediate status update when joining chat\n    const handleStatus = (data: { userId: string; isOnline: boolean }) => {\n      if (data.userId === user.id) {\n        setIsOnline(data.isOnline);\n        if (!data.isOnline) {\n          setLastActive(new Date().toISOString());\n        }\n      }\n    };\n\n    socket.on('user:online', handleOnline);\n    socket.on('user:offline', handleOffline);\n    socket.on('user:status', handleStatus);\n\n    return () => {\n      socket.off('user:online', handleOnline);\n      socket.off('user:offline', handleOffline);\n      socket.off('user:status', handleStatus);\n    };\n  }, [user.id]);\n\n  // Update initial state when user prop changes\n  useEffect(() => {\n    setIsOnline(user.isOnline || false);\n    setLastActive(user.lastActiveAt);\n  }, [user.isOnline, user.lastActiveAt]);\n\n  return (\n    <div className=\"flex items-center gap-3 p-4 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900\">\n      {/* Back button (mobile) */}\n      {onBack && (\n        <button\n          onClick={onBack}\n          className=\"p-2 -ml-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full md:hidden\"\n        >\n          <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\n          </svg>\n        </button>\n      )}\n\n      {/* Avatar */}\n      <Link href={`/profile/${user.username}`} className=\"relative flex-shrink-0\">\n        <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white font-semibold\">\n          {user.profileImage ? (\n            <img\n              src={user.profileImage}\n              alt={user.name}\n              className=\"w-10 h-10 rounded-full object-cover\"\n            />\n          ) : (\n            user.name.charAt(0).toUpperCase()\n          )}\n        </div>\n        {/* Online indicator */}\n        {isOnline && (\n          <div className=\"absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-gray-900\"></div>\n        )}\n      </Link>\n\n      {/* User info */}\n      <div className=\"flex-1 min-w-0\">\n        <Link \n          href={`/profile/${user.username}`}\n          className=\"font-semibold text-gray-900 dark:text-white hover:underline truncate block\"\n        >\n          {user.name}\n        </Link>\n        <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n          {isOnline ? (\n            <span className=\"text-green-600 dark:text-green-400\">Online</span>\n          ) : lastActive ? (\n            `Last seen ${formatDistanceToNow(new Date(lastActive), { addSuffix: true })}`\n          ) : (\n            `@${user.username}`\n          )}\n        </p>\n      </div>\n\n      {/* Action buttons */}\n      <div className=\"flex items-center gap-2\">\n        {/* Voice call (future) */}\n        <button\n          className=\"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors\"\n          title=\"Voice call (coming soon)\"\n          disabled\n        >\n          <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z\" />\n          </svg>\n        </button>\n\n        {/* Video call (future) */}\n        <button\n          className=\"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors\"\n          title=\"Video call (coming soon)\"\n          disabled\n        >\n          <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z\" />\n          </svg>\n        </button>\n\n        {/* Info button */}\n        {onInfo && (\n          <button\n            onClick={onInfo}\n            className=\"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors\"\n            title=\"Chat info\"\n          >\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n            </svg>\n          </button>\n        )}\n\n        {/* More options menu */}\n        <div className=\"relative\" ref={menuRef}>\n          <button\n            onClick={() => setShowMenu(!showMenu)}\n            className=\"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors\"\n            title=\"More options\"\n          >\n            <MoreVertical className=\"w-5 h-5\" />\n          </button>\n\n          {showMenu && (\n            <div className=\"absolute right-0 top-full mt-1 w-48 py-1 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-lg z-50\">\n              <button\n                onClick={() => {\n                  setShowReportModal(true);\n                  setShowMenu(false);\n                }}\n                className=\"flex items-center gap-2 w-full px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700\"\n              >\n                <Flag className=\"w-4 h-4\" />\n                Report User\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Report Modal */}\n      <ReportModal\n        isOpen={showReportModal}\n        onClose={() => setShowReportModal(false)}\n        type=\"chat\"\n        targetId={conversationId}\n        targetName={user.name}\n        conversationId={conversationId}\n        reportedUserId={user.id}\n      />\n    </div>\n  );\n}\n"],"names":["c","_c","React","useState","useEffect","useRef","Link","formatDistanceToNow","getSocket","cn","ReportModal","MoreVertical","Flag","UserX","Bell","BellOff","ChatHeaderProps","user","id","name","username","profileImage","isOnline","lastActiveAt","conversationId","onBack","onInfo","ChatHeader","t0","$","$i","Symbol","for","setIsOnline","lastActive","setLastActive","showMenu","setShowMenu","showReportModal","setShowReportModal","menuRef","t1","t2","ChatHeader[useEffect()]","handleClickOutside","event","current","contains","target","Node","document","addEventListener","removeEventListener","t3","t4","socket","handleOnline","data","userId","handleOffline","data_0","Date","toISOString","handleStatus","data_1","on","off","t5","t6","t7","t8","t9","charAt","toUpperCase","t10","t11","t12","t13","t14","t15","addSuffix","t16","t17","t18","t19","t20","t21","ChatHeader[<button>.onClick]","t22","t23","t24","t25","t26","t27","ChatHeader[<ReportModal>.onClose]","t28","t29"],"mappings":"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","ignoreList":[]}},
    {"offset": {"line": 7917, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/chat/index.ts"],"sourcesContent":["export { default as ChatList } from './ChatList';\nexport { default as ChatMessages } from './ChatMessages';\nexport { default as ChatInput, type UploadingMessage, type OptimisticMessage } from './ChatInput';\nexport { default as ChatHeader } from './ChatHeader';\nexport { default as ChatSettingsPanel, WALLPAPER_OPTIONS } from './ChatSettingsPanel';\nexport { default as MessageMenu, MessageQuickActions } from './MessageMenu';\nexport { default as AIChatAssistant } from './AIChatAssistant';\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 7948, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/app/messages/layout.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState, useCallback } from 'react';\nimport { useRouter, usePathname } from 'next/navigation';\nimport { ProtectedRoute } from '@/components/auth/ProtectedRoute';\nimport { useAuth } from '@/lib/auth/useAuth';\nimport { ChatList } from '@/components/chat';\nimport { initializeSocket, getSocket } from '@/lib/socket';\nimport { getUnreadCount, Conversation } from '@/lib/api/chat';\nimport Link from 'next/link';\n\ninterface MessagesLayoutProps {\n  children: React.ReactNode;\n}\n\nexport default function MessagesLayout({ children }: MessagesLayoutProps) {\n  const router = useRouter();\n  const pathname = usePathname();\n  const { user } = useAuth();\n  const [unreadCount, setUnreadCount] = useState(0);\n\n  // Extract conversation ID from pathname\n  const conversationId = pathname?.startsWith('/messages/') \n    ? pathname.split('/messages/')[1] \n    : undefined;\n  const isConversationView = !!conversationId;\n\n  // Initialize socket and fetch unread count\n  useEffect(() => {\n    if (user?.id) {\n      initializeSocket();\n      \n      // Fetch unread count\n      getUnreadCount().then(res => {\n        setUnreadCount(res.unreadCount);\n      }).catch(console.error);\n    }\n  }, [user?.id]);\n\n  // Listen for new message notifications\n  useEffect(() => {\n    const socket = getSocket();\n    if (!socket) return;\n\n    const handleNotification = () => {\n      getUnreadCount().then(res => {\n        setUnreadCount(res.unreadCount);\n      }).catch(console.error);\n    };\n\n    socket.on('chat:notification', handleNotification);\n\n    return () => {\n      socket.off('chat:notification', handleNotification);\n    };\n  }, []);\n\n  const handleSelectConversation = useCallback((conv: Conversation) => {\n    router.push(`/messages/${conv.id}`, { scroll: false });\n  }, [router]);\n\n  return (\n    <ProtectedRoute>\n      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n        <div className=\"max-w-7xl mx-auto\">\n          {/* h-screen minus bottom nav height (pb-24 = 96px) */}\n          <div className=\"flex h-[calc(100vh-96px)]\">\n            {/* Sidebar - Chat List - ALWAYS MOUNTED, never remounts */}\n            <div className={`${isConversationView ? 'hidden md:flex' : 'flex'} w-full md:w-96 bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700 flex-col`}>\n              {/* Header */}\n              <div className=\"p-4 border-b border-gray-200 dark:border-gray-700\">\n                <div className=\"flex items-center justify-between\">\n                  <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n                    Messages\n                    {unreadCount > 0 && (\n                      <span className=\"ml-2 px-2 py-0.5 bg-blue-600 text-white text-sm rounded-full\">\n                        {unreadCount}\n                      </span>\n                    )}\n                  </h1>\n                  <Link\n                    href=\"/find-people\"\n                    className=\"p-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-full transition-colors\"\n                    title=\"New conversation\"\n                  >\n                    <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\n                    </svg>\n                  </Link>\n                </div>\n                \n                {/* Search */}\n                <div className=\"mt-4 relative\">\n                  <input\n                    type=\"text\"\n                    placeholder=\"Search messages...\"\n                    className=\"w-full px-4 py-2 pl-10 bg-gray-100 dark:bg-gray-800 rounded-full border-0 focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white placeholder-gray-500\"\n                  />\n                  <svg \n                    className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400\"\n                    fill=\"none\" \n                    stroke=\"currentColor\" \n                    viewBox=\"0 0 24 24\"\n                  >\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\n                  </svg>\n                </div>\n              </div>\n\n              {/* Chat list - this component stays mounted across route changes */}\n              <ChatList \n                selectedConversationId={conversationId}\n                onSelectConversation={handleSelectConversation}\n                currentUserId={user?.id}\n              />\n            </div>\n\n            {/* Main Content Area - children will be the page content */}\n            <div className={`${isConversationView ? 'flex' : 'hidden md:flex'} flex-1 flex-col bg-white dark:bg-gray-900 h-full overflow-hidden`}>\n              {children}\n            </div>\n          </div>\n        </div>\n      </div>\n    </ProtectedRoute>\n  );\n}\n"],"names":["c","_c","useEffect","useState","useCallback","useRouter","usePathname","ProtectedRoute","useAuth","ChatList","initializeSocket","getSocket","getUnreadCount","Conversation","Link","MessagesLayoutProps","children","React","ReactNode","MessagesLayout","t0","$","$i","Symbol","for","router","pathname","user","unreadCount","setUnreadCount","t1","startsWith","split","undefined","conversationId","isConversationView","t2","id","MessagesLayout[useEffect()]","then","res","catch","console","error","t3","t4","t5","t6","socket","handleNotification","MessagesLayout[useEffect() > handleNotification]","res_0","on","off","t7","conv","push","scroll","handleSelectConversation","t8","t9","t10","t11","t12","t13","t14","t15","t16","t17","t18","t19","t20","t21"],"mappings":"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","ignoreList":[]}}]
}