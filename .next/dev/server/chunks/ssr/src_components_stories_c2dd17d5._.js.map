{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/stories/StoryCarousel.tsx"],"sourcesContent":["'use client';\n\nimport React, { useRef, useState, useEffect, useCallback } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Plus, ChevronLeft, ChevronRight } from 'lucide-react';\nimport Image from 'next/image';\nimport { useAuth } from '@/lib/auth/useAuth';\nimport { getStoriesFeed, type StoryGroup, type Story } from '@/lib/api/stories';\nimport { getSocket } from '@/lib/socket';\n\ninterface StoryCarouselProps {\n  onOpenStory: (group: StoryGroup, startIndex?: number) => void;\n  onCreateStory: () => void;\n}\n\nexport function StoryCarousel({ onOpenStory, onCreateStory }: StoryCarouselProps) {\n  const { user, loading: authLoading } = useAuth();\n  const scrollRef = useRef<HTMLDivElement>(null);\n  const [storyGroups, setStoryGroups] = useState<StoryGroup[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [canScrollLeft, setCanScrollLeft] = useState(false);\n  const [canScrollRight, setCanScrollRight] = useState(false);\n\n  // Fetch stories on mount (only after auth is ready)\n  const fetchStories = useCallback(async () => {\n    if (authLoading) return; // Wait for auth to complete\n    \n    try {\n      const response = await getStoriesFeed();\n      console.log('üìñ Stories feed response:', response);\n      setStoryGroups(response?.storyGroups || []);\n    } catch (error: any) {\n      console.error('Error fetching stories:', error);\n      // Don't clear stories on 401 - user might just need to re-auth\n      if (error?.response?.status !== 401) {\n        setStoryGroups([]);\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, [authLoading]);\n\n  useEffect(() => {\n    if (!authLoading) {\n      fetchStories();\n    }\n  }, [authLoading, fetchStories]);\n\n  // Listen for real-time story updates\n  useEffect(() => {\n    const socket = getSocket();\n    if (!socket) return;\n\n    // Handle new story created\n    const handleStoryCreated = (data: { story: Story; author: any; timestamp: Date }) => {\n      console.log('üìñ Real-time: New story received', data);\n      \n      setStoryGroups(prev => {\n        // Check if author already has stories\n        const existingGroupIndex = prev.findIndex(g => g.user.id === data.author.id);\n        \n        if (existingGroupIndex >= 0) {\n          // Add story to existing group\n          const updated = [...prev];\n          updated[existingGroupIndex] = {\n            ...updated[existingGroupIndex],\n            stories: [data.story, ...updated[existingGroupIndex].stories],\n            hasUnviewed: true,\n            lastStoryAt: data.story.createdAt,\n          };\n          return updated;\n        } else {\n          // Create new group for this author\n          const newGroup: StoryGroup = {\n            user: data.author,\n            stories: [data.story],\n            hasUnviewed: true,\n            lastStoryAt: data.story.createdAt,\n            isOwnStory: data.author.id === user?.id,\n          };\n          \n          // Add at beginning (after own stories if exists)\n          const ownGroupIndex = prev.findIndex(g => g.isOwnStory);\n          if (newGroup.isOwnStory) {\n            return [newGroup, ...prev.filter(g => !g.isOwnStory)];\n          } else if (ownGroupIndex >= 0) {\n            return [prev[ownGroupIndex], newGroup, ...prev.filter((g, i) => !g.isOwnStory && i !== ownGroupIndex)];\n          }\n          return [newGroup, ...prev];\n        }\n      });\n    };\n\n    // Handle story deleted\n    const handleStoryDeleted = (data: { storyId: string; authorId: string; timestamp: Date }) => {\n      console.log('üóëÔ∏è Real-time: Story deleted', data);\n      \n      setStoryGroups(prev => {\n        return prev.map(group => {\n          if (group.user.id === data.authorId) {\n            const filteredStories = group.stories.filter(s => s.id !== data.storyId);\n            if (filteredStories.length === 0) {\n              return null; // Remove group entirely\n            }\n            return {\n              ...group,\n              stories: filteredStories,\n            };\n          }\n          return group;\n        }).filter(Boolean) as StoryGroup[];\n      });\n    };\n\n    socket.on('story:created', handleStoryCreated);\n    socket.on('story:deleted', handleStoryDeleted);\n\n    return () => {\n      socket.off('story:created', handleStoryCreated);\n      socket.off('story:deleted', handleStoryDeleted);\n    };\n  }, [user?.id]);\n\n  useEffect(() => {\n    const checkScroll = () => {\n      if (scrollRef.current) {\n        const { scrollLeft, scrollWidth, clientWidth } = scrollRef.current;\n        setCanScrollLeft(scrollLeft > 0);\n        setCanScrollRight(scrollLeft < scrollWidth - clientWidth - 10);\n      }\n    };\n\n    checkScroll();\n    scrollRef.current?.addEventListener('scroll', checkScroll);\n    window.addEventListener('resize', checkScroll);\n\n    return () => {\n      scrollRef.current?.removeEventListener('scroll', checkScroll);\n      window.removeEventListener('resize', checkScroll);\n    };\n  }, [storyGroups]);\n\n  const scroll = (direction: 'left' | 'right') => {\n    if (scrollRef.current) {\n      const scrollAmount = direction === 'left' ? -300 : 300;\n      scrollRef.current.scrollBy({ left: scrollAmount, behavior: 'smooth' });\n    }\n  };\n\n  const ownStoryGroup = storyGroups.find(g => g.isOwnStory);\n  const otherStoryGroups = storyGroups.filter(g => !g.isOwnStory);\n\n  // Show loading skeleton while auth is loading or stories are loading\n  if (authLoading || loading) {\n    return (\n      <div className=\"w-full py-4 px-4\">\n        <div className=\"flex gap-3 overflow-hidden\">\n          {/* Skeleton for create story */}\n          <div className=\"flex-shrink-0 w-28 h-40 bg-gray-200 dark:bg-neutral-800 rounded-2xl animate-pulse\" />\n          {/* Skeletons for stories */}\n          {[...Array(4)].map((_, i) => (\n            <div\n              key={i}\n              className=\"flex-shrink-0 w-28 h-40 bg-gray-200 dark:bg-neutral-800 rounded-2xl animate-pulse\"\n            />\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"relative w-full py-4 group\">\n      {/* Left Scroll Button */}\n      <AnimatePresence>\n        {canScrollLeft && (\n          <motion.button\n            initial={{ opacity: 0, x: 10 }}\n            animate={{ opacity: 1, x: 0 }}\n            exit={{ opacity: 0, x: 10 }}\n            onClick={() => scroll('left')}\n            className=\"absolute left-2 top-1/2 -translate-y-1/2 z-20 w-10 h-10 bg-white dark:bg-neutral-800 rounded-full shadow-lg flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity\"\n          >\n            <ChevronLeft className=\"w-5 h-5 text-gray-700 dark:text-neutral-300\" />\n          </motion.button>\n        )}\n      </AnimatePresence>\n\n      {/* Right Scroll Button */}\n      <AnimatePresence>\n        {canScrollRight && (\n          <motion.button\n            initial={{ opacity: 0, x: -10 }}\n            animate={{ opacity: 1, x: 0 }}\n            exit={{ opacity: 0, x: -10 }}\n            onClick={() => scroll('right')}\n            className=\"absolute right-2 top-1/2 -translate-y-1/2 z-20 w-10 h-10 bg-white dark:bg-neutral-800 rounded-full shadow-lg flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity\"\n          >\n            <ChevronRight className=\"w-5 h-5 text-gray-700 dark:text-neutral-300\" />\n          </motion.button>\n        )}\n      </AnimatePresence>\n\n      {/* Story Cards */}\n      <div\n        ref={scrollRef}\n        className=\"flex gap-3 overflow-x-auto scrollbar-hide px-4 scroll-smooth\"\n        style={{ scrollbarWidth: 'none', msOverflowStyle: 'none' }}\n      >\n        {/* Create Story Card */}\n        <motion.button\n          onClick={onCreateStory}\n          whileHover={{ scale: 1.02 }}\n          whileTap={{ scale: 0.98 }}\n          className=\"flex-shrink-0 relative w-28 h-40 rounded-2xl overflow-hidden bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 shadow-lg\"\n        >\n          {/* User Avatar Background */}\n          {user?.profileImage ? (\n            <div className=\"absolute inset-0\">\n              <Image\n                src={user.profileImage}\n                alt=\"Your story\"\n                fill\n                className=\"object-cover opacity-30\"\n              />\n              <div className=\"absolute inset-0 bg-gradient-to-b from-transparent via-black/20 to-black/60\" />\n            </div>\n          ) : (\n            <div className=\"absolute inset-0 bg-gradient-to-br from-blue-600 via-purple-600 to-pink-600\" />\n          )}\n\n          {/* Content */}\n          <div className=\"absolute inset-0 flex flex-col items-center justify-center\">\n            <div className=\"w-11 h-11 rounded-full bg-white dark:bg-neutral-900 flex items-center justify-center shadow-lg mb-2\">\n              <Plus className=\"w-6 h-6 text-blue-500\" />\n            </div>\n            <span className=\"text-white text-xs font-semibold text-center px-2\">\n              {ownStoryGroup ? 'Add to Story' : 'Create Story'}\n            </span>\n          </div>\n\n          {/* Glassmorphic overlay */}\n          <div className=\"absolute bottom-0 left-0 right-0 h-12 bg-white/10 backdrop-blur-sm\" />\n        </motion.button>\n\n        {/* Own Story (if exists) */}\n        {ownStoryGroup && (\n          <StoryCard\n            group={ownStoryGroup}\n            onClick={() => onOpenStory(ownStoryGroup)}\n            isOwn\n          />\n        )}\n\n        {/* Other Stories */}\n        {otherStoryGroups.map((group) => (\n          <StoryCard\n            key={group.user.id}\n            group={group}\n            onClick={() => onOpenStory(group)}\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n\ninterface StoryCardProps {\n  group: StoryGroup;\n  onClick: () => void;\n  isOwn?: boolean;\n}\n\nfunction StoryCard({ group, onClick, isOwn }: StoryCardProps) {\n  const { user, stories, hasUnviewed } = group;\n  const latestStory = stories[0];\n\n  return (\n    <motion.button\n      onClick={onClick}\n      whileHover={{ scale: 1.02, y: -2 }}\n      whileTap={{ scale: 0.98 }}\n      className=\"flex-shrink-0 relative w-28 h-40 rounded-2xl overflow-hidden shadow-lg group/card\"\n    >\n      {/* Background Image - use img for CDN URLs to avoid Next.js Image restrictions */}\n      <div className=\"absolute inset-0\">\n        {(latestStory.thumbnailUrl || latestStory.mediaUrl) ? (\n          <img\n            src={latestStory.thumbnailUrl || latestStory.mediaUrl}\n            alt={`${user.name}'s story`}\n            className=\"w-full h-full object-cover transition-transform duration-300 group-hover/card:scale-105\"\n          />\n        ) : (\n          <div \n            className=\"w-full h-full\"\n            style={{ backgroundColor: latestStory.backgroundColor || '#3B82F6' }}\n          />\n        )}\n        \n        {/* Gradient Overlay */}\n        <div className=\"absolute inset-0 bg-gradient-to-b from-black/30 via-transparent to-black/70\" />\n      </div>\n\n      {/* Ring Border - Gradient for unviewed, gray for viewed */}\n      <div \n        className={`absolute inset-0 rounded-2xl transition-all duration-300 ${\n          hasUnviewed\n            ? 'ring-[3px] ring-offset-2 ring-offset-white dark:ring-offset-neutral-950'\n            : 'ring-2 ring-gray-300 dark:ring-neutral-700'\n        }`}\n        style={hasUnviewed ? {\n          background: 'linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%)',\n          WebkitMask: 'linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0)',\n          WebkitMaskComposite: 'xor',\n          maskComposite: 'exclude',\n          padding: '3px',\n        } : undefined}\n      />\n\n      {/* Avatar */}\n      <div className=\"absolute top-2 left-2 z-10\">\n        <div className={`w-9 h-9 rounded-full overflow-hidden ring-2 ${\n          hasUnviewed \n            ? 'ring-purple-500 ring-offset-1 ring-offset-black/50' \n            : 'ring-white/50'\n        }`}>\n          {user.profileImage ? (\n            <Image\n              src={user.profileImage}\n              alt={user.name}\n              width={36}\n              height={36}\n              className=\"object-cover\"\n            />\n          ) : (\n            <div className=\"w-full h-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center\">\n              <span className=\"text-white text-xs font-bold\">\n                {user.name.charAt(0).toUpperCase()}\n              </span>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Story Count Badge */}\n      {stories.length > 1 && (\n        <div className=\"absolute top-2 right-2 bg-black/50 backdrop-blur-sm px-1.5 py-0.5 rounded-full\">\n          <span className=\"text-white text-[10px] font-medium\">{stories.length}</span>\n        </div>\n      )}\n\n      {/* Text Content Preview */}\n      {latestStory.textContent && (\n        <div className=\"absolute inset-x-2 top-1/2 -translate-y-1/2 text-center\">\n          <p className=\"text-white text-xs font-medium line-clamp-3 drop-shadow-lg\">\n            {latestStory.textContent}\n          </p>\n        </div>\n      )}\n\n      {/* Bottom Info */}\n      <div className=\"absolute bottom-0 left-0 right-0 p-2 bg-gradient-to-t from-black/80 to-transparent\">\n        <p className=\"text-white text-xs font-semibold truncate\">\n          {isOwn ? 'Your Story' : user.name.split(' ')[0]}\n        </p>\n        {/* Time ago */}\n        <p className=\"text-white/70 text-[10px]\">\n          {formatTimeAgo(new Date(latestStory.createdAt))}\n        </p>\n      </div>\n\n      {/* Category Badge */}\n      {latestStory.category && latestStory.category !== 'GENERAL' && (\n        <div className=\"absolute bottom-10 left-2 right-2\">\n          <span className=\"text-[9px] text-white/80 bg-white/20 backdrop-blur-sm px-1.5 py-0.5 rounded-full\">\n            {formatCategory(latestStory.category)}\n          </span>\n        </div>\n      )}\n    </motion.button>\n  );\n}\n\nfunction formatTimeAgo(date: Date): string {\n  const now = new Date();\n  const diff = now.getTime() - date.getTime();\n  const minutes = Math.floor(diff / 60000);\n  const hours = Math.floor(diff / 3600000);\n\n  if (minutes < 1) return 'Just now';\n  if (minutes < 60) return `${minutes}m`;\n  if (hours < 24) return `${hours}h`;\n  return '1d';\n}\n\nfunction formatCategory(category: string): string {\n  const map: Record<string, string> = {\n    DAY_AT_WORK: 'üíº Work',\n    LEARNING: 'üìö Learning',\n    ACHIEVEMENT: 'üèÜ Achievement',\n    PROJECT: 'üöÄ Project',\n    EVENT: 'üéâ Event',\n    BEHIND_SCENES: 'üé¨ BTS',\n    TIPS: 'üí° Tips',\n    QNA: '‚ùì Q&A',\n  };\n  return map[category] || category;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 609, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/stories/StoryViewer.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { motion, AnimatePresence, PanInfo } from 'framer-motion';\nimport {\n  X,\n  ChevronUp,\n  ChevronDown,\n  Eye,\n  Heart,\n  Send,\n  MoreHorizontal,\n  Pause,\n  Play,\n  Volume2,\n  VolumeX,\n  Link2,\n  Trash2,\n  Archive,\n  Share2,\n} from 'lucide-react';\nimport Image from 'next/image';\nimport { useAuth } from '@/lib/auth/useAuth';\nimport { getSocket } from '@/lib/socket';\nimport {\n  viewStory,\n  reactToStory,\n  removeReaction,\n  replyToStory,\n  deleteStory,\n  archiveStory,\n  type StoryGroup,\n  type Story,\n} from '@/lib/api/stories';\n\ninterface StoryViewerProps {\n  storyGroups: StoryGroup[];\n  initialGroupIndex: number;\n  initialStoryIndex?: number;\n  onClose: () => void;\n  onStoryEnd?: () => void;\n}\n\nconst REACTIONS = ['üî•', '‚ù§Ô∏è', 'üëè', 'üòÆ', 'üòÇ', 'üí°'];\n\nexport function StoryViewer({\n  storyGroups,\n  initialGroupIndex,\n  initialStoryIndex = 0,\n  onClose,\n  onStoryEnd,\n}: StoryViewerProps) {\n  const { user } = useAuth();\n  const [currentGroupIndex, setCurrentGroupIndex] = useState(initialGroupIndex);\n  const [currentStoryIndex, setCurrentStoryIndex] = useState(initialStoryIndex);\n  const [progress, setProgress] = useState(0);\n  const [isPaused, setIsPaused] = useState(false);\n  const [isMuted, setIsMuted] = useState(true);\n  const [showReactions, setShowReactions] = useState(false);\n  const [showReplyInput, setShowReplyInput] = useState(false);\n  const [replyText, setReplyText] = useState('');\n  const [showMenu, setShowMenu] = useState(false);\n  const [viewStartTime, setViewStartTime] = useState<number>(Date.now());\n  const [selectedReaction, setSelectedReaction] = useState<string | null>(null);\n  \n  const progressIntervalRef = useRef<NodeJS.Timeout | null>(null);\n  const videoRef = useRef<HTMLVideoElement>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const currentGroup = storyGroups[currentGroupIndex];\n  const [storiesWithViews, setStoriesWithViews] = useState<Record<string, number>>({});\n  const currentStory = currentGroup?.stories[currentStoryIndex];\n  const currentViewsCount = storiesWithViews[currentStory?.id ?? ''] ?? currentStory?.viewsCount ?? 0;\n  const isOwnStory = currentGroup?.isOwnStory;\n\n  // Live view count updates for own stories\n  useEffect(() => {\n    if (!isOwnStory || !currentStory) return;\n    const socket = getSocket();\n    if (!socket) return;\n\n    const handleStoryViewed = ({ storyId, viewsCount }: { storyId: string; viewsCount: number }) => {\n      if (storyId === currentStory.id) {\n        setStoriesWithViews((prev) => ({ ...prev, [storyId]: viewsCount }));\n      }\n    };\n\n    socket.on('story:viewed', handleStoryViewed);\n    return () => {\n      socket.off('story:viewed', handleStoryViewed);\n    };\n  }, [isOwnStory, currentStory?.id]);\n\n  // Mark story as viewed on mount and story change\n  useEffect(() => {\n    if (currentStory && !isOwnStory) {\n      setViewStartTime(Date.now());\n      \n      // Record view via socket for real-time updates\n      const socket = getSocket();\n      if (socket) {\n        socket.emit('story:view', { storyId: currentStory.id });\n      }\n    }\n  }, [currentStory?.id, isOwnStory]);\n\n  // Record view duration when leaving story\n  const recordView = useCallback(async () => {\n    if (currentStory && !isOwnStory) {\n      const duration = Date.now() - viewStartTime;\n      \n      // Use socket for real-time view tracking\n      const socket = getSocket();\n      if (socket) {\n        socket.emit('story:view', { storyId: currentStory.id, duration });\n      } else {\n        // Fallback to HTTP\n        try {\n          await viewStory(currentStory.id, duration);\n        } catch (error) {\n          console.error('Error recording view:', error);\n        }\n      }\n    }\n  }, [currentStory, isOwnStory, viewStartTime]);\n\n  // Progress timer\n  useEffect(() => {\n    if (!currentStory || isPaused) return;\n\n    const duration = currentStory.mediaType === 'VIDEO' \n      ? (currentStory.duration || 15000) \n      : (currentStory.duration || 5000);\n\n    const interval = 50; // Update every 50ms for smooth progress\n    const increment = (100 / duration) * interval;\n\n    progressIntervalRef.current = setInterval(() => {\n      setProgress((prev) => {\n        if (prev >= 100) {\n          goToNextStory();\n          return 0;\n        }\n        return prev + increment;\n      });\n    }, interval);\n\n    return () => {\n      if (progressIntervalRef.current) {\n        clearInterval(progressIntervalRef.current);\n      }\n    };\n  }, [currentStory?.id, isPaused]);\n\n  // Reset progress when story changes\n  useEffect(() => {\n    setProgress(0);\n    setSelectedReaction(currentStory?.userReaction || null);\n  }, [currentStory?.id]);\n\n  // Keyboard controls\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      switch (e.key) {\n        case 'ArrowUp':\n        case 'ArrowLeft':\n          goToPreviousStory();\n          break;\n        case 'ArrowDown':\n        case 'ArrowRight':\n          goToNextStory();\n          break;\n        case ' ':\n          e.preventDefault();\n          setIsPaused((prev) => !prev);\n          break;\n        case 'Escape':\n          handleClose();\n          break;\n        case 'm':\n          setIsMuted((prev) => !prev);\n          break;\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, []);\n\n  const goToNextStory = useCallback(async () => {\n    await recordView();\n\n    if (currentStoryIndex < currentGroup.stories.length - 1) {\n      setCurrentStoryIndex((prev) => prev + 1);\n    } else if (currentGroupIndex < storyGroups.length - 1) {\n      setCurrentGroupIndex((prev) => prev + 1);\n      setCurrentStoryIndex(0);\n    } else {\n      handleClose();\n      onStoryEnd?.();\n    }\n  }, [currentStoryIndex, currentGroupIndex, currentGroup, storyGroups.length, recordView, onStoryEnd]);\n\n  const goToPreviousStory = useCallback(async () => {\n    await recordView();\n\n    if (currentStoryIndex > 0) {\n      setCurrentStoryIndex((prev) => prev - 1);\n    } else if (currentGroupIndex > 0) {\n      setCurrentGroupIndex((prev) => prev - 1);\n      const prevGroup = storyGroups[currentGroupIndex - 1];\n      setCurrentStoryIndex(prevGroup.stories.length - 1);\n    }\n  }, [currentStoryIndex, currentGroupIndex, storyGroups, recordView]);\n\n  const handleClose = async () => {\n    await recordView();\n    onClose();\n  };\n\n  // Swipe handling for vertical navigation\n  const handleDragEnd = (event: any, info: PanInfo) => {\n    const threshold = 50;\n    const velocity = 500;\n\n    if (info.offset.y < -threshold || info.velocity.y < -velocity) {\n      goToNextStory();\n    } else if (info.offset.y > threshold || info.velocity.y > velocity) {\n      goToPreviousStory();\n    }\n  };\n\n  const handleReaction = async (reaction: string) => {\n    if (!currentStory) return;\n\n    try {\n      if (selectedReaction === reaction) {\n        await removeReaction(currentStory.id);\n        setSelectedReaction(null);\n      } else {\n        await reactToStory(currentStory.id, reaction);\n        setSelectedReaction(reaction);\n      }\n      \n      // Also emit via socket for real-time updates\n      const socket = getSocket();\n      if (socket) {\n        socket.emit('story:react', { storyId: currentStory.id, reaction });\n      }\n    } catch (error) {\n      console.error('Error reacting to story:', error);\n    }\n    setShowReactions(false);\n  };\n\n  const handleSendReply = async () => {\n    if (!currentStory || !replyText.trim()) return;\n\n    try {\n      // Emit via socket for real-time delivery\n      const socket = getSocket();\n      if (socket) {\n        socket.emit('story:reply', { \n          storyId: currentStory.id, \n          content: replyText.trim() \n        });\n      } else {\n        // Fallback to HTTP\n        await replyToStory(currentStory.id, replyText.trim());\n      }\n      \n      setReplyText('');\n      setShowReplyInput(false);\n      // Show success toast or animation\n    } catch (error) {\n      console.error('Error sending reply:', error);\n    }\n  };\n\n  const handleDeleteStory = async () => {\n    if (!currentStory) return;\n\n    try {\n      await deleteStory(currentStory.id);\n      goToNextStory();\n    } catch (error) {\n      console.error('Error deleting story:', error);\n    }\n    setShowMenu(false);\n  };\n\n  const handleArchiveStory = async () => {\n    if (!currentStory) return;\n\n    try {\n      await archiveStory(currentStory.id);\n      // Show success message\n    } catch (error) {\n      console.error('Error archiving story:', error);\n    }\n    setShowMenu(false);\n  };\n\n  if (!currentGroup || !currentStory) {\n    return null;\n  }\n\n  return (\n    <AnimatePresence>\n      <motion.div\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        exit={{ opacity: 0 }}\n        className=\"fixed inset-0 z-[100] bg-black\"\n      >\n        {/* Main Content Container */}\n        <motion.div\n          ref={containerRef}\n          drag=\"y\"\n          dragConstraints={{ top: 0, bottom: 0 }}\n          dragElastic={0.2}\n          onDragEnd={handleDragEnd}\n          className=\"relative w-full h-full flex items-center justify-center\"\n          onClick={(e) => {\n            // Tap left/right to navigate\n            const rect = containerRef.current?.getBoundingClientRect();\n            if (rect) {\n              const clickX = e.clientX - rect.left;\n              if (clickX < rect.width / 3) {\n                goToPreviousStory();\n              } else if (clickX > (rect.width * 2) / 3) {\n                goToNextStory();\n              } else {\n                setIsPaused((prev) => !prev);\n              }\n            }\n          }}\n        >\n          {/* Story Content */}\n          <div className=\"relative w-full h-full max-w-lg mx-auto\">\n            {/* Background */}\n            <div className=\"absolute inset-0\">\n              {currentStory.mediaType === 'VIDEO' ? (\n                <video\n                  ref={videoRef}\n                  src={currentStory.mediaUrl}\n                  className=\"w-full h-full object-cover\"\n                  autoPlay\n                  loop\n                  muted={isMuted}\n                  playsInline\n                />\n              ) : currentStory.mediaType === 'TEXT' ? (\n                <div\n                  className=\"w-full h-full flex items-center justify-center p-8\"\n                  style={{ backgroundColor: currentStory.backgroundColor || '#3B82F6' }}\n                >\n                  <p\n                    className=\"text-white text-2xl font-bold text-center leading-relaxed\"\n                    style={{\n                      fontSize: currentStory.textStyle?.fontSize || 24,\n                      fontWeight: currentStory.textStyle?.fontWeight || 'bold',\n                      color: currentStory.textStyle?.color || 'white',\n                    }}\n                  >\n                    {currentStory.textContent}\n                  </p>\n                </div>\n              ) : (\n                <img\n                  src={currentStory.mediaUrl}\n                  alt=\"Story\"\n                  className=\"w-full h-full object-cover\"\n                />\n              )}\n\n              {/* Text Overlay */}\n              {currentStory.mediaType !== 'TEXT' && currentStory.textContent && (\n                <div\n                  className=\"absolute p-4\"\n                  style={{\n                    left: currentStory.textPosition?.x || '50%',\n                    top: currentStory.textPosition?.y || '50%',\n                    transform: 'translate(-50%, -50%)',\n                  }}\n                >\n                  <p\n                    className=\"text-white text-lg font-semibold drop-shadow-lg\"\n                    style={currentStory.textStyle || {}}\n                  >\n                    {currentStory.textContent}\n                  </p>\n                </div>\n              )}\n\n              {/* Gradient overlays */}\n              <div className=\"absolute inset-0 bg-gradient-to-b from-black/40 via-transparent to-black/60 pointer-events-none\" />\n            </div>\n\n            {/* Top Section - Progress & Header */}\n            <div className=\"absolute top-0 left-0 right-0 p-4 z-10\">\n              {/* Progress Bars */}\n              <div className=\"flex gap-1 mb-4\">\n                {currentGroup.stories.map((_, idx) => (\n                  <div\n                    key={idx}\n                    className=\"flex-1 h-[3px] bg-white/30 rounded-full overflow-hidden\"\n                  >\n                    <motion.div\n                      className=\"h-full bg-white rounded-full\"\n                      style={{\n                        width:\n                          idx < currentStoryIndex\n                            ? '100%'\n                            : idx === currentStoryIndex\n                            ? `${progress}%`\n                            : '0%',\n                      }}\n                    />\n                  </div>\n                ))}\n              </div>\n\n              {/* Header */}\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                  {/* User Avatar with gradient ring */}\n                  <div className=\"relative\">\n                    <div className=\"w-10 h-10 rounded-full overflow-hidden ring-2 ring-white\">\n                      {currentGroup.user.profileImage ? (\n                        <Image\n                          src={currentGroup.user.profileImage}\n                          alt={currentGroup.user.name}\n                          width={40}\n                          height={40}\n                          className=\"object-cover\"\n                        />\n                      ) : (\n                        <div className=\"w-full h-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center\">\n                          <span className=\"text-white font-bold\">\n                            {currentGroup.user.name.charAt(0)}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n\n                  <div>\n                    <p className=\"text-white font-semibold text-sm\">\n                      {currentGroup.user.name}\n                    </p>\n                    <p className=\"text-white/60 text-xs\">\n                      {formatTimeAgo(new Date(currentStory.createdAt))}\n                    </p>\n                  </div>\n                </div>\n\n                <div className=\"flex items-center gap-2\">\n                  {/* Pause/Play */}\n                  <button\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      setIsPaused((prev) => !prev);\n                    }}\n                    className=\"w-8 h-8 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center\"\n                  >\n                    {isPaused ? (\n                      <Play className=\"w-4 h-4 text-white\" fill=\"white\" />\n                    ) : (\n                      <Pause className=\"w-4 h-4 text-white\" fill=\"white\" />\n                    )}\n                  </button>\n\n                  {/* Mute (for video) */}\n                  {currentStory.mediaType === 'VIDEO' && (\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        setIsMuted((prev) => !prev);\n                      }}\n                      className=\"w-8 h-8 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center\"\n                    >\n                      {isMuted ? (\n                        <VolumeX className=\"w-4 h-4 text-white\" />\n                      ) : (\n                        <Volume2 className=\"w-4 h-4 text-white\" />\n                      )}\n                    </button>\n                  )}\n\n                  {/* More Options */}\n                  <button\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      setShowMenu(true);\n                    }}\n                    className=\"w-8 h-8 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center\"\n                  >\n                    <MoreHorizontal className=\"w-4 h-4 text-white\" />\n                  </button>\n\n                  {/* Close */}\n                  <button\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      handleClose();\n                    }}\n                    className=\"w-8 h-8 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center\"\n                  >\n                    <X className=\"w-4 h-4 text-white\" />\n                  </button>\n                </div>\n              </div>\n            </div>\n\n            {/* Navigation Indicators */}\n            <div className=\"absolute left-4 top-1/2 -translate-y-1/2 z-10 pointer-events-none\">\n              <ChevronUp className=\"w-6 h-6 text-white/40 animate-pulse\" />\n            </div>\n            <div className=\"absolute right-4 top-1/2 -translate-y-1/2 z-10 pointer-events-none\">\n              <ChevronDown className=\"w-6 h-6 text-white/40 animate-pulse\" />\n            </div>\n\n            {/* Link Preview */}\n            {currentStory.linkUrl && (\n              <div className=\"absolute bottom-32 left-4 right-4 z-10\">\n                <a\n                  href={currentStory.linkUrl}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  onClick={(e) => e.stopPropagation()}\n                  className=\"flex items-center gap-2 bg-white/10 backdrop-blur-md rounded-full px-4 py-2\"\n                >\n                  <Link2 className=\"w-4 h-4 text-white\" />\n                  <span className=\"text-white text-sm truncate\">\n                    {currentStory.linkTitle || currentStory.linkUrl}\n                  </span>\n                </a>\n              </div>\n            )}\n\n            {/* Bottom Section - Actions */}\n            <div className=\"absolute bottom-0 left-0 right-0 p-4 z-10\">\n              {/* View Count (for own stories) - updates live when others view */}\n              {isOwnStory && (\n                <div className=\"flex items-center gap-4 mb-4 text-white/80\">\n                  <div className=\"flex items-center gap-1\">\n                    <Eye className=\"w-4 h-4\" />\n                    <span className=\"text-sm\">{currentViewsCount} views</span>\n                  </div>\n                  <div className=\"flex items-center gap-1\">\n                    <Heart className=\"w-4 h-4\" />\n                    <span className=\"text-sm\">{currentStory.reactionsCount} reactions</span>\n                  </div>\n                </div>\n              )}\n\n              {/* Reply Input or Actions */}\n              {!isOwnStory && (\n                <div className=\"flex items-center gap-2\">\n                  {showReplyInput ? (\n                    <div className=\"flex-1 flex items-center gap-2\">\n                      <input\n                        type=\"text\"\n                        value={replyText}\n                        onChange={(e) => setReplyText(e.target.value)}\n                        placeholder=\"Send a message...\"\n                        className=\"flex-1 bg-white/10 backdrop-blur-md text-white placeholder-white/50 rounded-full px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-white/30\"\n                        autoFocus\n                        onClick={(e) => e.stopPropagation()}\n                        onKeyDown={(e) => {\n                          e.stopPropagation();\n                          if (e.key === 'Enter') handleSendReply();\n                          if (e.key === 'Escape') setShowReplyInput(false);\n                        }}\n                      />\n                      <button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          handleSendReply();\n                        }}\n                        className=\"w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center\"\n                      >\n                        <Send className=\"w-5 h-5 text-white\" />\n                      </button>\n                    </div>\n                  ) : (\n                    <>\n                      <button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          setShowReplyInput(true);\n                          setIsPaused(true);\n                        }}\n                        className=\"flex-1 bg-white/10 backdrop-blur-md text-white/70 rounded-full px-4 py-2 text-sm text-left\"\n                      >\n                        Reply to {currentGroup.user.name.split(' ')[0]}...\n                      </button>\n\n                      {/* Reaction Button */}\n                      <div className=\"relative\">\n                        <button\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            setShowReactions(!showReactions);\n                            setIsPaused(true);\n                          }}\n                          className={`w-10 h-10 rounded-full ${\n                            selectedReaction\n                              ? 'bg-pink-500/30'\n                              : 'bg-white/10'\n                          } backdrop-blur-md flex items-center justify-center`}\n                        >\n                          {selectedReaction ? (\n                            <span className=\"text-xl\">{selectedReaction}</span>\n                          ) : (\n                            <Heart className=\"w-5 h-5 text-white\" />\n                          )}\n                        </button>\n\n                        {/* Reaction Picker */}\n                        <AnimatePresence>\n                          {showReactions && (\n                            <motion.div\n                              initial={{ opacity: 0, scale: 0.8, y: 10 }}\n                              animate={{ opacity: 1, scale: 1, y: 0 }}\n                              exit={{ opacity: 0, scale: 0.8, y: 10 }}\n                              className=\"absolute bottom-12 right-0 bg-white/10 backdrop-blur-xl rounded-2xl p-2 flex gap-1\"\n                            >\n                              {REACTIONS.map((reaction) => (\n                                <motion.button\n                                  key={reaction}\n                                  whileHover={{ scale: 1.3 }}\n                                  whileTap={{ scale: 0.9 }}\n                                  onClick={(e) => {\n                                    e.stopPropagation();\n                                    handleReaction(reaction);\n                                  }}\n                                  className={`w-10 h-10 rounded-full flex items-center justify-center text-2xl ${\n                                    selectedReaction === reaction\n                                      ? 'bg-white/20'\n                                      : ''\n                                  }`}\n                                >\n                                  {reaction}\n                                </motion.button>\n                              ))}\n                            </motion.div>\n                          )}\n                        </AnimatePresence>\n                      </div>\n\n                      {/* Share Button */}\n                      <button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          // Handle share\n                        }}\n                        className=\"w-10 h-10 rounded-full bg-white/10 backdrop-blur-md flex items-center justify-center\"\n                      >\n                        <Share2 className=\"w-5 h-5 text-white\" />\n                      </button>\n                    </>\n                  )}\n                </div>\n              )}\n            </div>\n          </div>\n        </motion.div>\n\n        {/* Menu Modal */}\n        <AnimatePresence>\n          {showMenu && (\n            <motion.div\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={{ opacity: 0 }}\n              className=\"absolute inset-0 z-20 bg-black/50 flex items-end justify-center\"\n              onClick={() => setShowMenu(false)}\n            >\n              <motion.div\n                initial={{ y: '100%' }}\n                animate={{ y: 0 }}\n                exit={{ y: '100%' }}\n                className=\"w-full max-w-lg bg-neutral-900 rounded-t-3xl p-4\"\n                onClick={(e) => e.stopPropagation()}\n              >\n                <div className=\"w-12 h-1 bg-neutral-700 rounded-full mx-auto mb-4\" />\n\n                {isOwnStory && (\n                  <>\n                    <button\n                      onClick={handleDeleteStory}\n                      className=\"w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-neutral-800 transition-colors text-red-500\"\n                    >\n                      <Trash2 className=\"w-5 h-5\" />\n                      <span>Delete Story</span>\n                    </button>\n                    <button\n                      onClick={handleArchiveStory}\n                      className=\"w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-neutral-800 transition-colors text-white\"\n                    >\n                      <Archive className=\"w-5 h-5\" />\n                      <span>Save to Archive</span>\n                    </button>\n                  </>\n                )}\n\n                <button\n                  onClick={() => setShowMenu(false)}\n                  className=\"w-full mt-2 py-3 bg-neutral-800 rounded-xl text-white font-medium\"\n                >\n                  Cancel\n                </button>\n              </motion.div>\n            </motion.div>\n          )}\n        </AnimatePresence>\n      </motion.div>\n    </AnimatePresence>\n  );\n}\n\nfunction formatTimeAgo(date: Date): string {\n  const now = new Date();\n  const diff = now.getTime() - date.getTime();\n  const minutes = Math.floor(diff / 60000);\n  const hours = Math.floor(diff / 3600000);\n\n  if (minutes < 1) return 'Just now';\n  if (minutes < 60) return `${minutes}m ago`;\n  if (hours < 24) return `${hours}h ago`;\n  return '1d ago';\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1691, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/stories/StoryCreator.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useRef, useCallback } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport {\n  X,\n  Image as ImageIcon,\n  Video,\n  Type,\n  Sparkles,\n  Link2,\n  Users,\n  Globe,\n  Lock,\n  Check,\n  ChevronLeft,\n  ChevronRight,\n  Upload,\n  Loader2,\n  Trash2,\n} from 'lucide-react';\nimport Image from 'next/image';\nimport { createStory, createStoryWithMedia, type CreateStoryInput, type StoryCategory, type StoryVisibility } from '@/lib/api/stories';\n\ninterface StoryCreatorProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onStoryCreated?: () => void;\n}\n\ntype StoryType = 'image' | 'video' | 'text';\ntype CreatorStep = 'select-type' | 'upload-media' | 'edit' | 'details';\n\nconst STORY_CATEGORIES: { value: StoryCategory; label: string; icon: string }[] = [\n  { value: 'DAY_AT_WORK', label: 'Day at Work', icon: 'üíº' },\n  { value: 'LEARNING', label: 'Learning', icon: 'üìö' },\n  { value: 'ACHIEVEMENT', label: 'Achievement', icon: 'üèÜ' },\n  { value: 'PROJECT', label: 'Project', icon: 'üì¢' },\n  { value: 'BEHIND_SCENES', label: 'Behind the Scenes', icon: 'üé¨' },\n  { value: 'TIPS', label: 'Tips', icon: 'üí≠' },\n  { value: 'EVENT', label: 'Event', icon: 'üìÖ' },\n  { value: 'QNA', label: 'Q&A', icon: 'üéØ' },\n  { value: 'GENERAL', label: 'General', icon: '‚ú®' },\n];\n\nconst VISIBILITY_OPTIONS: { value: StoryVisibility; label: string; icon: React.ReactNode; desc: string }[] = [\n  { value: 'PUBLIC', label: 'Public', icon: <Globe className=\"w-5 h-5\" />, desc: 'Anyone can view' },\n  { value: 'CONNECTIONS', label: 'Connections', icon: <Users className=\"w-5 h-5\" />, desc: 'Only connections' },\n  { value: 'CLOSE_FRIENDS', label: 'Close Friends', icon: <Lock className=\"w-5 h-5\" />, desc: 'Selected people only' },\n];\n\nconst TEXT_BACKGROUNDS = [\n  'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n  'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',\n  'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',\n  'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)',\n  'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',\n  'linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)',\n  'linear-gradient(135deg, #30cfd0 0%, #330867 100%)',\n  'linear-gradient(135deg, #ff0844 0%, #ffb199 100%)',\n];\n\nexport function StoryCreator({ isOpen, onClose, onStoryCreated }: StoryCreatorProps) {\n  const [step, setStep] = useState<CreatorStep>('select-type');\n  const [storyType, setStoryType] = useState<StoryType | null>(null);\n  const [mediaFile, setMediaFile] = useState<File | null>(null);\n  const [mediaPreview, setMediaPreview] = useState<string | null>(null);\n  const [textContent, setTextContent] = useState('');\n  const [textBackground, setTextBackground] = useState(TEXT_BACKGROUNDS[0]);\n  const [linkUrl, setLinkUrl] = useState('');\n  const [linkTitle, setLinkTitle] = useState('');\n  const [category, setCategory] = useState<StoryCategory>('GENERAL');\n  const [visibility, setVisibility] = useState<StoryVisibility>('PUBLIC');\n  const [isUploading, setIsUploading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const handleFileSelect = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    // Validate file type\n    const isImage = file.type.startsWith('image/');\n    const isVideo = file.type.startsWith('video/');\n\n    if (storyType === 'image' && !isImage) {\n      setError('Please select an image file');\n      return;\n    }\n    if (storyType === 'video' && !isVideo) {\n      setError('Please select a video file');\n      return;\n    }\n\n    // Validate file size (50MB max for video, 10MB for image)\n    const maxSize = isVideo ? 50 * 1024 * 1024 : 10 * 1024 * 1024;\n    if (file.size > maxSize) {\n      setError(`File too large. Max size: ${isVideo ? '50MB' : '10MB'}`);\n      return;\n    }\n\n    setMediaFile(file);\n    setMediaPreview(URL.createObjectURL(file));\n    setError(null);\n    setStep('edit');\n  }, [storyType]);\n\n  const handleTypeSelect = (type: StoryType) => {\n    setStoryType(type);\n    if (type === 'text') {\n      setStep('edit');\n    } else {\n      setStep('upload-media');\n    }\n  };\n\n  const handleRemoveMedia = () => {\n    if (mediaPreview) {\n      URL.revokeObjectURL(mediaPreview);\n    }\n    setMediaFile(null);\n    setMediaPreview(null);\n    setStep('upload-media');\n  };\n\n  const handleSubmit = async () => {\n    setIsUploading(true);\n    setError(null);\n\n    try {\n      if (storyType === 'text') {\n        // Text-only story - use JSON API\n        await createStory({\n          mediaType: 'TEXT',\n          textContent,\n          backgroundColor: textBackground,\n          category,\n          visibility,\n          linkUrl: linkUrl || undefined,\n          linkTitle: linkTitle || undefined,\n        });\n      } else {\n        // Media story - use FormData for file upload\n        const formData = new FormData();\n        formData.append('mediaType', storyType === 'video' ? 'VIDEO' : 'IMAGE');\n        \n        if (mediaFile) {\n          formData.append('media', mediaFile);\n        }\n        if (textContent) {\n          formData.append('textContent', textContent);\n        }\n        \n        formData.append('category', category);\n        formData.append('visibility', visibility);\n\n        if (linkUrl) {\n          formData.append('linkUrl', linkUrl);\n          if (linkTitle) {\n            formData.append('linkTitle', linkTitle);\n          }\n        }\n\n        await createStoryWithMedia(formData);\n      }\n      \n      onStoryCreated?.();\n      handleClose();\n    } catch (err: any) {\n      setError(err.message || 'Failed to create story');\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Cleanup\n    if (mediaPreview) {\n      URL.revokeObjectURL(mediaPreview);\n    }\n    setStep('select-type');\n    setStoryType(null);\n    setMediaFile(null);\n    setMediaPreview(null);\n    setTextContent('');\n    setTextBackground(TEXT_BACKGROUNDS[0]);\n    setLinkUrl('');\n    setLinkTitle('');\n    setCategory('GENERAL');\n    setVisibility('PUBLIC');\n    setError(null);\n    onClose();\n  };\n\n  const goBack = () => {\n    switch (step) {\n      case 'upload-media':\n        setStep('select-type');\n        setStoryType(null);\n        break;\n      case 'edit':\n        if (storyType === 'text') {\n          setStep('select-type');\n          setStoryType(null);\n        } else {\n          handleRemoveMedia();\n        }\n        break;\n      case 'details':\n        setStep('edit');\n        break;\n    }\n  };\n\n  const canProceed = () => {\n    if (step === 'edit') {\n      if (storyType === 'text') {\n        return textContent.trim().length > 0;\n      }\n      return !!mediaFile;\n    }\n    return true;\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <AnimatePresence>\n      <motion.div\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        exit={{ opacity: 0 }}\n        className=\"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center\"\n        onClick={handleClose}\n      >\n        <motion.div\n          initial={{ scale: 0.9, opacity: 0 }}\n          animate={{ scale: 1, opacity: 1 }}\n          exit={{ scale: 0.9, opacity: 0 }}\n          className=\"relative w-full max-w-lg h-[90vh] max-h-[700px] bg-neutral-900 rounded-3xl overflow-hidden flex flex-col\"\n          onClick={(e) => e.stopPropagation()}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-4 border-b border-neutral-800\">\n            <div className=\"flex items-center gap-2\">\n              {step !== 'select-type' && (\n                <button\n                  onClick={goBack}\n                  className=\"w-8 h-8 rounded-full hover:bg-neutral-800 flex items-center justify-center\"\n                >\n                  <ChevronLeft className=\"w-5 h-5 text-neutral-400\" />\n                </button>\n              )}\n              <h2 className=\"text-lg font-semibold text-white\">\n                {step === 'select-type' && 'Create Story'}\n                {step === 'upload-media' && 'Upload Media'}\n                {step === 'edit' && 'Edit Story'}\n                {step === 'details' && 'Story Details'}\n              </h2>\n            </div>\n            <button\n              onClick={handleClose}\n              className=\"w-8 h-8 rounded-full hover:bg-neutral-800 flex items-center justify-center\"\n            >\n              <X className=\"w-5 h-5 text-neutral-400\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto\">\n            {/* Step 1: Select Type */}\n            {step === 'select-type' && (\n              <div className=\"p-6\">\n                <p className=\"text-neutral-400 text-sm mb-6\">\n                  Choose how you want to share your moment\n                </p>\n                \n                <div className=\"grid grid-cols-1 gap-4\">\n                  {/* Image Option */}\n                  <motion.button\n                    whileHover={{ scale: 1.02 }}\n                    whileTap={{ scale: 0.98 }}\n                    onClick={() => handleTypeSelect('image')}\n                    className=\"flex items-center gap-4 p-4 bg-neutral-800/50 rounded-2xl border border-neutral-700/50 hover:border-blue-500/50 transition-colors group\"\n                  >\n                    <div className=\"w-14 h-14 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center\">\n                      <ImageIcon className=\"w-7 h-7 text-white\" />\n                    </div>\n                    <div className=\"text-left\">\n                      <h3 className=\"text-white font-medium group-hover:text-blue-400 transition-colors\">\n                        Photo\n                      </h3>\n                      <p className=\"text-neutral-500 text-sm\">\n                        Share an image from your gallery\n                      </p>\n                    </div>\n                    <ChevronRight className=\"w-5 h-5 text-neutral-600 ml-auto group-hover:text-blue-400 transition-colors\" />\n                  </motion.button>\n\n                  {/* Video Option */}\n                  <motion.button\n                    whileHover={{ scale: 1.02 }}\n                    whileTap={{ scale: 0.98 }}\n                    onClick={() => handleTypeSelect('video')}\n                    className=\"flex items-center gap-4 p-4 bg-neutral-800/50 rounded-2xl border border-neutral-700/50 hover:border-pink-500/50 transition-colors group\"\n                  >\n                    <div className=\"w-14 h-14 rounded-xl bg-gradient-to-br from-pink-500 to-red-600 flex items-center justify-center\">\n                      <Video className=\"w-7 h-7 text-white\" />\n                    </div>\n                    <div className=\"text-left\">\n                      <h3 className=\"text-white font-medium group-hover:text-pink-400 transition-colors\">\n                        Video\n                      </h3>\n                      <p className=\"text-neutral-500 text-sm\">\n                        Share a short video clip\n                      </p>\n                    </div>\n                    <ChevronRight className=\"w-5 h-5 text-neutral-600 ml-auto group-hover:text-pink-400 transition-colors\" />\n                  </motion.button>\n\n                  {/* Text Option */}\n                  <motion.button\n                    whileHover={{ scale: 1.02 }}\n                    whileTap={{ scale: 0.98 }}\n                    onClick={() => handleTypeSelect('text')}\n                    className=\"flex items-center gap-4 p-4 bg-neutral-800/50 rounded-2xl border border-neutral-700/50 hover:border-green-500/50 transition-colors group\"\n                  >\n                    <div className=\"w-14 h-14 rounded-xl bg-gradient-to-br from-green-500 to-emerald-600 flex items-center justify-center\">\n                      <Type className=\"w-7 h-7 text-white\" />\n                    </div>\n                    <div className=\"text-left\">\n                      <h3 className=\"text-white font-medium group-hover:text-green-400 transition-colors\">\n                        Text\n                      </h3>\n                      <p className=\"text-neutral-500 text-sm\">\n                        Share a thought or quote\n                      </p>\n                    </div>\n                    <ChevronRight className=\"w-5 h-5 text-neutral-600 ml-auto group-hover:text-green-400 transition-colors\" />\n                  </motion.button>\n                </div>\n\n                {/* AI Story Suggestion */}\n                <div className=\"mt-8 p-4 bg-gradient-to-br from-purple-900/30 to-blue-900/30 rounded-2xl border border-purple-500/20\">\n                  <div className=\"flex items-center gap-3 mb-2\">\n                    <Sparkles className=\"w-5 h-5 text-purple-400\" />\n                    <h4 className=\"text-white font-medium\">AI Story Ideas</h4>\n                  </div>\n                  <p className=\"text-neutral-400 text-sm\">\n                    Coming soon: Let AI help you create engaging professional stories!\n                  </p>\n                </div>\n              </div>\n            )}\n\n            {/* Step 2: Upload Media */}\n            {step === 'upload-media' && (\n              <div className=\"p-6\">\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  accept={storyType === 'video' ? 'video/*' : 'image/*'}\n                  onChange={handleFileSelect}\n                  className=\"hidden\"\n                />\n\n                <motion.button\n                  whileHover={{ scale: 1.02 }}\n                  whileTap={{ scale: 0.98 }}\n                  onClick={() => fileInputRef.current?.click()}\n                  className=\"w-full aspect-[9/16] max-h-[400px] rounded-2xl border-2 border-dashed border-neutral-700 hover:border-blue-500 transition-colors flex flex-col items-center justify-center gap-4 bg-neutral-800/30\"\n                >\n                  <div className=\"w-16 h-16 rounded-full bg-neutral-800 flex items-center justify-center\">\n                    <Upload className=\"w-8 h-8 text-neutral-400\" />\n                  </div>\n                  <div className=\"text-center\">\n                    <p className=\"text-white font-medium\">\n                      Tap to upload {storyType === 'video' ? 'video' : 'image'}\n                    </p>\n                    <p className=\"text-neutral-500 text-sm mt-1\">\n                      {storyType === 'video' ? 'MP4, MOV up to 50MB' : 'JPG, PNG up to 10MB'}\n                    </p>\n                  </div>\n                </motion.button>\n\n                {error && (\n                  <p className=\"mt-4 text-red-400 text-sm text-center\">{error}</p>\n                )}\n              </div>\n            )}\n\n            {/* Step 3: Edit */}\n            {step === 'edit' && (\n              <div className=\"flex flex-col h-full\">\n                {/* Preview */}\n                <div className=\"relative flex-1 min-h-[300px]\">\n                  {storyType === 'text' ? (\n                    <div\n                      className=\"absolute inset-0 flex items-center justify-center p-8\"\n                      style={{ background: textBackground }}\n                    >\n                      <textarea\n                        value={textContent}\n                        onChange={(e) => setTextContent(e.target.value)}\n                        placeholder=\"Type your story...\"\n                        className=\"w-full h-full bg-transparent text-white text-2xl font-bold text-center resize-none focus:outline-none placeholder-white/50\"\n                        maxLength={280}\n                      />\n                    </div>\n                  ) : (\n                    <div className=\"absolute inset-0 bg-black flex items-center justify-center\">\n                      {storyType === 'video' && mediaPreview ? (\n                        <video\n                          src={mediaPreview}\n                          className=\"max-w-full max-h-full object-contain\"\n                          controls\n                        />\n                      ) : mediaPreview ? (\n                        <Image\n                          src={mediaPreview}\n                          alt=\"Preview\"\n                          fill\n                          className=\"object-contain\"\n                        />\n                      ) : null}\n\n                      {/* Remove button */}\n                      <button\n                        onClick={handleRemoveMedia}\n                        className=\"absolute top-4 right-4 w-10 h-10 rounded-full bg-black/50 flex items-center justify-center\"\n                      >\n                        <Trash2 className=\"w-5 h-5 text-white\" />\n                      </button>\n                    </div>\n                  )}\n                </div>\n\n                {/* Text Background Picker (for text stories) */}\n                {storyType === 'text' && (\n                  <div className=\"p-4 border-t border-neutral-800\">\n                    <p className=\"text-neutral-400 text-sm mb-3\">Background</p>\n                    <div className=\"flex gap-2 overflow-x-auto pb-2\">\n                      {TEXT_BACKGROUNDS.map((bg, idx) => (\n                        <button\n                          key={idx}\n                          onClick={() => setTextBackground(bg)}\n                          className={`w-10 h-10 rounded-xl flex-shrink-0 ${\n                            textBackground === bg ? 'ring-2 ring-white ring-offset-2 ring-offset-neutral-900' : ''\n                          }`}\n                          style={{ background: bg }}\n                        />\n                      ))}\n                    </div>\n                    <p className=\"text-neutral-500 text-xs mt-2\">\n                      {textContent.length}/280 characters\n                    </p>\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Step 4: Details */}\n            {step === 'details' && (\n              <div className=\"p-6 space-y-6\">\n                {/* Category */}\n                <div>\n                  <label className=\"text-white font-medium mb-3 block\">Category</label>\n                  <div className=\"grid grid-cols-3 gap-2\">\n                    {STORY_CATEGORIES.map((cat) => (\n                      <button\n                        key={cat.value}\n                        onClick={() => setCategory(cat.value)}\n                        className={`p-3 rounded-xl border transition-colors flex flex-col items-center gap-1 ${\n                          category === cat.value\n                            ? 'bg-blue-500/20 border-blue-500 text-blue-400'\n                            : 'bg-neutral-800/50 border-neutral-700 text-neutral-400 hover:border-neutral-600'\n                        }`}\n                      >\n                        <span className=\"text-xl\">{cat.icon}</span>\n                        <span className=\"text-xs\">{cat.label}</span>\n                      </button>\n                    ))}\n                  </div>\n                </div>\n\n                {/* Visibility */}\n                <div>\n                  <label className=\"text-white font-medium mb-3 block\">Who can view</label>\n                  <div className=\"space-y-2\">\n                    {VISIBILITY_OPTIONS.map((opt) => (\n                      <button\n                        key={opt.value}\n                        onClick={() => setVisibility(opt.value)}\n                        className={`w-full p-3 rounded-xl border transition-colors flex items-center gap-3 ${\n                          visibility === opt.value\n                            ? 'bg-blue-500/20 border-blue-500'\n                            : 'bg-neutral-800/50 border-neutral-700 hover:border-neutral-600'\n                        }`}\n                      >\n                        <div className={`${visibility === opt.value ? 'text-blue-400' : 'text-neutral-400'}`}>\n                          {opt.icon}\n                        </div>\n                        <div className=\"flex-1 text-left\">\n                          <p className={`font-medium ${visibility === opt.value ? 'text-blue-400' : 'text-white'}`}>\n                            {opt.label}\n                          </p>\n                          <p className=\"text-neutral-500 text-sm\">{opt.desc}</p>\n                        </div>\n                        {visibility === opt.value && (\n                          <Check className=\"w-5 h-5 text-blue-400\" />\n                        )}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n\n                {/* Link (optional) */}\n                <div>\n                  <label className=\"text-white font-medium mb-3 flex items-center gap-2\">\n                    <Link2 className=\"w-4 h-4\" />\n                    Add Link (optional)\n                  </label>\n                  <input\n                    type=\"url\"\n                    value={linkUrl}\n                    onChange={(e) => setLinkUrl(e.target.value)}\n                    placeholder=\"https://...\"\n                    className=\"w-full px-4 py-3 bg-neutral-800 border border-neutral-700 rounded-xl text-white placeholder-neutral-500 focus:outline-none focus:border-blue-500\"\n                  />\n                  {linkUrl && (\n                    <input\n                      type=\"text\"\n                      value={linkTitle}\n                      onChange={(e) => setLinkTitle(e.target.value)}\n                      placeholder=\"Link title (optional)\"\n                      className=\"w-full px-4 py-3 mt-2 bg-neutral-800 border border-neutral-700 rounded-xl text-white placeholder-neutral-500 focus:outline-none focus:border-blue-500\"\n                    />\n                  )}\n                </div>\n\n                {error && (\n                  <p className=\"text-red-400 text-sm\">{error}</p>\n                )}\n              </div>\n            )}\n          </div>\n\n          {/* Footer */}\n          {(step === 'edit' || step === 'details') && (\n            <div className=\"p-4 border-t border-neutral-800\">\n              {step === 'edit' ? (\n                <button\n                  onClick={() => setStep('details')}\n                  disabled={!canProceed()}\n                  className=\"w-full py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white font-semibold rounded-xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\n                >\n                  Continue\n                  <ChevronRight className=\"w-5 h-5\" />\n                </button>\n              ) : (\n                <button\n                  onClick={handleSubmit}\n                  disabled={isUploading}\n                  className=\"w-full py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white font-semibold rounded-xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\n                >\n                  {isUploading ? (\n                    <>\n                      <Loader2 className=\"w-5 h-5 animate-spin\" />\n                      Sharing...\n                    </>\n                  ) : (\n                    <>\n                      <Sparkles className=\"w-5 h-5\" />\n                      Share Story\n                    </>\n                  )}\n                </button>\n              )}\n            </div>\n          )}\n        </motion.div>\n      </motion.div>\n    </AnimatePresence>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2791, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/stories/StoryHighlights.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { motion } from 'framer-motion';\nimport { Plus, Play, Lock } from 'lucide-react';\nimport Image from 'next/image';\nimport { getUserHighlights, getHighlightStories, type StoryHighlight, type Story } from '@/lib/api/stories';\n\ninterface StoryHighlightsProps {\n  userId: string;\n  isOwnProfile?: boolean;\n  onCreateHighlight?: () => void;\n}\n\nexport function StoryHighlights({ userId, isOwnProfile = false, onCreateHighlight }: StoryHighlightsProps) {\n  const [highlights, setHighlights] = useState<StoryHighlight[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedHighlight, setSelectedHighlight] = useState<StoryHighlight | null>(null);\n  const [highlightStories, setHighlightStories] = useState<Story[]>([]);\n\n  useEffect(() => {\n    fetchHighlights();\n  }, [userId]);\n\n  const fetchHighlights = async () => {\n    try {\n      const response = await getUserHighlights(userId);\n      setHighlights(response.highlights);\n    } catch (error) {\n      console.error('Error fetching highlights:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleHighlightClick = async (highlight: StoryHighlight) => {\n    setSelectedHighlight(highlight);\n    try {\n      const response = await getHighlightStories(highlight.id);\n      setHighlightStories(response.highlight.stories);\n      // Open story viewer with these stories\n    } catch (error) {\n      console.error('Error fetching highlight stories:', error);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex gap-4 overflow-x-auto pb-4 scrollbar-hide\">\n        {[...Array(4)].map((_, i) => (\n          <div key={i} className=\"flex flex-col items-center gap-2 flex-shrink-0 animate-pulse\">\n            <div className=\"w-16 h-16 rounded-2xl bg-neutral-800\" />\n            <div className=\"w-12 h-3 rounded bg-neutral-800\" />\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  if (highlights.length === 0 && !isOwnProfile) {\n    return null;\n  }\n\n  return (\n    <div className=\"mb-6\">\n      <h3 className=\"text-white font-semibold mb-4\">Story Highlights</h3>\n      \n      <div className=\"flex gap-4 overflow-x-auto pb-2 scrollbar-hide\">\n        {/* Create New Highlight Button (for own profile) */}\n        {isOwnProfile && (\n          <motion.button\n            whileHover={{ scale: 1.05 }}\n            whileTap={{ scale: 0.95 }}\n            onClick={onCreateHighlight}\n            className=\"flex flex-col items-center gap-2 flex-shrink-0\"\n          >\n            <div className=\"w-16 h-16 rounded-2xl bg-neutral-800/50 border-2 border-dashed border-neutral-700 flex items-center justify-center hover:border-blue-500/50 transition-colors\">\n              <Plus className=\"w-6 h-6 text-neutral-400\" />\n            </div>\n            <span className=\"text-xs text-neutral-500\">New</span>\n          </motion.button>\n        )}\n\n        {/* Highlights */}\n        {highlights.map((highlight, index) => (\n          <motion.button\n            key={highlight.id}\n            initial={{ opacity: 0, y: 10 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: index * 0.05 }}\n            whileHover={{ scale: 1.05 }}\n            whileTap={{ scale: 0.95 }}\n            onClick={() => handleHighlightClick(highlight)}\n            className=\"flex flex-col items-center gap-2 flex-shrink-0 group\"\n          >\n            {/* Highlight Cover */}\n            <div className=\"relative w-16 h-16 rounded-2xl overflow-hidden ring-2 ring-neutral-700 group-hover:ring-blue-500 transition-all\">\n              {highlight.coverImage ? (\n                <Image\n                  src={highlight.coverImage}\n                  alt={highlight.title}\n                  fill\n                  className=\"object-cover\"\n                />\n              ) : (\n                <div className=\"w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center\">\n                  <span className=\"text-white text-xl\">\n                    {highlight.title.charAt(0)}\n                  </span>\n                </div>\n              )}\n\n              {/* Story Count Badge */}\n              <div className=\"absolute bottom-1 right-1 flex items-center gap-0.5 bg-black/60 rounded-full px-1.5 py-0.5\">\n                <Play className=\"w-2.5 h-2.5 text-white\" fill=\"white\" />\n                <span className=\"text-[10px] text-white font-medium\">{highlight.storiesCount}</span>\n              </div>\n\n              {/* Privacy Indicator */}\n              {!highlight.isPublic && (\n                <div className=\"absolute top-1 left-1 w-4 h-4 bg-black/60 rounded-full flex items-center justify-center\">\n                  <Lock className=\"w-2.5 h-2.5 text-white\" />\n                </div>\n              )}\n\n              {/* Hover Overlay */}\n              <div className=\"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center\">\n                <Play className=\"w-6 h-6 text-white\" fill=\"white\" />\n              </div>\n            </div>\n\n            {/* Highlight Title */}\n            <span className=\"text-xs text-neutral-400 truncate max-w-16 group-hover:text-white transition-colors\">\n              {highlight.title}\n            </span>\n          </motion.button>\n        ))}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3068, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/stories/index.ts"],"sourcesContent":["// Stories Components\nexport { StoryCarousel } from './StoryCarousel';\nexport { StoryViewer } from './StoryViewer';\nexport { StoryCreator } from './StoryCreator';\nexport { StoryHighlights } from './StoryHighlights';\n"],"names":[],"mappings":"AAAA,qBAAqB;;AACrB;AACA;AACA;AACA"}}]
}