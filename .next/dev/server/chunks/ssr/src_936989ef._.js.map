{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Videos/vormex/vormex-web/src/components/auth/ProtectedRoute.tsx"],"sourcesContent":["'use client';\n\nimport React from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useAuth } from '@/lib/auth/useAuth';\n\ninterface ProtectedRouteProps {\n  children: React.ReactNode;\n}\n\nexport function ProtectedRoute({ children }: ProtectedRouteProps) {\n  const { isAuthenticated, loading } = useAuth();\n  const router = useRouter();\n\n  React.useEffect(() => {\n    if (!loading && !isAuthenticated) {\n      router.push('/login');\n    }\n  }, [isAuthenticated, loading, router]);\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!isAuthenticated) {\n    return null;\n  }\n\n  return <>{children}</>;\n}\n\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAUO,SAAS,eAAe,EAAE,QAAQ,EAAuB;IAC9D,MAAM,EAAE,eAAe,EAAE,OAAO,EAAE,GAAG,IAAA,wIAAO;IAC5C,MAAM,SAAS,IAAA,+IAAS;IAExB,gNAAK,CAAC,SAAS,CAAC;QACd,IAAI,CAAC,WAAW,CAAC,iBAAiB;YAChC,OAAO,IAAI,CAAC;QACd;IACF,GAAG;QAAC;QAAiB;QAAS;KAAO;IAErC,IAAI,SAAS;QACX,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;;;;;kCACf,8OAAC;wBAAE,WAAU;kCAAqB;;;;;;;;;;;;;;;;;IAI1C;IAEA,IAAI,CAAC,iBAAiB;QACpB,OAAO;IACT;IAEA,qBAAO;kBAAG;;AACZ"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Videos/vormex/vormex-web/src/lib/api/chat.ts"],"sourcesContent":["import apiClient from './client';\n\n// ============================================\n// Types\n// ============================================\n\nexport interface ChatUser {\n  id: string;\n  username: string;\n  name: string;\n  profileImage: string | null;\n  isOnline: boolean;\n  lastActiveAt: string | null;\n}\n\nexport interface Message {\n  id: string;\n  conversationId: string;\n  senderId: string;\n  receiverId: string;\n  content: string;\n  contentType: string;\n  mediaUrl?: string;\n  mediaType?: string;\n  fileName?: string;\n  fileSize?: number;\n  status: 'SENT' | 'DELIVERED' | 'READ';\n  deliveredAt?: string;\n  readAt?: string;\n  isDeleted: boolean;\n  replyToId?: string;\n  replyTo?: {\n    id: string;\n    content: string;\n    contentType: string;\n    senderId: string;\n  };\n  sender: ChatUser;\n  reactions: MessageReaction[];\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface MessageReaction {\n  id: string;\n  userId: string;\n  emoji: string;\n  user: {\n    id: string;\n    username: string;\n    name: string;\n  };\n}\n\nexport interface Conversation {\n  id: string;\n  participant1Id: string;\n  participant2Id: string;\n  participant1: ChatUser;\n  participant2: ChatUser;\n  otherParticipant: ChatUser;\n  lastMessage?: {\n    id: string;\n    content: string;\n    contentType: string;\n    senderId: string;\n    status: 'SENT' | 'DELIVERED' | 'READ';\n    createdAt: string;\n  };\n  lastMessageAt?: string;\n  unreadCount: number;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface ConversationsResponse {\n  conversations: Conversation[];\n  hasMore: boolean;\n  nextCursor?: string;\n}\n\nexport interface MessagesResponse {\n  messages: Message[];\n  hasMore: boolean;\n  nextCursor?: string;\n}\n\n// ============================================\n// Chat API Functions\n// ============================================\n\n/**\n * Get all conversations for the current user\n */\nexport async function getConversations(\n  limit?: number,\n  cursor?: string\n): Promise<ConversationsResponse> {\n  const params = new URLSearchParams();\n  if (limit) params.append('limit', String(limit));\n  if (cursor) params.append('cursor', cursor);\n  \n  return apiClient.get(`/chat/conversations?${params.toString()}`);\n}\n\n/**\n * Get or create a conversation with another user\n */\nexport async function getOrCreateConversation(participantId: string): Promise<Conversation> {\n  return apiClient.post('/chat/conversations', { participantId });\n}\n\n/**\n * Get a specific conversation\n */\nexport async function getConversation(conversationId: string): Promise<Conversation> {\n  return apiClient.get(`/chat/conversations/${conversationId}`);\n}\n\n/**\n * Get messages for a conversation\n */\nexport async function getMessages(\n  conversationId: string,\n  limit?: number,\n  cursor?: string\n): Promise<MessagesResponse> {\n  const params = new URLSearchParams();\n  if (limit) params.append('limit', String(limit));\n  if (cursor) params.append('cursor', cursor);\n  \n  return apiClient.get(`/chat/conversations/${conversationId}/messages?${params.toString()}`);\n}\n\n/**\n * Send a message (REST fallback - prefer WebSocket)\n */\nexport async function sendMessage(\n  conversationId: string,\n  data: {\n    content: string;\n    contentType?: string;\n    mediaUrl?: string;\n    mediaType?: string;\n    fileName?: string;\n    fileSize?: number;\n    replyToId?: string;\n  }\n): Promise<Message> {\n  return apiClient.post(`/chat/conversations/${conversationId}/messages`, data);\n}\n\n/**\n * Mark messages as read\n */\nexport async function markAsRead(conversationId: string): Promise<{ updatedCount: number; readAt: string }> {\n  return apiClient.post(`/chat/conversations/${conversationId}/read`);\n}\n\n/**\n * Delete a message\n */\nexport async function deleteMessage(\n  messageId: string,\n  forEveryone?: boolean\n): Promise<{ success: boolean }> {\n  return apiClient.delete(`/chat/messages/${messageId}`, { \n    data: { forEveryone } \n  });\n}\n\n/**\n * Edit a message\n */\nexport async function editMessage(messageId: string, content: string): Promise<Message> {\n  return apiClient.patch(`/chat/messages/${messageId}`, { content });\n}\n\n/**\n * Add reaction to a message\n */\nexport async function addReaction(\n  messageId: string,\n  emoji: string\n): Promise<{ action: 'added' | 'removed' | 'updated'; emoji: string }> {\n  return apiClient.post(`/chat/messages/${messageId}/reactions`, { emoji });\n}\n\n/**\n * Get unread message count\n */\nexport async function getUnreadCount(): Promise<{ unreadCount: number }> {\n  return apiClient.get('/chat/unread-count');\n}\n\n/**\n * Search messages\n */\nexport async function searchMessages(\n  query: string,\n  limit?: number\n): Promise<{ messages: Message[] }> {\n  const params = new URLSearchParams();\n  params.append('q', query);\n  if (limit) params.append('limit', String(limit));\n  \n  return apiClient.get(`/chat/search?${params.toString()}`);\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AA8FO,eAAe,iBACpB,KAAc,EACd,MAAe;IAEf,MAAM,SAAS,IAAI;IACnB,IAAI,OAAO,OAAO,MAAM,CAAC,SAAS,OAAO;IACzC,IAAI,QAAQ,OAAO,MAAM,CAAC,UAAU;IAEpC,OAAO,sIAAS,CAAC,GAAG,CAAC,CAAC,oBAAoB,EAAE,OAAO,QAAQ,IAAI;AACjE;AAKO,eAAe,wBAAwB,aAAqB;IACjE,OAAO,sIAAS,CAAC,IAAI,CAAC,uBAAuB;QAAE;IAAc;AAC/D;AAKO,eAAe,gBAAgB,cAAsB;IAC1D,OAAO,sIAAS,CAAC,GAAG,CAAC,CAAC,oBAAoB,EAAE,gBAAgB;AAC9D;AAKO,eAAe,YACpB,cAAsB,EACtB,KAAc,EACd,MAAe;IAEf,MAAM,SAAS,IAAI;IACnB,IAAI,OAAO,OAAO,MAAM,CAAC,SAAS,OAAO;IACzC,IAAI,QAAQ,OAAO,MAAM,CAAC,UAAU;IAEpC,OAAO,sIAAS,CAAC,GAAG,CAAC,CAAC,oBAAoB,EAAE,eAAe,UAAU,EAAE,OAAO,QAAQ,IAAI;AAC5F;AAKO,eAAe,YACpB,cAAsB,EACtB,IAQC;IAED,OAAO,sIAAS,CAAC,IAAI,CAAC,CAAC,oBAAoB,EAAE,eAAe,SAAS,CAAC,EAAE;AAC1E;AAKO,eAAe,WAAW,cAAsB;IACrD,OAAO,sIAAS,CAAC,IAAI,CAAC,CAAC,oBAAoB,EAAE,eAAe,KAAK,CAAC;AACpE;AAKO,eAAe,cACpB,SAAiB,EACjB,WAAqB;IAErB,OAAO,sIAAS,CAAC,MAAM,CAAC,CAAC,eAAe,EAAE,WAAW,EAAE;QACrD,MAAM;YAAE;QAAY;IACtB;AACF;AAKO,eAAe,YAAY,SAAiB,EAAE,OAAe;IAClE,OAAO,sIAAS,CAAC,KAAK,CAAC,CAAC,eAAe,EAAE,WAAW,EAAE;QAAE;IAAQ;AAClE;AAKO,eAAe,YACpB,SAAiB,EACjB,KAAa;IAEb,OAAO,sIAAS,CAAC,IAAI,CAAC,CAAC,eAAe,EAAE,UAAU,UAAU,CAAC,EAAE;QAAE;IAAM;AACzE;AAKO,eAAe;IACpB,OAAO,sIAAS,CAAC,GAAG,CAAC;AACvB;AAKO,eAAe,eACpB,KAAa,EACb,KAAc;IAEd,MAAM,SAAS,IAAI;IACnB,OAAO,MAAM,CAAC,KAAK;IACnB,IAAI,OAAO,OAAO,MAAM,CAAC,SAAS,OAAO;IAEzC,OAAO,sIAAS,CAAC,GAAG,CAAC,CAAC,aAAa,EAAE,OAAO,QAAQ,IAAI;AAC1D"}},
    {"offset": {"line": 155, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Videos/vormex/vormex-web/src/components/chat/ChatList.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useState, useCallback } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { getConversations, Conversation } from '@/lib/api/chat';\nimport { initializeSocket, getSocket } from '@/lib/socket';\nimport { formatDistanceToNow } from 'date-fns';\nimport { cn } from '@/lib/utils';\n\ninterface ChatListProps {\n  selectedConversationId?: string;\n  onSelectConversation?: (conversation: Conversation) => void;\n  currentUserId?: string;\n}\n\nexport default function ChatList({ \n  selectedConversationId, \n  onSelectConversation,\n  currentUserId \n}: ChatListProps) {\n  const router = useRouter();\n  const [conversations, setConversations] = useState<Conversation[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [hasMore, setHasMore] = useState(false);\n  const [nextCursor, setNextCursor] = useState<string | undefined>();\n\n  const fetchConversations = useCallback(async (cursor?: string) => {\n    try {\n      setLoading(true);\n      const result = await getConversations(30, cursor);\n      \n      if (cursor) {\n        setConversations(prev => [...prev, ...result.conversations]);\n      } else {\n        setConversations(result.conversations);\n      }\n      \n      setHasMore(result.hasMore);\n      setNextCursor(result.nextCursor);\n    } catch (err: any) {\n      setError(err.message || 'Failed to load conversations');\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchConversations();\n  }, [fetchConversations]);\n\n  // Listen for new messages to update conversation list\n  useEffect(() => {\n    const socket = getSocket();\n    \n    if (!socket) return;\n\n    const handleNewMessage = (data: { conversationId: string; message: any }) => {\n      setConversations(prev => {\n        const existingIndex = prev.findIndex(c => c.id === data.conversationId);\n        \n        if (existingIndex >= 0) {\n          // Update existing conversation and move to top\n          const updated = [...prev];\n          const conv = { ...updated[existingIndex] };\n          conv.lastMessage = {\n            id: data.message.id,\n            content: data.message.content,\n            contentType: data.message.contentType,\n            senderId: data.message.senderId,\n            status: data.message.status,\n            createdAt: data.message.createdAt,\n          };\n          conv.lastMessageAt = data.message.createdAt;\n          \n          // Increment unread if not the sender\n          if (data.message.senderId !== currentUserId && data.conversationId !== selectedConversationId) {\n            conv.unreadCount = (conv.unreadCount || 0) + 1;\n          }\n          \n          updated.splice(existingIndex, 1);\n          return [conv, ...updated];\n        }\n        \n        // Refresh to get new conversation\n        fetchConversations();\n        return prev;\n      });\n    };\n\n    const handleMessagesRead = (data: { conversationId: string }) => {\n      setConversations(prev => \n        prev.map(c => \n          c.id === data.conversationId \n            ? { ...c, unreadCount: 0 } \n            : c\n        )\n      );\n    };\n\n    socket.on('chat:new_message', handleNewMessage);\n    socket.on('chat:notification', handleNewMessage);\n    socket.on('chat:messages_read', handleMessagesRead);\n\n    return () => {\n      socket.off('chat:new_message', handleNewMessage);\n      socket.off('chat:notification', handleNewMessage);\n      socket.off('chat:messages_read', handleMessagesRead);\n    };\n  }, [currentUserId, selectedConversationId, fetchConversations]);\n\n  const handleSelectConversation = (conversation: Conversation) => {\n    if (onSelectConversation) {\n      onSelectConversation(conversation);\n    } else {\n      router.push(`/messages/${conversation.id}`);\n    }\n  };\n\n  const loadMore = () => {\n    if (hasMore && nextCursor) {\n      fetchConversations(nextCursor);\n    }\n  };\n\n  if (loading && conversations.length === 0) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"p-4 text-center text-red-500\">\n        {error}\n        <button \n          onClick={() => fetchConversations()}\n          className=\"block mx-auto mt-2 text-blue-500 hover:underline\"\n        >\n          Retry\n        </button>\n      </div>\n    );\n  }\n\n  if (conversations.length === 0) {\n    return (\n      <div className=\"p-8 text-center text-gray-500 dark:text-gray-400\">\n        <div className=\"text-4xl mb-4\">üí¨</div>\n        <p>No conversations yet</p>\n        <p className=\"text-sm mt-2\">Start a chat with someone!</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex flex-col h-full\">\n      <div className=\"flex-1 overflow-y-auto\">\n        {conversations.map((conversation) => (\n          <ConversationItem\n            key={conversation.id}\n            conversation={conversation}\n            isSelected={selectedConversationId === conversation.id}\n            currentUserId={currentUserId}\n            onClick={() => handleSelectConversation(conversation)}\n          />\n        ))}\n        \n        {hasMore && (\n          <button\n            onClick={loadMore}\n            disabled={loading}\n            className=\"w-full py-3 text-sm text-blue-600 hover:bg-gray-50 dark:hover:bg-gray-800\"\n          >\n            {loading ? 'Loading...' : 'Load more'}\n          </button>\n        )}\n      </div>\n    </div>\n  );\n}\n\n// ============================================\n// Conversation Item Component\n// ============================================\ninterface ConversationItemProps {\n  conversation: Conversation;\n  isSelected: boolean;\n  currentUserId?: string;\n  onClick: () => void;\n}\n\nfunction ConversationItem({ \n  conversation, \n  isSelected, \n  currentUserId,\n  onClick \n}: ConversationItemProps) {\n  const other = conversation.otherParticipant;\n  const lastMessage = conversation.lastMessage;\n  const isUnread = conversation.unreadCount > 0;\n  const isSentByMe = lastMessage?.senderId === currentUserId;\n\n  return (\n    <div\n      onClick={onClick}\n      className={cn(\n        'flex items-center gap-3 p-3 cursor-pointer transition-colors border-b border-gray-100 dark:border-gray-800',\n        isSelected \n          ? 'bg-blue-50 dark:bg-blue-900/20' \n          : 'hover:bg-gray-50 dark:hover:bg-gray-800/50',\n        isUnread && !isSelected && 'bg-gray-50 dark:bg-gray-800/30'\n      )}\n    >\n      {/* Avatar */}\n      <div className=\"relative flex-shrink-0\">\n        <div className=\"w-12 h-12 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white font-semibold\">\n          {other.profileImage ? (\n            <img\n              src={other.profileImage}\n              alt={other.name}\n              className=\"w-12 h-12 rounded-full object-cover\"\n            />\n          ) : (\n            other.name.charAt(0).toUpperCase()\n          )}\n        </div>\n        {/* Online indicator */}\n        {other.isOnline && (\n          <div className=\"absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-gray-900\"></div>\n        )}\n      </div>\n\n      {/* Content */}\n      <div className=\"flex-1 min-w-0\">\n        <div className=\"flex items-center justify-between\">\n          <span className={cn(\n            'font-medium truncate',\n            isUnread && 'text-gray-900 dark:text-white font-semibold'\n          )}>\n            {other.name}\n          </span>\n          {lastMessage && (\n            <span className=\"text-xs text-gray-500 flex-shrink-0\">\n              {formatDistanceToNow(new Date(lastMessage.createdAt), { addSuffix: false })}\n            </span>\n          )}\n        </div>\n        \n        <div className=\"flex items-center gap-1\">\n          {lastMessage ? (\n            <>\n              {isSentByMe && (\n                <span className=\"text-gray-400 text-sm\">\n                  {lastMessage.status === 'READ' ? '‚úì‚úì' : lastMessage.status === 'DELIVERED' ? '‚úì‚úì' : '‚úì'}\n                </span>\n              )}\n              <p className={cn(\n                'text-sm truncate',\n                isUnread \n                  ? 'text-gray-900 dark:text-white font-medium' \n                  : 'text-gray-500 dark:text-gray-400'\n              )}>\n                {lastMessage.contentType === 'image' ? 'üì∑ Photo' :\n                 lastMessage.contentType === 'file' ? 'üìé File' :\n                 lastMessage.contentType === 'voice' ? 'üé§ Voice message' :\n                 lastMessage.content}\n              </p>\n            </>\n          ) : (\n            <p className=\"text-sm text-gray-400 italic\">No messages yet</p>\n          )}\n        </div>\n      </div>\n\n      {/* Unread badge */}\n      {isUnread && (\n        <div className=\"flex-shrink-0 w-5 h-5 bg-blue-600 rounded-full flex items-center justify-center\">\n          <span className=\"text-xs text-white font-medium\">\n            {conversation.unreadCount > 9 ? '9+' : conversation.unreadCount}\n          </span>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 521, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Videos/vormex/vormex-web/src/components/chat/ChatMessages.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\nimport { Message, getMessages, MessagesResponse } from '@/lib/api/chat';\nimport { \n  getSocket, \n  joinChatRoom, \n  leaveChatRoom, \n  markChatAsRead,\n  deleteChatMessage,\n  editChatMessage,\n  reactToChatMessage\n} from '@/lib/socket';\nimport { format, isToday, isYesterday, isSameDay } from 'date-fns';\nimport { cn } from '@/lib/utils';\nimport MessageMenu, { MessageQuickActions } from './MessageMenu';\nimport { WALLPAPER_OPTIONS } from './ChatSettingsPanel';\n\ninterface ChatMessagesProps {\n  conversationId: string;\n  currentUserId: string;\n  otherUser: {\n    id: string;\n    name: string;\n    username: string;\n    profileImage?: string | null;\n    isOnline?: boolean;\n  };\n  wallpaper?: string;\n  onReply?: (message: { id: string; content: string; senderName: string }) => void;\n}\n\nconst REACTION_EMOJIS = ['‚ù§Ô∏è', 'üëç', 'üòÇ', 'üòÆ', 'üò¢', 'üôè'];\n\nexport default function ChatMessages({\n  conversationId,\n  currentUserId,\n  otherUser,\n  wallpaper = 'default',\n  onReply,\n}: ChatMessagesProps) {\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [loadingMore, setLoadingMore] = useState(false);\n  const [hasMore, setHasMore] = useState(false);\n  const [nextCursor, setNextCursor] = useState<string | undefined>();\n  const [typingUser, setTypingUser] = useState<string | null>(null);\n  \n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const messagesContainerRef = useRef<HTMLDivElement>(null);\n  const [shouldAutoScroll, setShouldAutoScroll] = useState(true);\n\n  // Fetch messages\n  const fetchMessages = useCallback(async (cursor?: string) => {\n    try {\n      if (cursor) {\n        setLoadingMore(true);\n      } else {\n        setLoading(true);\n      }\n\n      const result = await getMessages(conversationId, 50, cursor);\n\n      if (cursor) {\n        // Prepend older messages\n        setMessages(prev => [...result.messages, ...prev]);\n      } else {\n        setMessages(result.messages);\n      }\n\n      setHasMore(result.hasMore);\n      setNextCursor(result.nextCursor);\n    } catch (err: any) {\n      console.error('Failed to fetch messages:', err);\n    } finally {\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [conversationId]);\n\n  // Initial load and join room\n  useEffect(() => {\n    fetchMessages();\n    joinChatRoom(conversationId);\n    markChatAsRead(conversationId);\n\n    return () => {\n      leaveChatRoom(conversationId);\n    };\n  }, [conversationId, fetchMessages]);\n\n  // Socket event listeners\n  useEffect(() => {\n    const socket = getSocket();\n    if (!socket) return;\n\n    const handleNewMessage = (data: { conversationId: string; message: Message }) => {\n      if (data.conversationId === conversationId) {\n        setMessages(prev => [...prev, data.message]);\n        setShouldAutoScroll(true);\n        \n        // Mark as read if from other user\n        if (data.message.senderId !== currentUserId) {\n          markChatAsRead(conversationId);\n        }\n      }\n    };\n\n    const handleTyping = (data: { conversationId: string; userId: string; isTyping: boolean }) => {\n      if (data.conversationId === conversationId && data.userId !== currentUserId) {\n        setTypingUser(data.isTyping ? data.userId : null);\n      }\n    };\n\n    const handleMessagesRead = (data: { conversationId: string; readBy: string; readAt: Date }) => {\n      if (data.conversationId === conversationId) {\n        setMessages(prev => \n          prev.map(m => \n            m.senderId === currentUserId && m.status !== 'READ'\n              ? { ...m, status: 'READ', readAt: new Date(data.readAt).toISOString() }\n              : m\n          )\n        );\n      }\n    };\n\n    const handleMessagesDelivered = (data: { conversationId: string; deliveredAt: Date }) => {\n      if (data.conversationId === conversationId) {\n        setMessages(prev => \n          prev.map(m => \n            m.senderId === currentUserId && m.status === 'SENT'\n              ? { ...m, status: 'DELIVERED', deliveredAt: new Date(data.deliveredAt).toISOString() }\n              : m\n          )\n        );\n      }\n    };\n\n    const handleError = (data: { message: string }) => {\n      console.error('Chat socket error:', data.message);\n    };\n\n    const handleMessageDeleted = (data: { messageId: string; conversationId: string; forEveryone: boolean }) => {\n      if (data.conversationId === conversationId) {\n        if (data.forEveryone) {\n          setMessages(prev => \n            prev.map(m => \n              m.id === data.messageId \n                ? { ...m, isDeleted: true, content: 'This message was deleted' } \n                : m\n            )\n          );\n        } else {\n          setMessages(prev => prev.filter(m => m.id !== data.messageId));\n        }\n      }\n    };\n\n    const handleMessageEdited = (data: { messageId: string; conversationId: string; content: string; editedAt: Date }) => {\n      if (data.conversationId === conversationId) {\n        setMessages(prev => \n          prev.map(m => \n            m.id === data.messageId \n              ? { ...m, content: data.content, updatedAt: String(data.editedAt) } \n              : m\n          )\n        );\n      }\n    };\n\n    const handleReaction = (data: { messageId: string; conversationId: string; userId: string; emoji: string; action: string }) => {\n      if (data.conversationId === conversationId) {\n        setMessages(prev => \n          prev.map(m => {\n            if (m.id !== data.messageId) return m;\n            \n            let reactions = [...(m.reactions || [])];\n            \n            if (data.action === 'removed') {\n              reactions = reactions.filter(r => !(r.userId === data.userId));\n            } else if (data.action === 'added') {\n              reactions.push({\n                id: `temp-${Date.now()}`,\n                userId: data.userId,\n                emoji: data.emoji,\n                user: { id: data.userId, username: '', name: '' }\n              });\n            } else if (data.action === 'updated') {\n              const index = reactions.findIndex(r => r.userId === data.userId);\n              if (index >= 0) {\n                reactions[index] = { ...reactions[index], emoji: data.emoji };\n              }\n            }\n            \n            return { ...m, reactions };\n          })\n        );\n      }\n    };\n\n    socket.on('chat:new_message', handleNewMessage);\n    socket.on('chat:user_typing', handleTyping);\n    socket.on('chat:messages_read', handleMessagesRead);\n    socket.on('chat:messages_delivered', handleMessagesDelivered);\n    socket.on('chat:message_deleted', handleMessageDeleted);\n    socket.on('chat:message_edited', handleMessageEdited);\n    socket.on('chat:message_reaction', handleReaction);\n    socket.on('error', handleError);\n\n    return () => {\n      socket.off('chat:new_message', handleNewMessage);\n      socket.off('chat:user_typing', handleTyping);\n      socket.off('chat:messages_read', handleMessagesRead);\n      socket.off('chat:messages_delivered', handleMessagesDelivered);\n      socket.off('chat:message_deleted', handleMessageDeleted);\n      socket.off('chat:message_edited', handleMessageEdited);\n      socket.off('chat:message_reaction', handleReaction);\n      socket.off('error', handleError);\n    };\n  }, [conversationId, currentUserId, otherUser.id]);\n\n  // Auto-scroll to bottom\n  useEffect(() => {\n    if (shouldAutoScroll && messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\n      setShouldAutoScroll(false);\n    }\n  }, [messages, shouldAutoScroll]);\n\n  // Scroll detection for loading more\n  const handleScroll = (e: React.UIEvent<HTMLDivElement>) => {\n    const target = e.currentTarget;\n    if (target.scrollTop < 100 && hasMore && !loadingMore) {\n      fetchMessages(nextCursor);\n    }\n  };\n\n  // Group messages by date\n  const groupedMessages = messages.reduce((groups, message) => {\n    const date = new Date(message.createdAt);\n    const dateKey = format(date, 'yyyy-MM-dd');\n    \n    if (!groups[dateKey]) {\n      groups[dateKey] = [];\n    }\n    groups[dateKey].push(message);\n    \n    return groups;\n  }, {} as Record<string, Message[]>);\n\n  if (loading) {\n    return (\n      <div className=\"flex-1 flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div \n      ref={messagesContainerRef}\n      className=\"flex-1 overflow-y-auto p-4 space-y-4\"\n      onScroll={handleScroll}\n    >\n      {loadingMore && (\n        <div className=\"flex justify-center py-2\">\n          <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n        </div>\n      )}\n\n      {Object.entries(groupedMessages).map(([dateKey, dateMessages]) => (\n        <div key={dateKey}>\n          {/* Date separator */}\n          <div className=\"flex items-center justify-center my-4\">\n            <div className=\"bg-gray-200 dark:bg-gray-700 px-3 py-1 rounded-full text-xs text-gray-600 dark:text-gray-300\">\n              {formatDateSeparator(new Date(dateKey))}\n            </div>\n          </div>\n\n          {/* Messages for this date */}\n          {dateMessages.map((message, index) => {\n            const prevMessage = index > 0 ? dateMessages[index - 1] : null;\n            const showAvatar = !prevMessage || prevMessage.senderId !== message.senderId;\n            \n            return (\n              <MessageBubble\n                key={message.id}\n                message={message}\n                isOwn={message.senderId === currentUserId}\n                showAvatar={showAvatar}\n                otherUser={otherUser}\n                conversationId={conversationId}\n              />\n            );\n          })}\n        </div>\n      ))}\n\n      {/* Typing indicator */}\n      {typingUser && (\n        <div className=\"flex items-center gap-2 text-gray-500 text-sm\">\n          <div className=\"flex gap-1\">\n            <span className=\"animate-bounce\">‚Ä¢</span>\n            <span className=\"animate-bounce\" style={{ animationDelay: '0.1s' }}>‚Ä¢</span>\n            <span className=\"animate-bounce\" style={{ animationDelay: '0.2s' }}>‚Ä¢</span>\n          </div>\n          <span>{otherUser.name} is typing...</span>\n        </div>\n      )}\n\n      <div ref={messagesEndRef} />\n    </div>\n  );\n}\n\n// ============================================\n// Message Bubble Component\n// ============================================\ninterface MessageBubbleProps {\n  message: Message;\n  isOwn: boolean;\n  showAvatar: boolean;\n  otherUser: {\n    name: string;\n    profileImage?: string | null;\n  };\n  conversationId: string;\n}\n\nfunction MessageBubble({ \n  message, \n  isOwn, \n  showAvatar, \n  otherUser,\n  conversationId \n}: MessageBubbleProps) {\n  const [showActions, setShowActions] = useState(false);\n  const [showReactions, setShowReactions] = useState(false);\n  const [isEditing, setIsEditing] = useState(false);\n  const [editContent, setEditContent] = useState(message.content);\n\n  const handleDelete = (forEveryone: boolean) => {\n    deleteChatMessage(message.id, conversationId, forEveryone);\n    setShowActions(false);\n  };\n\n  const handleEdit = () => {\n    if (editContent.trim() && editContent !== message.content) {\n      editChatMessage(message.id, conversationId, editContent);\n    }\n    setIsEditing(false);\n  };\n\n  const handleReaction = (emoji: string) => {\n    reactToChatMessage(message.id, conversationId, emoji);\n    setShowReactions(false);\n  };\n\n  if (message.isDeleted) {\n    return (\n      <div className={cn(\n        'flex items-center gap-2',\n        isOwn ? 'justify-end' : 'justify-start'\n      )}>\n        <div className=\"bg-gray-100 dark:bg-gray-800 text-gray-500 italic px-4 py-2 rounded-lg text-sm\">\n          This message was deleted\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div \n      className={cn(\n        'flex gap-2 group',\n        isOwn ? 'justify-end' : 'justify-start'\n      )}\n      onMouseEnter={() => setShowActions(true)}\n      onMouseLeave={() => { setShowActions(false); setShowReactions(false); }}\n    >\n      {/* Avatar for received messages */}\n      {!isOwn && (\n        <div className={cn('w-8 h-8 flex-shrink-0', !showAvatar && 'invisible')}>\n          {showAvatar && (\n            <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white text-sm font-medium\">\n              {otherUser.profileImage ? (\n                <img\n                  src={otherUser.profileImage}\n                  alt={otherUser.name}\n                  className=\"w-8 h-8 rounded-full object-cover\"\n                />\n              ) : (\n                otherUser.name.charAt(0).toUpperCase()\n              )}\n            </div>\n          )}\n        </div>\n      )}\n\n      <div className={cn('max-w-[70%] relative', isOwn && 'order-first')}>\n        {/* Reply preview */}\n        {message.replyTo && (\n          <div className={cn(\n            'text-xs p-2 rounded-t-lg border-l-2',\n            isOwn \n              ? 'bg-blue-600/20 border-blue-400' \n              : 'bg-gray-100 dark:bg-gray-800 border-gray-400'\n          )}>\n            <span className=\"text-gray-500\">Replying to</span>\n            <p className=\"truncate\">{message.replyTo.content}</p>\n          </div>\n        )}\n\n        {/* Message content */}\n        <div className={cn(\n          'px-4 py-2 rounded-2xl relative',\n          isOwn \n            ? 'bg-blue-600 text-white rounded-br-sm' \n            : 'bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white rounded-bl-sm',\n          message.replyTo && 'rounded-t-none'\n        )}>\n          {/* Media content */}\n          {message.mediaUrl && message.contentType === 'image' && (\n            <img \n              src={message.mediaUrl} \n              alt=\"Shared image\" \n              className=\"rounded-lg max-w-full mb-2\"\n            />\n          )}\n\n          {message.mediaUrl && message.contentType === 'file' && (\n            <a \n              href={message.mediaUrl} \n              target=\"_blank\" \n              rel=\"noopener noreferrer\"\n              className=\"flex items-center gap-2 bg-white/10 p-2 rounded mb-2 hover:bg-white/20\"\n            >\n              <span>üìé</span>\n              <span className=\"truncate\">{message.fileName || 'File'}</span>\n            </a>\n          )}\n\n          {/* Text content */}\n          {isEditing ? (\n            <div className=\"flex gap-2\">\n              <input\n                type=\"text\"\n                value={editContent}\n                onChange={(e) => setEditContent(e.target.value)}\n                className=\"flex-1 bg-white/20 rounded px-2 py-1 text-sm\"\n                autoFocus\n                onKeyDown={(e) => {\n                  if (e.key === 'Enter') handleEdit();\n                  if (e.key === 'Escape') setIsEditing(false);\n                }}\n              />\n              <button onClick={handleEdit} className=\"text-xs\">Save</button>\n            </div>\n          ) : (\n            <p className=\"break-words whitespace-pre-wrap\">{message.content}</p>\n          )}\n\n          {/* Edited indicator - only show if updated more than 5 seconds after creation */}\n          {!message.isDeleted && (() => {\n            const created = new Date(message.createdAt).getTime();\n            const updated = new Date(message.updatedAt).getTime();\n            const diffSeconds = (updated - created) / 1000;\n            return diffSeconds > 5;\n          })() && (\n            <span className=\"text-xs opacity-60 ml-1\">(edited)</span>\n          )}\n        </div>\n\n        {/* Reactions */}\n        {message.reactions && message.reactions.length > 0 && (\n          <div className={cn(\n            'flex flex-wrap gap-1 mt-1',\n            isOwn ? 'justify-end' : 'justify-start'\n          )}>\n            {Array.from(new Set(message.reactions.map(r => r.emoji))).map(emoji => {\n              const count = message.reactions.filter(r => r.emoji === emoji).length;\n              return (\n                <button\n                  key={emoji}\n                  onClick={() => handleReaction(emoji)}\n                  className=\"bg-gray-100 dark:bg-gray-800 px-2 py-0.5 rounded-full text-sm flex items-center gap-1 hover:bg-gray-200 dark:hover:bg-gray-700\"\n                >\n                  <span>{emoji}</span>\n                  <span className=\"text-xs text-gray-500\">{count}</span>\n                </button>\n              );\n            })}\n          </div>\n        )}\n\n        {/* Time and status */}\n        <div className={cn(\n          'text-xs text-gray-500 mt-1 flex items-center gap-1',\n          isOwn ? 'justify-end' : 'justify-start'\n        )}>\n          <span>{format(new Date(message.createdAt), 'HH:mm')}</span>\n          {isOwn && (\n            <span className={cn(\n              message.status === 'READ' && 'text-blue-500'\n            )}>\n              {message.status === 'READ' ? '‚úì‚úì' : message.status === 'DELIVERED' ? '‚úì‚úì' : '‚úì'}\n            </span>\n          )}\n        </div>\n\n        {/* Action buttons */}\n        {showActions && !isEditing && (\n          <div className={cn(\n            'absolute top-0 flex items-center gap-1 bg-white dark:bg-gray-900 shadow-lg rounded-lg p-1',\n            isOwn ? 'right-full mr-2' : 'left-full ml-2'\n          )}>\n            <button\n              onClick={() => setShowReactions(!showReactions)}\n              className=\"p-1 hover:bg-gray-100 dark:hover:bg-gray-800 rounded\"\n              title=\"React\"\n            >\n              üòÄ\n            </button>\n            \n            {isOwn && (\n              <>\n                <button\n                  onClick={() => setIsEditing(true)}\n                  className=\"p-1 hover:bg-gray-100 dark:hover:bg-gray-800 rounded text-sm\"\n                  title=\"Edit\"\n                >\n                  ‚úèÔ∏è\n                </button>\n                <button\n                  onClick={() => handleDelete(true)}\n                  className=\"p-1 hover:bg-gray-100 dark:hover:bg-gray-800 rounded text-sm\"\n                  title=\"Delete for everyone\"\n                >\n                  üóëÔ∏è\n                </button>\n              </>\n            )}\n            <button\n              onClick={() => handleDelete(false)}\n              className=\"p-1 hover:bg-gray-100 dark:hover:bg-gray-800 rounded text-sm\"\n              title=\"Delete for me\"\n            >\n              ‚ùå\n            </button>\n          </div>\n        )}\n\n        {/* Reaction picker */}\n        {showReactions && (\n          <div className={cn(\n            'absolute -top-10 flex items-center gap-1 bg-white dark:bg-gray-900 shadow-lg rounded-full px-2 py-1',\n            isOwn ? 'right-0' : 'left-0'\n          )}>\n            {REACTION_EMOJIS.map(emoji => (\n              <button\n                key={emoji}\n                onClick={() => handleReaction(emoji)}\n                className=\"hover:scale-125 transition-transform p-1\"\n              >\n                {emoji}\n              </button>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\n// ============================================\n// Utility Functions\n// ============================================\nfunction formatDateSeparator(date: Date): string {\n  if (isToday(date)) return 'Today';\n  if (isYesterday(date)) return 'Yesterday';\n  return format(date, 'MMMM d, yyyy');\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1243, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Videos/vormex/vormex-web/src/components/chat/ChatInput.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { sendChatMessage, sendChatTyping, getSocket } from '@/lib/socket';\nimport { cn } from '@/lib/utils';\n\ninterface ChatInputProps {\n  conversationId: string;\n  replyTo?: {\n    id: string;\n    content: string;\n    senderName: string;\n  };\n  onCancelReply?: () => void;\n  disabled?: boolean;\n}\n\nexport default function ChatInput({\n  conversationId,\n  replyTo,\n  onCancelReply,\n  disabled = false,\n}: ChatInputProps) {\n  const [message, setMessage] = useState('');\n  const [isTyping, setIsTyping] = useState(false);\n  const [showEmoji, setShowEmoji] = useState(false);\n  const inputRef = useRef<HTMLTextAreaElement>(null);\n  const typingTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  // Auto-resize textarea\n  useEffect(() => {\n    if (inputRef.current) {\n      inputRef.current.style.height = 'auto';\n      inputRef.current.style.height = `${Math.min(inputRef.current.scrollHeight, 120)}px`;\n    }\n  }, [message]);\n\n  // Handle typing indicator\n  const handleTyping = useCallback(() => {\n    if (!isTyping) {\n      setIsTyping(true);\n      sendChatTyping(conversationId, true);\n    }\n\n    // Clear existing timeout\n    if (typingTimeoutRef.current) {\n      clearTimeout(typingTimeoutRef.current);\n    }\n\n    // Set new timeout to stop typing indicator\n    typingTimeoutRef.current = setTimeout(() => {\n      setIsTyping(false);\n      sendChatTyping(conversationId, false);\n    }, 2000);\n  }, [conversationId, isTyping]);\n\n  // Clean up typing timeout\n  useEffect(() => {\n    return () => {\n      if (typingTimeoutRef.current) {\n        clearTimeout(typingTimeoutRef.current);\n      }\n    };\n  }, []);\n\n  const handleSend = () => {\n    const trimmedMessage = message.trim();\n    \n    if (!trimmedMessage) return;\n\n    // Immediately clear typing state and stop broadcasting\n    if (typingTimeoutRef.current) {\n      clearTimeout(typingTimeoutRef.current);\n      typingTimeoutRef.current = null;\n    }\n    setIsTyping(false);\n    sendChatTyping(conversationId, false);\n\n    // Send message\n    sendChatMessage({\n      conversationId,\n      content: trimmedMessage,\n      contentType: 'text',\n      replyToId: replyTo?.id,\n    });\n\n    // Reset\n    setMessage('');\n    onCancelReply?.();\n    \n    // Focus input\n    inputRef.current?.focus();\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSend();\n    }\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    setMessage(e.target.value);\n    handleTyping();\n  };\n\n  const handleEmojiClick = (emoji: string) => {\n    setMessage(prev => prev + emoji);\n    setShowEmoji(false);\n    inputRef.current?.focus();\n  };\n\n  const commonEmojis = ['üòÄ', 'üòÇ', '‚ù§Ô∏è', 'üëç', 'üî•', 'üéâ', 'üòä', 'üôè', 'üíØ', '‚ú®'];\n\n  return (\n    <div className=\"border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900 p-4\">\n      {/* Reply preview */}\n      {replyTo && (\n        <div className=\"flex items-center justify-between mb-2 p-2 bg-gray-100 dark:bg-gray-800 rounded-lg\">\n          <div className=\"flex items-center gap-2 min-w-0\">\n            <div className=\"w-1 h-8 bg-blue-500 rounded-full\" />\n            <div className=\"min-w-0\">\n              <p className=\"text-xs text-blue-600 dark:text-blue-400 font-medium\">\n                Replying to {replyTo.senderName}\n              </p>\n              <p className=\"text-sm text-gray-600 dark:text-gray-400 truncate\">\n                {replyTo.content}\n              </p>\n            </div>\n          </div>\n          <button\n            onClick={onCancelReply}\n            className=\"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded\"\n          >\n            ‚úï\n          </button>\n        </div>\n      )}\n\n      {/* Input area */}\n      <div className=\"flex items-end gap-2\">\n        {/* Attachment button */}\n        <button\n          className=\"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors\"\n          title=\"Attach file\"\n        >\n          <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13\" />\n          </svg>\n        </button>\n\n        {/* Emoji button */}\n        <div className=\"relative\">\n          <button\n            onClick={() => setShowEmoji(!showEmoji)}\n            className=\"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors\"\n            title=\"Add emoji\"\n          >\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n            </svg>\n          </button>\n\n          {/* Emoji picker */}\n          {showEmoji && (\n            <div className=\"absolute bottom-full left-0 mb-2 p-2 bg-white dark:bg-gray-800 shadow-lg rounded-lg border border-gray-200 dark:border-gray-700 z-10\">\n              <div className=\"flex gap-1 flex-wrap max-w-[200px]\">\n                {commonEmojis.map(emoji => (\n                  <button\n                    key={emoji}\n                    onClick={() => handleEmojiClick(emoji)}\n                    className=\"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded text-xl\"\n                  >\n                    {emoji}\n                  </button>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Text input */}\n        <div className=\"flex-1 relative\">\n          <textarea\n            ref={inputRef}\n            value={message}\n            onChange={handleChange}\n            onKeyDown={handleKeyDown}\n            placeholder=\"Type a message...\"\n            disabled={disabled}\n            rows={1}\n            className={cn(\n              'w-full resize-none rounded-2xl px-4 py-2 pr-12',\n              'bg-gray-100 dark:bg-gray-800',\n              'border border-transparent focus:border-blue-500',\n              'focus:outline-none focus:ring-2 focus:ring-blue-500/20',\n              'text-gray-900 dark:text-white placeholder-gray-500',\n              'disabled:opacity-50 disabled:cursor-not-allowed',\n              'max-h-32'\n            )}\n          />\n        </div>\n\n        {/* Send button */}\n        <button\n          onClick={handleSend}\n          disabled={!message.trim() || disabled}\n          className={cn(\n            'p-3 rounded-full transition-all',\n            message.trim()\n              ? 'bg-blue-600 text-white hover:bg-blue-700 scale-100'\n              : 'bg-gray-200 dark:bg-gray-700 text-gray-400 scale-95',\n            'disabled:opacity-50 disabled:cursor-not-allowed'\n          )}\n        >\n          <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path d=\"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\" />\n          </svg>\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1568, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Videos/vormex/vormex-web/src/components/chat/ChatHeader.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { formatDistanceToNow } from 'date-fns';\nimport { getSocket } from '@/lib/socket';\nimport { cn } from '@/lib/utils';\n\ninterface ChatHeaderProps {\n  user: {\n    id: string;\n    name: string;\n    username: string;\n    profileImage?: string | null;\n    isOnline?: boolean;\n    lastActiveAt?: string | null;\n  };\n  onBack?: () => void;\n  onInfo?: () => void;\n}\n\nexport default function ChatHeader({ user, onBack, onInfo }: ChatHeaderProps) {\n  const [isOnline, setIsOnline] = useState(user.isOnline || false);\n  const [lastActive, setLastActive] = useState(user.lastActiveAt);\n\n  // Listen for online/offline status\n  useEffect(() => {\n    const socket = getSocket();\n    if (!socket) return;\n\n    const handleOnline = (data: { userId: string }) => {\n      if (data.userId === user.id) {\n        setIsOnline(true);\n      }\n    };\n\n    const handleOffline = (data: { userId: string }) => {\n      if (data.userId === user.id) {\n        setIsOnline(false);\n        setLastActive(new Date().toISOString());\n      }\n    };\n\n    socket.on('user:online', handleOnline);\n    socket.on('user:offline', handleOffline);\n\n    return () => {\n      socket.off('user:online', handleOnline);\n      socket.off('user:offline', handleOffline);\n    };\n  }, [user.id]);\n\n  // Update initial state when user prop changes\n  useEffect(() => {\n    setIsOnline(user.isOnline || false);\n    setLastActive(user.lastActiveAt);\n  }, [user.isOnline, user.lastActiveAt]);\n\n  return (\n    <div className=\"flex items-center gap-3 p-4 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900\">\n      {/* Back button (mobile) */}\n      {onBack && (\n        <button\n          onClick={onBack}\n          className=\"p-2 -ml-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full md:hidden\"\n        >\n          <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\n          </svg>\n        </button>\n      )}\n\n      {/* Avatar */}\n      <Link href={`/profile/${user.username}`} className=\"relative flex-shrink-0\">\n        <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white font-semibold\">\n          {user.profileImage ? (\n            <img\n              src={user.profileImage}\n              alt={user.name}\n              className=\"w-10 h-10 rounded-full object-cover\"\n            />\n          ) : (\n            user.name.charAt(0).toUpperCase()\n          )}\n        </div>\n        {/* Online indicator */}\n        {isOnline && (\n          <div className=\"absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-gray-900\"></div>\n        )}\n      </Link>\n\n      {/* User info */}\n      <div className=\"flex-1 min-w-0\">\n        <Link \n          href={`/profile/${user.username}`}\n          className=\"font-semibold text-gray-900 dark:text-white hover:underline truncate block\"\n        >\n          {user.name}\n        </Link>\n        <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n          {isOnline ? (\n            <span className=\"text-green-600 dark:text-green-400\">Online</span>\n          ) : lastActive ? (\n            `Last seen ${formatDistanceToNow(new Date(lastActive), { addSuffix: true })}`\n          ) : (\n            `@${user.username}`\n          )}\n        </p>\n      </div>\n\n      {/* Action buttons */}\n      <div className=\"flex items-center gap-2\">\n        {/* Voice call (future) */}\n        <button\n          className=\"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors\"\n          title=\"Voice call (coming soon)\"\n          disabled\n        >\n          <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z\" />\n          </svg>\n        </button>\n\n        {/* Video call (future) */}\n        <button\n          className=\"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors\"\n          title=\"Video call (coming soon)\"\n          disabled\n        >\n          <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z\" />\n          </svg>\n        </button>\n\n        {/* Info button */}\n        {onInfo && (\n          <button\n            onClick={onInfo}\n            className=\"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors\"\n            title=\"Chat info\"\n          >\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n            </svg>\n          </button>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1824, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Videos/vormex/vormex-web/src/components/chat/index.ts"],"sourcesContent":["export { default as ChatList } from './ChatList';\nexport { default as ChatMessages } from './ChatMessages';\nexport { default as ChatInput } from './ChatInput';\nexport { default as ChatHeader } from './ChatHeader';\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA"}},
    {"offset": {"line": 1873, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Videos/vormex/vormex-web/src/app/messages/%5BconversationId%5D/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState, use } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { ProtectedRoute } from '@/components/auth/ProtectedRoute';\nimport { useAuth } from '@/lib/auth/useAuth';\nimport { ChatList, ChatMessages, ChatInput, ChatHeader } from '@/components/chat';\nimport { getConversation, Conversation } from '@/lib/api/chat';\nimport { initializeSocket } from '@/lib/socket';\n\ninterface ConversationPageProps {\n  params: Promise<{ conversationId: string }>;\n}\n\nexport default function ConversationPage({ params }: ConversationPageProps) {\n  const resolvedParams = use(params);\n  const router = useRouter();\n  const { user } = useAuth();\n  const [conversation, setConversation] = useState<Conversation | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [replyTo, setReplyTo] = useState<{ id: string; content: string; senderName: string } | null>(null);\n\n  // Initialize socket\n  useEffect(() => {\n    if (user?.id) {\n      initializeSocket();\n    }\n  }, [user?.id]);\n\n  // Fetch conversation\n  useEffect(() => {\n    const fetchConversation = async () => {\n      try {\n        setLoading(true);\n        const conv = await getConversation(resolvedParams.conversationId);\n        setConversation(conv);\n      } catch (err: any) {\n        setError(err.message || 'Failed to load conversation');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    if (resolvedParams.conversationId && user?.id) {\n      fetchConversation();\n    }\n  }, [resolvedParams.conversationId, user?.id]);\n\n  const handleBack = () => {\n    router.push('/messages');\n  };\n\n  const handleSelectConversation = (conv: Conversation) => {\n    router.push(`/messages/${conv.id}`);\n  };\n\n  if (loading) {\n    return (\n      <ProtectedRoute>\n        <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n        </div>\n      </ProtectedRoute>\n    );\n  }\n\n  if (error || !conversation) {\n    return (\n      <ProtectedRoute>\n        <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center\">\n          <div className=\"text-center\">\n            <p className=\"text-red-500 mb-4\">{error || 'Conversation not found'}</p>\n            <button\n              onClick={handleBack}\n              className=\"text-blue-600 hover:underline\"\n            >\n              Go back to messages\n            </button>\n          </div>\n        </div>\n      </ProtectedRoute>\n    );\n  }\n\n  const otherUser = conversation.otherParticipant;\n\n  return (\n    <ProtectedRoute>\n      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n        <div className=\"max-w-7xl mx-auto\">\n          <div className=\"flex h-screen\">\n            {/* Sidebar - Chat List (hidden on mobile when viewing a conversation) */}\n            <div className=\"hidden md:flex md:w-96 bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700 flex-col\">\n              {/* Header */}\n              <div className=\"p-4 border-b border-gray-200 dark:border-gray-700\">\n                <div className=\"flex items-center justify-between\">\n                  <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">Messages</h1>\n                </div>\n              </div>\n\n              {/* Chat list */}\n              <ChatList \n                selectedConversationId={resolvedParams.conversationId}\n                onSelectConversation={handleSelectConversation}\n                currentUserId={user?.id}\n              />\n            </div>\n\n            {/* Main Chat Area */}\n            <div className=\"flex-1 flex flex-col bg-white dark:bg-gray-900 pb-24\">\n              {/* Chat Header */}\n              <ChatHeader \n                user={otherUser} \n                onBack={handleBack}\n              />\n\n              {/* Messages */}\n              <ChatMessages\n                conversationId={resolvedParams.conversationId}\n                currentUserId={user!.id}\n                otherUser={otherUser}\n              />\n\n              {/* Input */}\n              <ChatInput\n                conversationId={resolvedParams.conversationId}\n                replyTo={replyTo || undefined}\n                onCancelReply={() => setReplyTo(null)}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n    </ProtectedRoute>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AARA;;;;;;;;;AAce,SAAS,iBAAiB,EAAE,MAAM,EAAyB;IACxE,MAAM,iBAAiB,IAAA,4MAAG,EAAC;IAC3B,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,wIAAO;IACxB,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAsB;IACtE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAgB;IAClD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAA6D;IAEnG,oBAAoB;IACpB,IAAA,kNAAS,EAAC;QACR,IAAI,MAAM,IAAI;YACZ,IAAA,wIAAgB;QAClB;IACF,GAAG;QAAC,MAAM;KAAG;IAEb,qBAAqB;IACrB,IAAA,kNAAS,EAAC;QACR,MAAM,oBAAoB;YACxB,IAAI;gBACF,WAAW;gBACX,MAAM,OAAO,MAAM,IAAA,4IAAe,EAAC,eAAe,cAAc;gBAChE,gBAAgB;YAClB,EAAE,OAAO,KAAU;gBACjB,SAAS,IAAI,OAAO,IAAI;YAC1B,SAAU;gBACR,WAAW;YACb;QACF;QAEA,IAAI,eAAe,cAAc,IAAI,MAAM,IAAI;YAC7C;QACF;IACF,GAAG;QAAC,eAAe,cAAc;QAAE,MAAM;KAAG;IAE5C,MAAM,aAAa;QACjB,OAAO,IAAI,CAAC;IACd;IAEA,MAAM,2BAA2B,CAAC;QAChC,OAAO,IAAI,CAAC,CAAC,UAAU,EAAE,KAAK,EAAE,EAAE;IACpC;IAEA,IAAI,SAAS;QACX,qBACE,8OAAC,8JAAc;sBACb,cAAA,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;;;;;;;;;;;;;;;IAIvB;IAEA,IAAI,SAAS,CAAC,cAAc;QAC1B,qBACE,8OAAC,8JAAc;sBACb,cAAA,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAE,WAAU;sCAAqB,SAAS;;;;;;sCAC3C,8OAAC;4BACC,SAAS;4BACT,WAAU;sCACX;;;;;;;;;;;;;;;;;;;;;;IAOX;IAEA,MAAM,YAAY,aAAa,gBAAgB;IAE/C,qBACE,8OAAC,8JAAc;kBACb,cAAA,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCAEb,8OAAC;4BAAI,WAAU;;8CAEb,8OAAC;oCAAI,WAAU;8CACb,cAAA,8OAAC;wCAAI,WAAU;kDACb,cAAA,8OAAC;4CAAG,WAAU;sDAAmD;;;;;;;;;;;;;;;;8CAKrE,8OAAC,yLAAQ;oCACP,wBAAwB,eAAe,cAAc;oCACrD,sBAAsB;oCACtB,eAAe,MAAM;;;;;;;;;;;;sCAKzB,8OAAC;4BAAI,WAAU;;8CAEb,8OAAC,+LAAU;oCACT,MAAM;oCACN,QAAQ;;;;;;8CAIV,8OAAC,qMAAY;oCACX,gBAAgB,eAAe,cAAc;oCAC7C,eAAe,KAAM,EAAE;oCACvB,WAAW;;;;;;8CAIb,8OAAC,4LAAS;oCACR,gBAAgB,eAAe,cAAc;oCAC7C,SAAS,WAAW;oCACpB,eAAe,IAAM,WAAW;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQhD"}}]
}