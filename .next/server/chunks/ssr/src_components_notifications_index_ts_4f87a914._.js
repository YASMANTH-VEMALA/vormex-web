module.exports=[90433,60392,80666,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(46271),e=a.i(62036),f=a.i(71987),g=a.i(50944),h=a.i(23312),i=a.i(76472),j=a.i(45222),k=a.i(65169),l=a.i(17371),m=a.i(96221),n=a.i(70106);let o=(0,n.default)("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);var p=a.i(67594);let q=(0,n.default)("HandHeart",[["path",{d:"M11 14h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 16",key:"1ifwr1"}],["path",{d:"m7 20 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9",key:"17abbs"}],["path",{d:"m2 15 6 6",key:"10dquu"}],["path",{d:"M19.5 8.5c.7-.7 1.5-1.6 1.5-2.7A2.73 2.73 0 0 0 16 4a2.78 2.78 0 0 0-5 1.8c0 1.2.8 2 1.5 2.8L16 12Z",key:"1h3036"}]]);var r=a.i(69439),s=a.i(42211),t=a.i(90545),u=a.i(60246),v=a.i(21161),w=a.i(38246),x=a.i(94632),y=a.i(92415);function z(a){let b={like:"POST_LIKE",comment:"COMMENT",comment_reply:"COMMENT_LIKE",mention:"MENTION",follow:"CONNECTION_ACCEPTED",connection_request:"CONNECTION_REQUEST",connection_accepted:"CONNECTION_ACCEPTED",reel_like:"POST_LIKE",reel_comment:"COMMENT",reel_comment_reply:"COMMENT_LIKE",reel_share:"POST_SHARE",reel_mention:"MENTION",post_share:"POST_SHARE"}[a.type]||a.type,c=a.data;return{...a,type:b,content:a.body,postPreview:c?.commentPreview||("string"==typeof a.body?a.body.slice(0,50):""),postId:a.post?.id??c?.postId,commentId:c?.commentId,reelId:a.reel?.id??c?.reelId,reactionType:c?.reactionType}}async function A(a){let b=await y.default.get("/notifications",{params:a});return{notifications:b.notifications.map(z),nextCursor:b.nextCursor,hasMore:b.hasMore}}async function B(){return y.default.get("/notifications/unread-count")}async function C(a){await y.default.post("/notifications/read",{notificationIds:a})}async function D(){await y.default.post("/notifications/read-all")}var E=a.i(12469);function F({notification:a,onMarkRead:c}){let e=(0,g.useRouter)();return(0,b.jsxs)(d.motion.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},onClick:()=>{a.isRead||c(a.id),"GROUP_INVITE"===a.type||"GROUP_JOIN_APPROVED"===a.type?e.push("/groups?tab=invites"):a.reelId?e.push(`/reels/${a.reelId}`):a.postId?a.commentId?e.push(`/post/${a.postId}?comment=${a.commentId}`):e.push(`/post/${a.postId}`):("CONNECTION_REQUEST"===a.type||"CONNECTION_ACCEPTED"===a.type)&&a.actor&&e.push(`/profile/${a.actor.username}`)},className:`w-full flex items-start gap-3 p-4 text-left transition-colors ${a.isRead?"bg-transparent hover:bg-gray-50 dark:hover:bg-neutral-800/50":"bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30"}`,children:[(0,b.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-full overflow-hidden bg-gray-200 dark:bg-neutral-700",children:a.actor?.profileImage?(0,b.jsx)(f.default,{src:a.actor.profileImage,alt:a.actor.name,width:48,height:48,className:"w-full h-full object-cover"}):(0,b.jsx)("div",{className:"w-full h-full flex items-center justify-center font-bold text-gray-500",children:a.actor?.name?.charAt(0).toUpperCase()||"?"})}),(0,b.jsx)("div",{className:"absolute -bottom-1 -right-1 p-1 rounded-full bg-white dark:bg-neutral-900",children:function(a,c){switch(a){case"POST_REACTION":switch(c){case"CELEBRATE":return(0,b.jsx)(p.PartyPopper,{className:"w-5 h-5 text-yellow-500"});case"SUPPORT":return(0,b.jsx)(q,{className:"w-5 h-5 text-green-500"});case"INSIGHTFUL":return(0,b.jsx)(r.Lightbulb,{className:"w-5 h-5 text-amber-500"});case"CURIOUS":return(0,b.jsx)(s.HelpCircle,{className:"w-5 h-5 text-purple-500"});default:return(0,b.jsx)(t.ThumbsUp,{className:"w-5 h-5 text-blue-500"})}case"POST_LIKE":return(0,b.jsx)(t.ThumbsUp,{className:"w-5 h-5 text-blue-500"});case"COMMENT":return(0,b.jsx)(j.MessageCircle,{className:"w-5 h-5 text-green-500"});case"COMMENT_LIKE":return(0,b.jsx)(i.Heart,{className:"w-5 h-5 text-red-500"});case"MENTION":return(0,b.jsx)(k.AtSign,{className:"w-5 h-5 text-purple-500"});case"CONNECTION_REQUEST":case"CONNECTION_ACCEPTED":return(0,b.jsx)(l.UserPlus,{className:"w-5 h-5 text-blue-500"});case"GROUP_INVITE":case"GROUP_JOIN_REQUEST":case"GROUP_JOIN_APPROVED":return(0,b.jsx)(u.Users,{className:"w-5 h-5 text-indigo-500"});default:return(0,b.jsx)(h.Bell,{className:"w-5 h-5 text-gray-500"})}}(a.type,a.reactionType)})]}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm text-gray-900 dark:text-white",children:function(a){let b=a.actor?.name||"Someone";switch(a.type){case"POST_REACTION":let c={LIKE:"liked",CELEBRATE:"celebrated",SUPPORT:"supported",INSIGHTFUL:"found insightful",CURIOUS:"is curious about"}[a.reactionType||"LIKE"]||"reacted to";return`${b} ${c} your post`;case"POST_LIKE":return`${b} liked your post`;case"COMMENT":return`${b} commented on your post`;case"COMMENT_LIKE":return`${b} liked your comment`;case"MENTION":return`${b} mentioned you`;case"CONNECTION_REQUEST":return`${b} sent you a connection request`;case"CONNECTION_ACCEPTED":return`${b} accepted your connection request`;case"POLL_VOTE":return`${b} voted on your poll`;case"POST_SHARE":return`${b} shared your post`;case"GROUP_INVITE":return`${b} invited you to join ${a.content||"a group"}`;case"GROUP_JOIN_REQUEST":return`${b} requested to join your group`;case"GROUP_JOIN_APPROVED":return`Your request to join ${a.content||"the group"} was approved`;default:return`${b} interacted with your content`}}(a)}),a.content&&(0,b.jsxs)("p",{className:"text-sm text-gray-500 dark:text-neutral-400 line-clamp-2 mt-1",children:['"',a.content,'"']}),a.postPreview&&!a.content&&(0,b.jsx)("p",{className:"text-sm text-gray-500 dark:text-neutral-400 line-clamp-1 mt-1",children:a.postPreview}),(0,b.jsx)("p",{className:"text-xs text-gray-400 dark:text-neutral-500 mt-1",children:(0,x.formatDistanceToNow)(new Date(a.createdAt),{addSuffix:!0})})]}),!a.isRead&&(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500 flex-shrink-0 mt-2"})]})}function G({isOpen:a=!0,onClose:d,isDropdown:f=!1}){let[g,i]=(0,c.useState)([]),[j,k]=(0,c.useState)(!0),[l,n]=(0,c.useState)(0);(0,c.useEffect)(()=>{a&&(async()=>{k(!0);try{let[a,b]=await Promise.all([A(),B()]);i(a.notifications),n(b.count)}catch(a){console.error("Error fetching notifications:",a)}finally{k(!1)}})()},[a]),(0,c.useEffect)(()=>{let a=()=>{n(a=>a+1),A().then(a=>i(a.notifications)).catch(console.error)};return(0,E.initializeSocket)({onNotificationNew:a,onNotificationMention:a,onNotificationComment:a,onNotificationLike:a,onNotificationReaction:a,onNotificationCommentLike:a}),()=>{}},[]);let p=async a=>{try{await C([a]),i(b=>b.map(b=>b.id===a?{...b,isRead:!0}:b)),n(a=>Math.max(0,a-1))}catch(a){console.error("Error marking notification as read:",a)}},q=async()=>{try{await D(),i(a=>a.map(a=>({...a,isRead:!0}))),n(0)}catch(a){console.error("Error marking all as read:",a)}},r=(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-neutral-800",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(h.Bell,{className:"w-5 h-5 text-gray-600 dark:text-neutral-400"}),(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Notifications"}),l>0&&(0,b.jsx)("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-500 text-white",children:l})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[l>0&&(0,b.jsxs)("button",{onClick:q,className:"flex items-center gap-1 text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition-colors",children:[(0,b.jsx)(o,{className:"w-4 h-4"}),"Mark all read"]}),!f&&(0,b.jsx)(w.default,{href:"/notifications/settings",className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-neutral-800 transition-colors",children:(0,b.jsx)(v.Settings,{className:"w-5 h-5 text-gray-500 dark:text-neutral-400"})})]})]}),(0,b.jsx)("div",{className:`overflow-y-auto ${f?"max-h-96":"flex-1"}`,children:j?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)(m.Loader2,{className:"w-8 h-8 animate-spin text-gray-400"})}):0===g.length?(0,b.jsxs)("div",{className:"text-center py-12 px-4",children:[(0,b.jsx)(h.Bell,{className:"w-12 h-12 mx-auto text-gray-300 dark:text-neutral-600 mb-2"}),(0,b.jsx)("p",{className:"text-gray-500 dark:text-neutral-400",children:"No notifications yet"}),(0,b.jsx)("p",{className:"text-sm text-gray-400 dark:text-neutral-500",children:"When someone interacts with your content, it will appear here"})]}):(0,b.jsx)("div",{className:"divide-y divide-gray-100 dark:divide-neutral-800",children:(0,b.jsx)(e.AnimatePresence,{children:g.map(a=>(0,b.jsx)(F,{notification:a,onMarkRead:p},a.id))})})})]});return f?(0,b.jsx)("div",{className:"w-80 bg-white dark:bg-neutral-900 rounded-xl border border-gray-200 dark:border-neutral-800 shadow-xl overflow-hidden",children:r}):(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-neutral-950",children:(0,b.jsx)("div",{className:"max-w-2xl mx-auto bg-white dark:bg-neutral-900 min-h-screen border-x border-gray-200 dark:border-neutral-800",children:r})})}a.s(["Notifications",()=>G],60392);var H=a.i(33508);let I=(0,n.default)("BellRing",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}]]);var J=a.i(65708);function K({userId:a}){let{isSupported:f,isPermissionGranted:g,isTokenRegistered:i,isLoading:j,foregroundNotification:k,requestPermission:l,dismissNotification:m}=(0,J.usePushNotifications)(a),[n,o]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(!f||g||!a||localStorage.getItem("push_prompt_dismissed"))return;let b=parseInt(localStorage.getItem("visit_count")||"0",10)+1;if(localStorage.setItem("visit_count",b.toString()),b>=3){let a=setTimeout(()=>o(!0),1e4);return()=>clearTimeout(a)}},[f,g,a]);let p=async()=>{await l(),o(!1)},q=()=>{o(!1),localStorage.setItem("push_prompt_dismissed",new Date().toISOString())};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.AnimatePresence,{children:n&&(0,b.jsx)(d.motion.div,{initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:50,scale:.9},className:"fixed bottom-24 left-4 right-4 md:left-auto md:right-6 md:w-96 z-50 bg-white dark:bg-neutral-900 rounded-2xl shadow-2xl border border-gray-200 dark:border-neutral-700 overflow-hidden",children:(0,b.jsxs)("div",{className:"p-5",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-xl bg-blue-50 dark:bg-blue-900/20 flex items-center justify-center flex-shrink-0",children:(0,b.jsx)(I,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-1",children:"Stay in the loop ðŸ””"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 dark:text-neutral-400 leading-relaxed",children:"Get notified when someone views your profile, accepts your connection, or when your streak is at risk."})]}),(0,b.jsx)("button",{onClick:q,className:"p-1 rounded-full hover:bg-gray-100 dark:hover:bg-neutral-800 transition-colors",children:(0,b.jsx)(H.X,{className:"w-4 h-4 text-gray-400"})})]}),(0,b.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,b.jsx)("button",{onClick:q,className:"flex-1 py-2 px-4 rounded-lg text-sm font-medium text-gray-600 dark:text-neutral-400 hover:bg-gray-100 dark:hover:bg-neutral-800 transition-colors",children:"Not now"}),(0,b.jsxs)("button",{onClick:p,disabled:j,className:"flex-1 py-2 px-4 rounded-lg text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center justify-center gap-1.5",children:[(0,b.jsx)(h.Bell,{className:"w-3.5 h-3.5"}),j?"Enabling...":"Enable"]})]})]})})}),(0,b.jsx)(e.AnimatePresence,{children:k&&(0,b.jsxs)(d.motion.div,{initial:{opacity:0,y:-50,x:50},animate:{opacity:1,y:0,x:0},exit:{opacity:0,y:-50},className:"fixed top-4 right-4 z-[100] w-80 bg-white dark:bg-neutral-900 rounded-xl shadow-2xl border border-gray-200 dark:border-neutral-700 overflow-hidden cursor-pointer",onClick:m,children:[(0,b.jsx)("div",{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-50 dark:bg-blue-900/20 flex items-center justify-center flex-shrink-0",children:(0,b.jsx)(h.Bell,{className:"w-4 h-4 text-blue-500"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate",children:k.notification?.title||"Vormex"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 dark:text-neutral-400 line-clamp-2 mt-0.5",children:k.notification?.body||""})]}),(0,b.jsx)("button",{onClick:a=>{a.stopPropagation(),m()},className:"p-0.5 rounded hover:bg-gray-100 dark:hover:bg-neutral-800",children:(0,b.jsx)(H.X,{className:"w-3.5 h-3.5 text-gray-400"})})]})}),(0,b.jsx)(d.motion.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:5,ease:"linear"},className:"h-0.5 bg-blue-500"})]})})]})}a.s(["NotificationPrompt",()=>K],80666),a.s([],90433)}];

//# sourceMappingURL=src_components_notifications_index_ts_4f87a914._.js.map