{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/auth/ProtectedRoute.tsx"],"sourcesContent":["'use client';\n\nimport React from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useAuth } from '@/lib/auth/useAuth';\n\ninterface ProtectedRouteProps {\n  children: React.ReactNode;\n}\n\nexport function ProtectedRoute({ children }: ProtectedRouteProps) {\n  const { isAuthenticated, loading } = useAuth();\n  const router = useRouter();\n\n  React.useEffect(() => {\n    if (!loading && !isAuthenticated) {\n      router.push('/login');\n    }\n  }, [isAuthenticated, loading, router]);\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!isAuthenticated) {\n    return null;\n  }\n\n  return <>{children}</>;\n}\n\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAUO,SAAS,eAAe,EAAE,QAAQ,EAAuB;IAC9D,MAAM,EAAE,eAAe,EAAE,OAAO,EAAE,GAAG,IAAA,wIAAO;IAC5C,MAAM,SAAS,IAAA,+IAAS;IAExB,gNAAK,CAAC,SAAS,CAAC;QACd,IAAI,CAAC,WAAW,CAAC,iBAAiB;YAChC,OAAO,IAAI,CAAC;QACd;IACF,GAAG;QAAC;QAAiB;QAAS;KAAO;IAErC,IAAI,SAAS;QACX,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;;;;;kCACf,8OAAC;wBAAE,WAAU;kCAAqB;;;;;;;;;;;;;;;;;IAI1C;IAEA,IAAI,CAAC,iBAAiB;QACpB,OAAO;IACT;IAEA,qBAAO;kBAAG;;AACZ"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/lib/api/notifications.ts"],"sourcesContent":["// Notifications API - Complete API client for Notifications endpoints\n\nimport apiClient from './client';\n\n// ============================================\n// Types\n// ============================================\n\nexport type NotificationType =\n  | 'POST_LIKE'\n  | 'POST_REACTION'\n  | 'COMMENT'\n  | 'COMMENT_LIKE'\n  | 'MENTION'\n  | 'CONNECTION_REQUEST'\n  | 'CONNECTION_ACCEPTED'\n  | 'POLL_VOTE'\n  | 'POST_SHARE'\n  | 'GROUP_INVITE'\n  | 'GROUP_JOIN_REQUEST'\n  | 'GROUP_JOIN_APPROVED';\n\nexport interface NotificationActor {\n  id: string;\n  username: string;\n  name: string;\n  profileImage: string | null;\n}\n\nexport interface Notification {\n  id: string;\n  type: NotificationType;\n  actor: NotificationActor | null;\n  postId: string | null;\n  commentId: string | null;\n  groupId: string | null;\n  reactionType: string | null;\n  content: string | null;\n  postPreview: string | null;\n  isRead: boolean;\n  createdAt: string;\n}\n\nexport interface NotificationsResponse {\n  notifications: Notification[];\n  nextCursor: string | null;\n  hasMore: boolean;\n}\n\n// ============================================\n// Notification Endpoints\n// ============================================\n\n/**\n * Get notifications for the current user\n * @param cursor - Optional cursor for pagination\n * @param limit - Number of notifications per page (default: 20)\n * @param unreadOnly - Only return unread notifications\n */\nexport async function getNotifications(\n  cursor?: string,\n  limit: number = 20,\n  unreadOnly: boolean = false\n): Promise<NotificationsResponse> {\n  const params: Record<string, any> = { limit };\n  if (cursor) params.cursor = cursor;\n  if (unreadOnly) params.unreadOnly = 'true';\n  return apiClient.get('/notifications', { params });\n}\n\n/**\n * Get unread notification count\n */\nexport async function getUnreadNotificationCount(): Promise<{ count: number }> {\n  return apiClient.get('/notifications/unread-count');\n}\n\n/**\n * Mark specific notifications as read\n * @param notificationIds - Array of notification IDs to mark as read\n */\nexport async function markNotificationsAsRead(notificationIds: string[]): Promise<{ success: boolean }> {\n  return apiClient.post('/notifications/read', { notificationIds });\n}\n\n/**\n * Mark all notifications as read\n */\nexport async function markAllNotificationsAsRead(): Promise<{ success: boolean }> {\n  return apiClient.post('/notifications/read-all');\n}\n"],"names":[],"mappings":"AAAA,sEAAsE;;;;;;;;;;;AAEtE;;AAyDO,eAAe,iBACpB,MAAe,EACf,QAAgB,EAAE,EAClB,aAAsB,KAAK;IAE3B,MAAM,SAA8B;QAAE;IAAM;IAC5C,IAAI,QAAQ,OAAO,MAAM,GAAG;IAC5B,IAAI,YAAY,OAAO,UAAU,GAAG;IACpC,OAAO,sIAAS,CAAC,GAAG,CAAC,kBAAkB;QAAE;IAAO;AAClD;AAKO,eAAe;IACpB,OAAO,sIAAS,CAAC,GAAG,CAAC;AACvB;AAMO,eAAe,wBAAwB,eAAyB;IACrE,OAAO,sIAAS,CAAC,IAAI,CAAC,uBAAuB;QAAE;IAAgB;AACjE;AAKO,eAAe;IACpB,OAAO,sIAAS,CAAC,IAAI,CAAC;AACxB"}},
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/notifications/Notifications.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport Image from 'next/image';\nimport { useRouter } from 'next/navigation';\nimport {\n  Bell,\n  Heart,\n  MessageCircle,\n  AtSign,\n  UserPlus,\n  Loader2,\n  CheckCheck,\n  PartyPopper,\n  HandHeart,\n  Lightbulb,\n  HelpCircle,\n  ThumbsUp,\n  Users,\n} from 'lucide-react';\nimport { formatDistanceToNow } from 'date-fns';\nimport {\n  getNotifications,\n  getUnreadNotificationCount,\n  markNotificationsAsRead,\n  markAllNotificationsAsRead,\n  type Notification,\n  type NotificationType,\n} from '@/lib/api/notifications';\nimport { initializeSocket } from '@/lib/socket';\n\n// Get icon for notification type\nfunction getNotificationIcon(type: NotificationType, reactionType?: string | null) {\n  switch (type) {\n    case 'POST_REACTION':\n      // Show specific reaction icon\n      switch (reactionType) {\n        case 'CELEBRATE':\n          return <PartyPopper className=\"w-5 h-5 text-yellow-500\" />;\n        case 'SUPPORT':\n          return <HandHeart className=\"w-5 h-5 text-green-500\" />;\n        case 'INSIGHTFUL':\n          return <Lightbulb className=\"w-5 h-5 text-amber-500\" />;\n        case 'CURIOUS':\n          return <HelpCircle className=\"w-5 h-5 text-purple-500\" />;\n        default:\n          return <ThumbsUp className=\"w-5 h-5 text-blue-500\" />;\n      }\n    case 'POST_LIKE':\n      return <ThumbsUp className=\"w-5 h-5 text-blue-500\" />;\n    case 'COMMENT':\n      return <MessageCircle className=\"w-5 h-5 text-green-500\" />;\n    case 'COMMENT_LIKE':\n      return <Heart className=\"w-5 h-5 text-red-500\" />;\n    case 'MENTION':\n      return <AtSign className=\"w-5 h-5 text-purple-500\" />;\n    case 'CONNECTION_REQUEST':\n    case 'CONNECTION_ACCEPTED':\n      return <UserPlus className=\"w-5 h-5 text-blue-500\" />;\n    case 'GROUP_INVITE':\n    case 'GROUP_JOIN_REQUEST':\n    case 'GROUP_JOIN_APPROVED':\n      return <Users className=\"w-5 h-5 text-indigo-500\" />;\n    default:\n      return <Bell className=\"w-5 h-5 text-gray-500\" />;\n  }\n}\n\n// Get notification message\nfunction getNotificationMessage(notification: Notification): string {\n  const actorName = notification.actor?.name || 'Someone';\n  \n  switch (notification.type) {\n    case 'POST_REACTION':\n      const reactionLabels: Record<string, string> = {\n        LIKE: 'liked',\n        CELEBRATE: 'celebrated',\n        SUPPORT: 'supported',\n        INSIGHTFUL: 'found insightful',\n        CURIOUS: 'is curious about',\n      };\n      const action = reactionLabels[notification.reactionType || 'LIKE'] || 'reacted to';\n      return `${actorName} ${action} your post`;\n    case 'POST_LIKE':\n      return `${actorName} liked your post`;\n    case 'COMMENT':\n      return `${actorName} commented on your post`;\n    case 'COMMENT_LIKE':\n      return `${actorName} liked your comment`;\n    case 'MENTION':\n      return `${actorName} mentioned you`;\n    case 'CONNECTION_REQUEST':\n      return `${actorName} sent you a connection request`;\n    case 'CONNECTION_ACCEPTED':\n      return `${actorName} accepted your connection request`;\n    case 'POLL_VOTE':\n      return `${actorName} voted on your poll`;\n    case 'POST_SHARE':\n      return `${actorName} shared your post`;\n    case 'GROUP_INVITE':\n      return `${actorName} invited you to join ${notification.content || 'a group'}`;\n    case 'GROUP_JOIN_REQUEST':\n      return `${actorName} requested to join your group`;\n    case 'GROUP_JOIN_APPROVED':\n      return `Your request to join ${notification.content || 'the group'} was approved`;\n    default:\n      return `${actorName} interacted with your content`;\n  }\n}\n\ninterface NotificationItemProps {\n  notification: Notification;\n  onMarkRead: (id: string) => void;\n}\n\nfunction NotificationItem({ notification, onMarkRead }: NotificationItemProps) {\n  const router = useRouter();\n  \n  const handleClick = () => {\n    // Mark as read\n    if (!notification.isRead) {\n      onMarkRead(notification.id);\n    }\n    \n    // Navigate based on notification type\n    if (notification.type === 'GROUP_INVITE' || notification.type === 'GROUP_JOIN_APPROVED') {\n      // Navigate to groups page with invites tab\n      router.push('/groups?tab=invites');\n    } else if (notification.postId) {\n      if (notification.commentId) {\n        router.push(`/post/${notification.postId}?comment=${notification.commentId}`);\n      } else {\n        router.push(`/post/${notification.postId}`);\n      }\n    } else if (notification.type === 'CONNECTION_REQUEST' || notification.type === 'CONNECTION_ACCEPTED') {\n      if (notification.actor) {\n        router.push(`/profile/${notification.actor.username}`);\n      }\n    }\n  };\n  \n  return (\n    <motion.button\n      initial={{ opacity: 0, x: -20 }}\n      animate={{ opacity: 1, x: 0 }}\n      onClick={handleClick}\n      className={`w-full flex items-start gap-3 p-4 text-left transition-colors ${\n        notification.isRead \n          ? 'bg-transparent hover:bg-gray-50 dark:hover:bg-neutral-800/50' \n          : 'bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30'\n      }`}\n    >\n      {/* Avatar */}\n      <div className=\"relative flex-shrink-0\">\n        <div className=\"w-12 h-12 rounded-full overflow-hidden bg-gray-200 dark:bg-neutral-700\">\n          {notification.actor?.profileImage ? (\n            <Image\n              src={notification.actor.profileImage}\n              alt={notification.actor.name}\n              width={48}\n              height={48}\n              className=\"w-full h-full object-cover\"\n            />\n          ) : (\n            <div className=\"w-full h-full flex items-center justify-center font-bold text-gray-500\">\n              {notification.actor?.name?.charAt(0).toUpperCase() || '?'}\n            </div>\n          )}\n        </div>\n        <div className=\"absolute -bottom-1 -right-1 p-1 rounded-full bg-white dark:bg-neutral-900\">\n          {getNotificationIcon(notification.type, notification.reactionType)}\n        </div>\n      </div>\n      \n      {/* Content */}\n      <div className=\"flex-1 min-w-0\">\n        <p className=\"text-sm text-gray-900 dark:text-white\">\n          {getNotificationMessage(notification)}\n        </p>\n        {notification.content && (\n          <p className=\"text-sm text-gray-500 dark:text-neutral-400 line-clamp-2 mt-1\">\n            &quot;{notification.content}&quot;\n          </p>\n        )}\n        {notification.postPreview && !notification.content && (\n          <p className=\"text-sm text-gray-500 dark:text-neutral-400 line-clamp-1 mt-1\">\n            {notification.postPreview}\n          </p>\n        )}\n        <p className=\"text-xs text-gray-400 dark:text-neutral-500 mt-1\">\n          {formatDistanceToNow(new Date(notification.createdAt), { addSuffix: true })}\n        </p>\n      </div>\n      \n      {/* Unread indicator */}\n      {!notification.isRead && (\n        <div className=\"w-2 h-2 rounded-full bg-blue-500 flex-shrink-0 mt-2\" />\n      )}\n    </motion.button>\n  );\n}\n\ninterface NotificationsProps {\n  isOpen?: boolean;\n  onClose?: () => void;\n  isDropdown?: boolean;\n}\n\nexport function Notifications({ isOpen = true, onClose, isDropdown = false }: NotificationsProps) {\n  const [notifications, setNotifications] = useState<Notification[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [unreadCount, setUnreadCount] = useState(0);\n  \n  // Fetch notifications\n  useEffect(() => {\n    if (!isOpen) return;\n    \n    const fetchNotifications = async () => {\n      setLoading(true);\n      try {\n        const [notifResponse, countRes] = await Promise.all([\n          getNotifications(),\n          getUnreadNotificationCount(),\n        ]);\n        setNotifications(notifResponse.notifications);\n        setUnreadCount(countRes.count);\n      } catch (error) {\n        console.error('Error fetching notifications:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    fetchNotifications();\n  }, [isOpen]);\n\n  // Setup real-time notifications\n  useEffect(() => {\n    const socket = initializeSocket({\n      onNotificationMention: () => {\n        setUnreadCount(prev => prev + 1);\n        // Refetch to get the new notification\n        getNotifications().then(res => setNotifications(res.notifications)).catch(console.error);\n      },\n      onNotificationComment: () => {\n        setUnreadCount(prev => prev + 1);\n        getNotifications().then(res => setNotifications(res.notifications)).catch(console.error);\n      },\n      onNotificationLike: () => {\n        setUnreadCount(prev => prev + 1);\n        getNotifications().then(res => setNotifications(res.notifications)).catch(console.error);\n      },\n      onNotificationReaction: () => {\n        setUnreadCount(prev => prev + 1);\n        getNotifications().then(res => setNotifications(res.notifications)).catch(console.error);\n      },\n      onNotificationCommentLike: () => {\n        setUnreadCount(prev => prev + 1);\n        getNotifications().then(res => setNotifications(res.notifications)).catch(console.error);\n      },\n    });\n    \n    return () => {\n      // Cleanup listeners if needed\n    };\n  }, []);\n\n  // Mark notification as read\n  const handleMarkRead = async (id: string) => {\n    try {\n      await markNotificationsAsRead([id]);\n      setNotifications(prev => \n        prev.map(n => n.id === id ? { ...n, isRead: true } : n)\n      );\n      setUnreadCount(prev => Math.max(0, prev - 1));\n    } catch (error) {\n      console.error('Error marking notification as read:', error);\n    }\n  };\n\n  // Mark all as read\n  const handleMarkAllRead = async () => {\n    try {\n      await markAllNotificationsAsRead();\n      setNotifications(prev => prev.map(n => ({ ...n, isRead: true })));\n      setUnreadCount(0);\n    } catch (error) {\n      console.error('Error marking all as read:', error);\n    }\n  };\n\n  const content = (\n    <>\n      {/* Header */}\n      <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-neutral-800\">\n        <div className=\"flex items-center gap-2\">\n          <Bell className=\"w-5 h-5 text-gray-600 dark:text-neutral-400\" />\n          <h2 className=\"text-lg font-semibold text-gray-900 dark:text-white\">Notifications</h2>\n          {unreadCount > 0 && (\n            <span className=\"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-500 text-white\">\n              {unreadCount}\n            </span>\n          )}\n        </div>\n        \n        {unreadCount > 0 && (\n          <button\n            onClick={handleMarkAllRead}\n            className=\"flex items-center gap-1 text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition-colors\"\n          >\n            <CheckCheck className=\"w-4 h-4\" />\n            Mark all read\n          </button>\n        )}\n      </div>\n      \n      {/* Notifications List */}\n      <div className={`overflow-y-auto ${isDropdown ? 'max-h-96' : 'flex-1'}`}>\n        {loading ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"w-8 h-8 animate-spin text-gray-400\" />\n          </div>\n        ) : notifications.length === 0 ? (\n          <div className=\"text-center py-12 px-4\">\n            <Bell className=\"w-12 h-12 mx-auto text-gray-300 dark:text-neutral-600 mb-2\" />\n            <p className=\"text-gray-500 dark:text-neutral-400\">No notifications yet</p>\n            <p className=\"text-sm text-gray-400 dark:text-neutral-500\">\n              When someone interacts with your content, it will appear here\n            </p>\n          </div>\n        ) : (\n          <div className=\"divide-y divide-gray-100 dark:divide-neutral-800\">\n            <AnimatePresence>\n              {notifications.map((notification) => (\n                <NotificationItem\n                  key={notification.id}\n                  notification={notification}\n                  onMarkRead={handleMarkRead}\n                />\n              ))}\n            </AnimatePresence>\n          </div>\n        )}\n      </div>\n    </>\n  );\n\n  if (isDropdown) {\n    return (\n      <div className=\"w-80 bg-white dark:bg-neutral-900 rounded-xl border border-gray-200 dark:border-neutral-800 shadow-xl overflow-hidden\">\n        {content}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-neutral-950\">\n      <div className=\"max-w-2xl mx-auto bg-white dark:bg-neutral-900 min-h-screen border-x border-gray-200 dark:border-neutral-800\">\n        {content}\n      </div>\n    </div>\n  );\n}\n\n// Notification Bell with Badge for Dock/Header\nexport function NotificationBell() {\n  const [unreadCount, setUnreadCount] = useState(0);\n  const [showDropdown, setShowDropdown] = useState(false);\n  \n  // Fetch unread count\n  useEffect(() => {\n    const fetchCount = async () => {\n      try {\n        const { count } = await getUnreadNotificationCount();\n        setUnreadCount(count);\n      } catch (error) {\n        console.error('Error fetching notification count:', error);\n      }\n    };\n    \n    fetchCount();\n    \n    // Poll for updates every 30 seconds\n    const interval = setInterval(fetchCount, 30000);\n    return () => clearInterval(interval);\n  }, []);\n\n  // Real-time updates\n  useEffect(() => {\n    initializeSocket({\n      onNotificationMention: () => setUnreadCount(prev => prev + 1),\n      onNotificationComment: () => setUnreadCount(prev => prev + 1),\n      onNotificationLike: () => setUnreadCount(prev => prev + 1),\n      onNotificationReaction: () => setUnreadCount(prev => prev + 1),\n      onNotificationCommentLike: () => setUnreadCount(prev => prev + 1),\n    });\n  }, []);\n\n  return (\n    <div className=\"relative\">\n      <button\n        onClick={() => setShowDropdown(!showDropdown)}\n        className=\"relative p-2 rounded-full hover:bg-gray-100 dark:hover:bg-neutral-800 transition-colors\"\n      >\n        <Bell className=\"w-6 h-6 text-gray-600 dark:text-neutral-400\" />\n        {unreadCount > 0 && (\n          <span className=\"absolute -top-1 -right-1 w-5 h-5 flex items-center justify-center text-xs font-bold text-white bg-red-500 rounded-full\">\n            {unreadCount > 9 ? '9+' : unreadCount}\n          </span>\n        )}\n      </button>\n      \n      {showDropdown && (\n        <>\n          <div\n            className=\"fixed inset-0 z-40\"\n            onClick={() => setShowDropdown(false)}\n          />\n          <div className=\"absolute right-0 top-full mt-2 z-50\">\n            <Notifications isDropdown onClose={() => setShowDropdown(false)} />\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n\nexport default Notifications;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 776, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/lib/firebase.ts"],"sourcesContent":["import { initializeApp, getApps, type FirebaseApp } from 'firebase/app';\nimport { getMessaging, getToken, onMessage, isSupported, type Messaging } from 'firebase/messaging';\n\nconst firebaseConfig = {\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\n};\n\nlet app: FirebaseApp | null = null;\nlet messaging: Messaging | null = null;\n\n/**\n * Initialize Firebase app (singleton, client-side only)\n */\nexport function getFirebaseApp(): FirebaseApp | null {\n  if (typeof window === 'undefined') return null;\n  if (!firebaseConfig.apiKey || !firebaseConfig.projectId) return null;\n\n  if (!app) {\n    app = getApps().length === 0 ? initializeApp(firebaseConfig) : getApps()[0];\n  }\n  return app;\n}\n\n/**\n * Get Firebase Cloud Messaging instance\n * Returns null if not supported (SSR, no permission, missing config)\n */\nexport async function getFirebaseMessaging(): Promise<Messaging | null> {\n  if (typeof window === 'undefined') return null;\n\n  const supported = await isSupported();\n  if (!supported) return null;\n\n  const firebaseApp = getFirebaseApp();\n  if (!firebaseApp) return null;\n\n  if (!messaging) {\n    messaging = getMessaging(firebaseApp);\n  }\n  return messaging;\n}\n\n/**\n * Request notification permission and get FCM token\n * Returns the token string, or null if denied/unsupported\n */\nexport async function requestNotificationToken(): Promise<string | null> {\n  try {\n    const permission = await Notification.requestPermission();\n    if (permission !== 'granted') return null;\n\n    const msg = await getFirebaseMessaging();\n    if (!msg) return null;\n\n    const vapidKey = process.env.NEXT_PUBLIC_FIREBASE_VAPID_KEY;\n    if (!vapidKey) {\n      console.warn('NEXT_PUBLIC_FIREBASE_VAPID_KEY not set');\n      return null;\n    }\n\n    const token = await getToken(msg, {\n      vapidKey,\n      serviceWorkerRegistration: await navigator.serviceWorker.register('/firebase-messaging-sw.js'),\n    });\n\n    return token;\n  } catch (err) {\n    console.error('Failed to get notification token:', err);\n    return null;\n  }\n}\n\n/**\n * Listen for foreground messages\n */\nexport function onForegroundMessage(callback: (payload: any) => void): (() => void) | null {\n  if (typeof window === 'undefined') return null;\n\n  getFirebaseMessaging().then(msg => {\n    if (!msg) return;\n    onMessage(msg, callback);\n  });\n\n  // Firebase onMessage doesn't return a clean unsubscribe for async init,\n  // so we return a no-op. The listener is tied to page lifecycle.\n  return () => {};\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;AAAA;;;AAEA,MAAM,iBAAiB;IACrB,QAAQ,QAAQ,GAAG,CAAC,4BAA4B;IAChD,YAAY,QAAQ,GAAG,CAAC,gCAAgC;IACxD,WAAW,QAAQ,GAAG,CAAC,+BAA+B;IACtD,eAAe,QAAQ,GAAG,CAAC,mCAAmC;IAC9D,mBAAmB,QAAQ,GAAG,CAAC,wCAAwC;IACvE,OAAO,QAAQ,GAAG,CAAC,2BAA2B;AAChD;AAEA,IAAI,MAA0B;AAC9B,IAAI,YAA8B;AAK3B,SAAS;IACd,wCAAmC,OAAO;;;AAO5C;AAMO,eAAe;IACpB,wCAAmC,OAAO;;;IAE1C,MAAM;IAGN,MAAM;AAOR;AAMO,eAAe;IACpB,IAAI;QACF,MAAM,aAAa,MAAM,aAAa,iBAAiB;QACvD,IAAI,eAAe,WAAW,OAAO;QAErC,MAAM,MAAM,MAAM;QAClB,IAAI,CAAC,KAAK,OAAO;QAEjB,MAAM,WAAW,QAAQ,GAAG,CAAC,8BAA8B;QAC3D,IAAI,CAAC,UAAU;YACb,QAAQ,IAAI,CAAC;YACb,OAAO;QACT;QAEA,MAAM,QAAQ,MAAM,IAAA,kLAAQ,EAAC,KAAK;YAChC;YACA,2BAA2B,MAAM,UAAU,aAAa,CAAC,QAAQ,CAAC;QACpE;QAEA,OAAO;IACT,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,qCAAqC;QACnD,OAAO;IACT;AACF;AAKO,SAAS,oBAAoB,QAAgC;IAClE,wCAAmC,OAAO;;;AAU5C"}},
    {"offset": {"line": 843, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/hooks/usePushNotifications.ts"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback, useRef } from 'react';\nimport { requestNotificationToken, onForegroundMessage } from '@/lib/firebase';\nimport apiClient from '@/lib/api/client';\n\ninterface PushNotificationState {\n  isSupported: boolean;\n  isPermissionGranted: boolean;\n  isTokenRegistered: boolean;\n  isLoading: boolean;\n}\n\n/**\n * usePushNotifications â€” manages web push notification lifecycle\n * 1. Checks browser support\n * 2. Requests permission\n * 3. Gets FCM token\n * 4. Registers token with backend via POST /api/devices/register\n * 5. Listens for foreground messages\n */\nexport function usePushNotifications(userId: string | undefined) {\n  const [state, setState] = useState<PushNotificationState>({\n    isSupported: false,\n    isPermissionGranted: false,\n    isTokenRegistered: false,\n    isLoading: false,\n  });\n  const [foregroundNotification, setForegroundNotification] = useState<any>(null);\n  const registeredRef = useRef(false);\n\n  // Check support on mount\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n\n    const supported = 'Notification' in window && 'serviceWorker' in navigator;\n    const granted = supported && Notification.permission === 'granted';\n\n    setState(prev => ({\n      ...prev,\n      isSupported: supported,\n      isPermissionGranted: granted,\n    }));\n\n    // If already granted + user logged in, register silently\n    if (granted && userId && !registeredRef.current) {\n      registerToken();\n    }\n  }, [userId]);\n\n  // Listen for foreground messages\n  useEffect(() => {\n    if (!state.isPermissionGranted) return;\n\n    const unsubscribe = onForegroundMessage((payload) => {\n      setForegroundNotification(payload);\n\n      // Auto-dismiss after 5s\n      setTimeout(() => setForegroundNotification(null), 5000);\n    });\n\n    return () => {\n      if (unsubscribe) unsubscribe();\n    };\n  }, [state.isPermissionGranted]);\n\n  const registerToken = useCallback(async () => {\n    if (registeredRef.current || state.isLoading) return;\n\n    setState(prev => ({ ...prev, isLoading: true }));\n\n    try {\n      const token = await requestNotificationToken();\n      if (!token) {\n        setState(prev => ({ ...prev, isLoading: false }));\n        return;\n      }\n\n      // Register with backend\n      await apiClient.post('/devices/register', {\n        token,\n        platform: 'web',\n        deviceId: `web-${navigator.userAgent.slice(0, 50)}`,\n      });\n\n      registeredRef.current = true;\n      setState(prev => ({\n        ...prev,\n        isPermissionGranted: true,\n        isTokenRegistered: true,\n        isLoading: false,\n      }));\n\n      // Store in localStorage to avoid re-registering\n      localStorage.setItem('push_token_registered', 'true');\n    } catch (err) {\n      console.error('Push notification registration failed:', err);\n      setState(prev => ({ ...prev, isLoading: false }));\n    }\n  }, [state.isLoading]);\n\n  const requestPermission = useCallback(async () => {\n    if (!state.isSupported) return;\n\n    setState(prev => ({ ...prev, isLoading: true }));\n\n    try {\n      const permission = await Notification.requestPermission();\n      if (permission === 'granted') {\n        setState(prev => ({ ...prev, isPermissionGranted: true }));\n        await registerToken();\n      } else {\n        setState(prev => ({ ...prev, isLoading: false }));\n      }\n    } catch {\n      setState(prev => ({ ...prev, isLoading: false }));\n    }\n  }, [state.isSupported, registerToken]);\n\n  const dismissNotification = useCallback(() => {\n    setForegroundNotification(null);\n  }, []);\n\n  return {\n    ...state,\n    foregroundNotification,\n    requestPermission,\n    dismissNotification,\n  };\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAJA;;;;AAqBO,SAAS,qBAAqB,MAA0B;IAC7D,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAwB;QACxD,aAAa;QACb,qBAAqB;QACrB,mBAAmB;QACnB,WAAW;IACb;IACA,MAAM,CAAC,wBAAwB,0BAA0B,GAAG,IAAA,iNAAQ,EAAM;IAC1E,MAAM,gBAAgB,IAAA,+MAAM,EAAC;IAE7B,yBAAyB;IACzB,IAAA,kNAAS,EAAC;QACR,wCAAmC;;;QAEnC,MAAM;QACN,MAAM;IAYR,GAAG;QAAC;KAAO;IAEX,iCAAiC;IACjC,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,MAAM,mBAAmB,EAAE;QAEhC,MAAM,cAAc,IAAA,6IAAmB,EAAC,CAAC;YACvC,0BAA0B;YAE1B,wBAAwB;YACxB,WAAW,IAAM,0BAA0B,OAAO;QACpD;QAEA,OAAO;YACL,IAAI,aAAa;QACnB;IACF,GAAG;QAAC,MAAM,mBAAmB;KAAC;IAE9B,MAAM,gBAAgB,IAAA,oNAAW,EAAC;QAChC,IAAI,cAAc,OAAO,IAAI,MAAM,SAAS,EAAE;QAE9C,SAAS,CAAA,OAAQ,CAAC;gBAAE,GAAG,IAAI;gBAAE,WAAW;YAAK,CAAC;QAE9C,IAAI;YACF,MAAM,QAAQ,MAAM,IAAA,kJAAwB;YAC5C,IAAI,CAAC,OAAO;gBACV,SAAS,CAAA,OAAQ,CAAC;wBAAE,GAAG,IAAI;wBAAE,WAAW;oBAAM,CAAC;gBAC/C;YACF;YAEA,wBAAwB;YACxB,MAAM,sIAAS,CAAC,IAAI,CAAC,qBAAqB;gBACxC;gBACA,UAAU;gBACV,UAAU,CAAC,IAAI,EAAE,UAAU,SAAS,CAAC,KAAK,CAAC,GAAG,KAAK;YACrD;YAEA,cAAc,OAAO,GAAG;YACxB,SAAS,CAAA,OAAQ,CAAC;oBAChB,GAAG,IAAI;oBACP,qBAAqB;oBACrB,mBAAmB;oBACnB,WAAW;gBACb,CAAC;YAED,gDAAgD;YAChD,aAAa,OAAO,CAAC,yBAAyB;QAChD,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,0CAA0C;YACxD,SAAS,CAAA,OAAQ,CAAC;oBAAE,GAAG,IAAI;oBAAE,WAAW;gBAAM,CAAC;QACjD;IACF,GAAG;QAAC,MAAM,SAAS;KAAC;IAEpB,MAAM,oBAAoB,IAAA,oNAAW,EAAC;QACpC,IAAI,CAAC,MAAM,WAAW,EAAE;QAExB,SAAS,CAAA,OAAQ,CAAC;gBAAE,GAAG,IAAI;gBAAE,WAAW;YAAK,CAAC;QAE9C,IAAI;YACF,MAAM,aAAa,MAAM,aAAa,iBAAiB;YACvD,IAAI,eAAe,WAAW;gBAC5B,SAAS,CAAA,OAAQ,CAAC;wBAAE,GAAG,IAAI;wBAAE,qBAAqB;oBAAK,CAAC;gBACxD,MAAM;YACR,OAAO;gBACL,SAAS,CAAA,OAAQ,CAAC;wBAAE,GAAG,IAAI;wBAAE,WAAW;oBAAM,CAAC;YACjD;QACF,EAAE,OAAM;YACN,SAAS,CAAA,OAAQ,CAAC;oBAAE,GAAG,IAAI;oBAAE,WAAW;gBAAM,CAAC;QACjD;IACF,GAAG;QAAC,MAAM,WAAW;QAAE;KAAc;IAErC,MAAM,sBAAsB,IAAA,oNAAW,EAAC;QACtC,0BAA0B;IAC5B,GAAG,EAAE;IAEL,OAAO;QACL,GAAG,KAAK;QACR;QACA;QACA;IACF;AACF"}},
    {"offset": {"line": 971, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/notifications/NotificationPrompt.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Bell, X, BellRing } from 'lucide-react';\nimport { usePushNotifications } from '@/hooks/usePushNotifications';\n\ninterface NotificationPromptProps {\n  userId: string | undefined;\n}\n\n/**\n * NotificationPrompt â€” asks user to enable push notifications\n * Shows after 3rd visit if not already granted/dismissed.\n * Also renders foreground notification toasts.\n */\nexport function NotificationPrompt({ userId }: NotificationPromptProps) {\n  const {\n    isSupported,\n    isPermissionGranted,\n    isTokenRegistered,\n    isLoading,\n    foregroundNotification,\n    requestPermission,\n    dismissNotification,\n  } = usePushNotifications(userId);\n\n  const [showPrompt, setShowPrompt] = useState(false);\n\n  useEffect(() => {\n    if (!isSupported || isPermissionGranted || !userId) return;\n\n    // Show prompt after 3rd visit or 10s delay\n    const dismissed = localStorage.getItem('push_prompt_dismissed');\n    if (dismissed) return;\n\n    const visits = parseInt(localStorage.getItem('visit_count') || '0', 10) + 1;\n    localStorage.setItem('visit_count', visits.toString());\n\n    if (visits >= 3) {\n      const timer = setTimeout(() => setShowPrompt(true), 10000);\n      return () => clearTimeout(timer);\n    }\n  }, [isSupported, isPermissionGranted, userId]);\n\n  const handleEnable = async () => {\n    await requestPermission();\n    setShowPrompt(false);\n  };\n\n  const handleDismiss = () => {\n    setShowPrompt(false);\n    localStorage.setItem('push_prompt_dismissed', new Date().toISOString());\n  };\n\n  return (\n    <>\n      {/* Permission Prompt */}\n      <AnimatePresence>\n        {showPrompt && (\n          <motion.div\n            initial={{ opacity: 0, y: 50, scale: 0.9 }}\n            animate={{ opacity: 1, y: 0, scale: 1 }}\n            exit={{ opacity: 0, y: 50, scale: 0.9 }}\n            className=\"fixed bottom-24 left-4 right-4 md:left-auto md:right-6 md:w-96 z-50 bg-white dark:bg-neutral-900 rounded-2xl shadow-2xl border border-gray-200 dark:border-neutral-700 overflow-hidden\"\n          >\n            <div className=\"p-5\">\n              <div className=\"flex items-start gap-3\">\n                <div className=\"w-10 h-10 rounded-xl bg-blue-50 dark:bg-blue-900/20 flex items-center justify-center flex-shrink-0\">\n                  <BellRing className=\"w-5 h-5 text-blue-600 dark:text-blue-400\" />\n                </div>\n                <div className=\"flex-1\">\n                  <h3 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-1\">\n                    Stay in the loop ðŸ””\n                  </h3>\n                  <p className=\"text-xs text-gray-500 dark:text-neutral-400 leading-relaxed\">\n                    Get notified when someone views your profile, accepts your connection, or when your streak is at risk.\n                  </p>\n                </div>\n                <button\n                  onClick={handleDismiss}\n                  className=\"p-1 rounded-full hover:bg-gray-100 dark:hover:bg-neutral-800 transition-colors\"\n                >\n                  <X className=\"w-4 h-4 text-gray-400\" />\n                </button>\n              </div>\n\n              <div className=\"flex gap-2 mt-4\">\n                <button\n                  onClick={handleDismiss}\n                  className=\"flex-1 py-2 px-4 rounded-lg text-sm font-medium text-gray-600 dark:text-neutral-400 hover:bg-gray-100 dark:hover:bg-neutral-800 transition-colors\"\n                >\n                  Not now\n                </button>\n                <button\n                  onClick={handleEnable}\n                  disabled={isLoading}\n                  className=\"flex-1 py-2 px-4 rounded-lg text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center justify-center gap-1.5\"\n                >\n                  <Bell className=\"w-3.5 h-3.5\" />\n                  {isLoading ? 'Enabling...' : 'Enable'}\n                </button>\n              </div>\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Foreground Notification Toast */}\n      <AnimatePresence>\n        {foregroundNotification && (\n          <motion.div\n            initial={{ opacity: 0, y: -50, x: 50 }}\n            animate={{ opacity: 1, y: 0, x: 0 }}\n            exit={{ opacity: 0, y: -50 }}\n            className=\"fixed top-4 right-4 z-[100] w-80 bg-white dark:bg-neutral-900 rounded-xl shadow-2xl border border-gray-200 dark:border-neutral-700 overflow-hidden cursor-pointer\"\n            onClick={dismissNotification}\n          >\n            <div className=\"p-4\">\n              <div className=\"flex items-start gap-3\">\n                <div className=\"w-8 h-8 rounded-lg bg-blue-50 dark:bg-blue-900/20 flex items-center justify-center flex-shrink-0\">\n                  <Bell className=\"w-4 h-4 text-blue-500\" />\n                </div>\n                <div className=\"flex-1 min-w-0\">\n                  <p className=\"text-sm font-semibold text-gray-900 dark:text-white truncate\">\n                    {foregroundNotification.notification?.title || 'Vormex'}\n                  </p>\n                  <p className=\"text-xs text-gray-500 dark:text-neutral-400 line-clamp-2 mt-0.5\">\n                    {foregroundNotification.notification?.body || ''}\n                  </p>\n                </div>\n                <button\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    dismissNotification();\n                  }}\n                  className=\"p-0.5 rounded hover:bg-gray-100 dark:hover:bg-neutral-800\"\n                >\n                  <X className=\"w-3.5 h-3.5 text-gray-400\" />\n                </button>\n              </div>\n            </div>\n            {/* Auto-dismiss progress bar */}\n            <motion.div\n              initial={{ width: '100%' }}\n              animate={{ width: '0%' }}\n              transition={{ duration: 5, ease: 'linear' }}\n              className=\"h-0.5 bg-blue-500\"\n            />\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1282, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/components/notifications/index.ts"],"sourcesContent":["export { Notifications, NotificationBell } from './Notifications';\nexport { NotificationPrompt } from './NotificationPrompt';\n"],"names":[],"mappings":";AAAA;AACA"}},
    {"offset": {"line": 1291, "column": 0}, "map": {"version":3,"sources":["file:///home/yasmanth/Pictures/vormex/vormex-web/src/app/notifications/page.tsx"],"sourcesContent":["'use client';\n\nimport { ProtectedRoute } from '@/components/auth/ProtectedRoute';\nimport { Notifications } from '@/components/notifications';\n\nexport default function NotificationsPage() {\n  return (\n    <ProtectedRoute>\n      <Notifications />\n    </ProtectedRoute>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAHA;;;;AAKe,SAAS;IACtB,qBACE,8OAAC,8JAAc;kBACb,cAAA,8OAAC,qKAAa;;;;;;;;;;AAGpB"}}]
}