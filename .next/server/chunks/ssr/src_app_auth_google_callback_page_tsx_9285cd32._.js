module.exports=[55101,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(77170),f=a.i(66685),g=a.i(55367),h=a.i(48966);function i(){let a=(0,d.useRouter)(),i=(0,d.useSearchParams)(),{setAuth:j}=(0,f.useAuthContext)(),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(!0);return(0,c.useEffect)(()=>{(async()=>{try{let b=i.get("code"),c=i.get("state"),d=i.get("error");if(d){l(`Google OAuth error: ${d}`),n(!1),setTimeout(()=>a.push("/login"),3e3);return}let f=sessionStorage.getItem("oauth_state");if(!c||c!==f){l("Invalid state parameter. Please try again."),n(!1),sessionStorage.removeItem("oauth_state"),sessionStorage.removeItem("oauth_code_verifier"),setTimeout(()=>a.push("/login"),3e3);return}if(!b){l("Authorization code not found. Please try again."),n(!1),sessionStorage.removeItem("oauth_state"),sessionStorage.removeItem("oauth_code_verifier"),setTimeout(()=>a.push("/login"),3e3);return}let h=`${window.location.origin}/auth/google/callback`,k=sessionStorage.getItem("oauth_code_verifier");if(!k)throw Error("Code verifier not found. Please try signing in again.");let m=await fetch("/api/auth/google/callback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:b,codeVerifier:k,redirectUri:h})});if(!m.ok){let a=await m.json().catch(()=>({}));throw Error(a.error||a.error_description||"Failed to exchange authorization code")}let o=(await m.json()).idToken;if(!o)throw Error("ID token not found in token response");let p=await e.authAPI.googleSignIn(o);j(p),(0,g.setPendingUser)(p.user),sessionStorage.removeItem("oauth_state"),sessionStorage.removeItem("oauth_code_verifier"),window.location.replace("/")}catch(b){console.error("Google OAuth callback error:",b),l((0,h.handleApiError)(b)),n(!1),sessionStorage.removeItem("oauth_state"),sessionStorage.removeItem("oauth_code_verifier"),setTimeout(()=>a.push("/login"),3e3)}})()},[i,a,j]),(0,b.jsx)("div",{className:"auth-page-wrapper",children:(0,b.jsx)("div",{className:"main",style:{maxWidth:"500px",width:"100%"},children:(0,b.jsxs)("div",{className:"form",children:[(0,b.jsx)("h2",{className:"form_title title",children:"Signing in with Google..."}),m&&(0,b.jsx)("p",{className:"description",style:{marginTop:"20px"},children:"Please wait while we complete your sign-in."}),k&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"error-message",style:{marginTop:"20px"},children:k}),(0,b.jsx)("p",{className:"description",style:{marginTop:"10px"},children:"Redirecting to login page..."})]})]})})})}function j(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"auth-page-wrapper",children:(0,b.jsx)("div",{className:"main",style:{maxWidth:"500px",width:"100%"},children:(0,b.jsxs)("div",{className:"form",children:[(0,b.jsx)("h2",{className:"form_title title",children:"Signing in with Google..."}),(0,b.jsx)("p",{className:"description",style:{marginTop:"20px"},children:"Loading..."})]})})}),children:(0,b.jsx)(i,{})})}a.s(["default",()=>j])}];

//# sourceMappingURL=src_app_auth_google_callback_page_tsx_9285cd32._.js.map